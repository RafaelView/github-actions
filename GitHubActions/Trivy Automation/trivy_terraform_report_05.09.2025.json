{
  "SchemaVersion": 2,
  "CreatedAt": "2025-05-09T09:07:31.902973429Z",
  "ArtifactName": ".",
  "ArtifactType": "filesystem",
  "Metadata": {
    "ImageConfig": {
      "architecture": "",
      "created": "0001-01-01T00:00:00Z",
      "os": "",
      "rootfs": {
        "type": "",
        "diff_ids": null
      },
      "config": {}
    }
  },
  "Results": [
    {
      "Target": "Azure/compute/azurerm/main.tf",
      "Class": "config",
      "Type": "terraform",
      "MisconfSummary": {
        "Successes": 0,
        "Failures": 2
      },
      "Misconfigurations": [
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AZU-0047",
          "AVDID": "AVD-AZU-0047",
          "Title": "A security group rule should not allow unrestricted ingress from any IP address.",
          "Description": "Opening up ports to allow connections from the public internet is generally to be avoided. You should restrict access to IP addresses or ranges that are explicitly required where possible.\n",
          "Message": "Security group rule allows unrestricted ingress from any IP address.",
          "Namespace": "builtin.azure.network.azure0047",
          "Query": "data.builtin.azure.network.azure0047.deny",
          "Resolution": "Set a more restrictive cidr range",
          "Severity": "CRITICAL",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-azu-0047",
          "References": [
            "https://docs.microsoft.com/en-us/azure/security/fundamentals/network-best-practices",
            "https://avd.aquasec.com/misconfig/avd-azu-0047"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "module.windowsserver",
            "Provider": "Azure",
            "Service": "network",
            "StartLine": 264,
            "EndLine": 264,
            "Code": {
              "Lines": [
                {
                  "Number": 250,
                  "Content": "resource \"azurerm_network_security_group\" \"vm\" {",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"azurerm_network_security_group\"\u001b[0m \u001b[38;5;37m\"vm\"\u001b[0m {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 251,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 264,
                  "Content": "    source_address_prefix      = \"*\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m    \u001b[38;5;245msource_address_prefix\u001b[0m      = \u001b[38;5;37m\"*\"",
                  "FirstCause": true,
                  "LastCause": true
                },
                {
                  "Number": 266,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 267,
                  "Content": "}",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "}",
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "security_rule",
                "Filename": "Azure/compute/azurerm/main.tf",
                "Location": {
                  "StartLine": 255,
                  "EndLine": 266
                }
              },
              {
                "Resource": "azurerm_network_security_group.vm",
                "Filename": "Azure/compute/azurerm/main.tf",
                "Location": {
                  "StartLine": 250,
                  "EndLine": 267
                }
              },
              {
                "Resource": "module.windowsserver",
                "Filename": "infrastructure-as-code/azure-vm/main.tf",
                "Location": {
                  "StartLine": 19,
                  "EndLine": 29
                }
              }
            ],
            "RenderedCause": {}
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AZU-0048",
          "AVDID": "AVD-AZU-0048",
          "Title": "A security group should not allow unrestricted ingress to the RDP port from any IP address.",
          "Description": "RDP access can be configured on either the network security group or in the network security group rule.\nRDP access should not be permitted from the internet (*, 0.0.0.0, /0, internet, any). Consider using the Azure Bastion Service.\n",
          "Message": "Security group rule allows unrestricted ingress to RDP port from any IP address.",
          "Namespace": "builtin.azure.network.azure0048",
          "Query": "data.builtin.azure.network.azure0048.deny",
          "Resolution": "Block RDP port from internet",
          "Severity": "CRITICAL",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-azu-0048",
          "References": [
            "https://docs.microsoft.com/en-us/azure/bastion/tutorial-create-host-portal",
            "https://avd.aquasec.com/misconfig/avd-azu-0048"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "module.windowsserver",
            "Provider": "Azure",
            "Service": "network",
            "StartLine": 264,
            "EndLine": 264,
            "Code": {
              "Lines": [
                {
                  "Number": 250,
                  "Content": "resource \"azurerm_network_security_group\" \"vm\" {",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"azurerm_network_security_group\"\u001b[0m \u001b[38;5;37m\"vm\"\u001b[0m {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 251,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 264,
                  "Content": "    source_address_prefix      = \"*\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m    \u001b[38;5;245msource_address_prefix\u001b[0m      = \u001b[38;5;37m\"*\"",
                  "FirstCause": true,
                  "LastCause": true
                },
                {
                  "Number": 266,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 267,
                  "Content": "}",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "}",
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "security_rule",
                "Filename": "Azure/compute/azurerm/main.tf",
                "Location": {
                  "StartLine": 255,
                  "EndLine": 266
                }
              },
              {
                "Resource": "azurerm_network_security_group.vm",
                "Filename": "Azure/compute/azurerm/main.tf",
                "Location": {
                  "StartLine": 250,
                  "EndLine": 267
                }
              },
              {
                "Resource": "module.windowsserver",
                "Filename": "infrastructure-as-code/azure-vm/main.tf",
                "Location": {
                  "StartLine": 19,
                  "EndLine": 29
                }
              }
            ],
            "RenderedCause": {}
          }
        }
      ]
    },
    {
      "Target": "Azure/network/azurerm/main.tf",
      "Class": "config",
      "Type": "terraform",
      "MisconfSummary": {
        "Successes": 0,
        "Failures": 2
      },
      "Misconfigurations": [
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AZU-0047",
          "AVDID": "AVD-AZU-0047",
          "Title": "A security group rule should not allow unrestricted ingress from any IP address.",
          "Description": "Opening up ports to allow connections from the public internet is generally to be avoided. You should restrict access to IP addresses or ranges that are explicitly required where possible.\n",
          "Message": "Security group rule allows unrestricted ingress from any IP address.",
          "Namespace": "builtin.azure.network.azure0047",
          "Query": "data.builtin.azure.network.azure0047.deny",
          "Resolution": "Set a more restrictive cidr range",
          "Severity": "CRITICAL",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-azu-0047",
          "References": [
            "https://docs.microsoft.com/en-us/azure/security/fundamentals/network-best-practices",
            "https://avd.aquasec.com/misconfig/avd-azu-0047"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "module.network",
            "Provider": "Azure",
            "Service": "network",
            "StartLine": 56,
            "EndLine": 56,
            "Code": {
              "Lines": [
                {
                  "Number": 47,
                  "Content": "resource \"azurerm_network_security_rule\" \"security_rule_ssh\" {",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"azurerm_network_security_rule\"\u001b[0m \u001b[38;5;37m\"security_rule_ssh\"\u001b[0m {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 48,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 56,
                  "Content": "  source_address_prefix       = \"*\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245msource_address_prefix\u001b[0m       = \u001b[38;5;37m\"*\"",
                  "FirstCause": true,
                  "LastCause": true
                },
                {
                  "Number": 59,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 60,
                  "Content": "}",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m}",
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "azurerm_network_security_rule.security_rule_ssh[0]",
                "Filename": "Azure/network/azurerm/main.tf",
                "Location": {
                  "StartLine": 47,
                  "EndLine": 60
                }
              },
              {
                "Resource": "module.network",
                "Filename": "infrastructure-as-code/azure-vm/main.tf",
                "Location": {
                  "StartLine": 31,
                  "EndLine": 37
                }
              }
            ],
            "RenderedCause": {}
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AZU-0050",
          "AVDID": "AVD-AZU-0050",
          "Title": "Security group should not allow unrestricted ingress to SSH port from any IP address.",
          "Description": "SSH access can be configured on either the network security group or in the network security group rule.\nSSH access should not be permitted from the internet (*, 0.0.0.0, /0, internet, any)\n",
          "Message": "Security group rule allows unrestricted ingress to SSH port from any IP address.",
          "Namespace": "builtin.azure.network.azure0050",
          "Query": "data.builtin.azure.network.azure0050.deny",
          "Resolution": "Block port 22 access from the internet",
          "Severity": "CRITICAL",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-azu-0050",
          "References": [
            "https://avd.aquasec.com/misconfig/avd-azu-0050"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "module.network",
            "Provider": "Azure",
            "Service": "network",
            "StartLine": 56,
            "EndLine": 56,
            "Code": {
              "Lines": [
                {
                  "Number": 47,
                  "Content": "resource \"azurerm_network_security_rule\" \"security_rule_ssh\" {",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"azurerm_network_security_rule\"\u001b[0m \u001b[38;5;37m\"security_rule_ssh\"\u001b[0m {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 48,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 56,
                  "Content": "  source_address_prefix       = \"*\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245msource_address_prefix\u001b[0m       = \u001b[38;5;37m\"*\"",
                  "FirstCause": true,
                  "LastCause": true
                },
                {
                  "Number": 59,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 60,
                  "Content": "}",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m}",
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "azurerm_network_security_rule.security_rule_ssh[0]",
                "Filename": "Azure/network/azurerm/main.tf",
                "Location": {
                  "StartLine": 47,
                  "EndLine": 60
                }
              },
              {
                "Resource": "module.network",
                "Filename": "infrastructure-as-code/azure-vm/main.tf",
                "Location": {
                  "StartLine": 31,
                  "EndLine": 37
                }
              }
            ],
            "RenderedCause": {}
          }
        }
      ]
    },
    {
      "Target": "github.com/hashicorp-modules/hashistack-aws/github.com/hashicorp-modules/consul-lb-aws/main.tf",
      "Class": "config",
      "Type": "terraform",
      "MisconfSummary": {
        "Successes": 0,
        "Failures": 16
      },
      "Misconfigurations": [
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0052",
          "AVDID": "AVD-AWS-0052",
          "Title": "Load balancers should drop invalid headers",
          "Description": "Passing unknown or invalid headers through to the target poses a potential risk of compromise.\nBy setting drop_invalid_header_fields to true, anything that does not conform to well known, defined headers will be removed by the load balancer.\n",
          "Message": "Application load balancer is not set to drop invalid headers.",
          "Namespace": "builtin.aws.elb.aws0052",
          "Query": "data.builtin.aws.elb.aws0052.deny",
          "Resolution": "Set drop_invalid_header_fields to true",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0052",
          "References": [
            "https://docs.aws.amazon.com/elasticloadbalancing/latest/application/application-load-balancers.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0052"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "module.hashistack_aws[0]",
            "Provider": "AWS",
            "Service": "elb",
            "StartLine": 119,
            "EndLine": 133,
            "Code": {
              "Lines": [
                {
                  "Number": 119,
                  "Content": "resource \"aws_lb\" \"consul\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_lb\"\u001b[0m \u001b[38;5;37m\"consul\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 120,
                  "Content": "  count = \"${var.create ? 1 : 0}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mcount\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.create \u001b[38;5;245m?\u001b[0m \u001b[38;5;37m1\u001b[0m \u001b[38;5;245m:\u001b[0m \u001b[38;5;37m0\u001b[0m\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 121,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 122,
                  "Content": "  name            = \"${random_id.consul_lb.hex}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mname\u001b[0m            = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0mrandom_id.consul_lb.hex\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 123,
                  "Content": "  internal        = \"${var.is_internal_lb ? true : false}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245minternal\u001b[0m        = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.is_internal_lb \u001b[38;5;245m?\u001b[0m \u001b[38;5;166mtrue\u001b[0m \u001b[38;5;245m:\u001b[0m \u001b[38;5;166mfalse\u001b[0m\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 124,
                  "Content": "  subnets         = [\"${var.subnet_ids}\"]",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245msubnets\u001b[0m         = [\u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.subnet_ids\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"\u001b[0m]",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 125,
                  "Content": "  security_groups = [\"${aws_security_group.consul_lb.id}\"]",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245msecurity_groups\u001b[0m = [\u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0maws_security_group.consul_lb.id\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"\u001b[0m]",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 126,
                  "Content": "  tags            = \"${merge(var.tags, map(\"Name\", format(\"%s-consul-lb\", var.name)))}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mtags\u001b[0m            = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0mmerge(\u001b[38;5;33mvar\u001b[0m.tags,\u001b[38;5;33m map\u001b[0m(\u001b[38;5;37m\"Name\"\u001b[0m, \u001b[38;5;33mformat\u001b[0m(\u001b[38;5;37m\"%s-consul-lb\"\u001b[0m, \u001b[38;5;33mvar\u001b[0m.name)))\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 127,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 128,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "module.consul_lb_aws",
                "Filename": "github.com/hashicorp-modules/hashistack-aws/main.tf",
                "Location": {
                  "StartLine": 100,
                  "EndLine": 119
                }
              },
              {
                "Resource": "module.hashistack_aws[0]",
                "Filename": "infrastructure-as-code/hashistack/dev/terraform-aws/main.tf",
                "Location": {
                  "StartLine": 90,
                  "EndLine": 113
                }
              }
            ],
            "RenderedCause": {}
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0053",
          "AVDID": "AVD-AWS-0053",
          "Title": "Load balancer is exposed to the internet.",
          "Description": "There are many scenarios in which you would want to expose a load balancer to the wider internet, but this check exists as a warning to prevent accidental exposure of internal assets. You should ensure that this resource should be exposed publicly.\n",
          "Message": "Load balancer is exposed publicly.",
          "Namespace": "builtin.aws.elb.aws0053",
          "Query": "data.builtin.aws.elb.aws0053.deny",
          "Resolution": "Switch to an internal load balancer or add a tfsec ignore",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0053",
          "References": [
            "https://avd.aquasec.com/misconfig/avd-aws-0053"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "module.hashistack_aws[0]",
            "Provider": "AWS",
            "Service": "elb",
            "StartLine": 123,
            "EndLine": 123,
            "Code": {
              "Lines": [
                {
                  "Number": 119,
                  "Content": "resource \"aws_lb\" \"consul\" {",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_lb\"\u001b[0m \u001b[38;5;37m\"consul\"\u001b[0m {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 120,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 123,
                  "Content": "  internal        = \"${var.is_internal_lb ? true : false}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245minternal\u001b[0m        = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.is_internal_lb \u001b[38;5;245m?\u001b[0m \u001b[38;5;166mtrue\u001b[0m \u001b[38;5;245m:\u001b[0m \u001b[38;5;166mfalse\u001b[0m\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": true,
                  "LastCause": true
                },
                {
                  "Number": 132,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 133,
                  "Content": "}",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "}",
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "aws_lb.consul[0]",
                "Filename": "github.com/hashicorp-modules/hashistack-aws/github.com/hashicorp-modules/consul-lb-aws/main.tf",
                "Location": {
                  "StartLine": 119,
                  "EndLine": 133
                }
              },
              {
                "Resource": "module.consul_lb_aws",
                "Filename": "github.com/hashicorp-modules/hashistack-aws/main.tf",
                "Location": {
                  "StartLine": 100,
                  "EndLine": 119
                }
              },
              {
                "Resource": "module.hashistack_aws[0]",
                "Filename": "infrastructure-as-code/hashistack/dev/terraform-aws/main.tf",
                "Location": {
                  "StartLine": 90,
                  "EndLine": 113
                }
              }
            ],
            "RenderedCause": {
              "Raw": "resource \"aws_lb\" \"consul\" {\n  internal = false\n}",
              "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_lb\"\u001b[0m \u001b[38;5;37m\"consul\"\u001b[0m {\n  \u001b[38;5;245minternal\u001b[0m = \u001b[38;5;166mfalse\n\u001b[0m}"
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0086",
          "AVDID": "AVD-AWS-0086",
          "Title": "S3 Access block should block public ACL",
          "Description": "S3 buckets should block public ACLs on buckets and any objects they contain. By blocking, PUTs with fail if the object has any public ACL a.\n",
          "Message": "No public access block so not blocking public acls",
          "Namespace": "builtin.aws.s3.aws0086",
          "Query": "data.builtin.aws.s3.aws0086.deny",
          "Resolution": "Enable blocking any PUT calls with a public ACL specified",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0086",
          "References": [
            "https://docs.aws.amazon.com/AmazonS3/latest/userguide/access-control-block-public-access.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0086"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "module.hashistack_aws[0]",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 80,
            "EndLine": 110,
            "Code": {
              "Lines": [
                {
                  "Number": 80,
                  "Content": "resource \"aws_s3_bucket\" \"consul_lb_access_logs\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_s3_bucket\"\u001b[0m \u001b[38;5;37m\"consul_lb_access_logs\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 81,
                  "Content": "  count = \"${var.create \u0026\u0026 !var.lb_bucket_override ? 1 : 0}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mcount\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.create \u001b[38;5;245m\u0026\u0026\u001b[0m \u001b[38;5;245m!\u001b[0m\u001b[38;5;33mvar\u001b[0m.lb_bucket_override \u001b[38;5;245m?\u001b[0m \u001b[38;5;37m1\u001b[0m \u001b[38;5;245m:\u001b[0m \u001b[38;5;37m0\u001b[0m\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 82,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 83,
                  "Content": "  bucket = \"${random_id.consul_lb_access_logs.hex}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mbucket\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0mrandom_id.consul_lb_access_logs.hex\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 84,
                  "Content": "  acl    = \"private\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245macl\u001b[0m    = \u001b[38;5;37m\"private\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 85,
                  "Content": "  tags   = \"${merge(var.tags, map(\"Name\", format(\"%s-consul-lb-access-logs\", var.name)))}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mtags\u001b[0m   = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0mmerge(\u001b[38;5;33mvar\u001b[0m.tags,\u001b[38;5;33m map\u001b[0m(\u001b[38;5;37m\"Name\"\u001b[0m, \u001b[38;5;33mformat\u001b[0m(\u001b[38;5;37m\"%s-consul-lb-access-logs\"\u001b[0m, \u001b[38;5;33mvar\u001b[0m.name)))\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 86,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 87,
                  "Content": "  force_destroy = true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mforce_destroy\u001b[0m = \u001b[38;5;166mtrue",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 88,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 89,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "module.consul_lb_aws",
                "Filename": "github.com/hashicorp-modules/hashistack-aws/main.tf",
                "Location": {
                  "StartLine": 100,
                  "EndLine": 119
                }
              },
              {
                "Resource": "module.hashistack_aws[0]",
                "Filename": "infrastructure-as-code/hashistack/dev/terraform-aws/main.tf",
                "Location": {
                  "StartLine": 90,
                  "EndLine": 113
                }
              }
            ],
            "RenderedCause": {}
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0087",
          "AVDID": "AVD-AWS-0087",
          "Title": "S3 Access block should block public policy",
          "Description": "S3 bucket policy should have block public policy to prevent users from putting a policy that enable public access.\n",
          "Message": "No public access block so not blocking public policies",
          "Namespace": "builtin.aws.s3.aws0087",
          "Query": "data.builtin.aws.s3.aws0087.deny",
          "Resolution": "Prevent policies that allow public access being PUT",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0087",
          "References": [
            "https://docs.aws.amazon.com/AmazonS3/latest/dev-retired/access-control-block-public-access.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0087"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "module.hashistack_aws[0]",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 80,
            "EndLine": 110,
            "Code": {
              "Lines": [
                {
                  "Number": 80,
                  "Content": "resource \"aws_s3_bucket\" \"consul_lb_access_logs\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_s3_bucket\"\u001b[0m \u001b[38;5;37m\"consul_lb_access_logs\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 81,
                  "Content": "  count = \"${var.create \u0026\u0026 !var.lb_bucket_override ? 1 : 0}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mcount\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.create \u001b[38;5;245m\u0026\u0026\u001b[0m \u001b[38;5;245m!\u001b[0m\u001b[38;5;33mvar\u001b[0m.lb_bucket_override \u001b[38;5;245m?\u001b[0m \u001b[38;5;37m1\u001b[0m \u001b[38;5;245m:\u001b[0m \u001b[38;5;37m0\u001b[0m\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 82,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 83,
                  "Content": "  bucket = \"${random_id.consul_lb_access_logs.hex}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mbucket\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0mrandom_id.consul_lb_access_logs.hex\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 84,
                  "Content": "  acl    = \"private\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245macl\u001b[0m    = \u001b[38;5;37m\"private\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 85,
                  "Content": "  tags   = \"${merge(var.tags, map(\"Name\", format(\"%s-consul-lb-access-logs\", var.name)))}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mtags\u001b[0m   = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0mmerge(\u001b[38;5;33mvar\u001b[0m.tags,\u001b[38;5;33m map\u001b[0m(\u001b[38;5;37m\"Name\"\u001b[0m, \u001b[38;5;33mformat\u001b[0m(\u001b[38;5;37m\"%s-consul-lb-access-logs\"\u001b[0m, \u001b[38;5;33mvar\u001b[0m.name)))\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 86,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 87,
                  "Content": "  force_destroy = true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mforce_destroy\u001b[0m = \u001b[38;5;166mtrue",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 88,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 89,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "module.consul_lb_aws",
                "Filename": "github.com/hashicorp-modules/hashistack-aws/main.tf",
                "Location": {
                  "StartLine": 100,
                  "EndLine": 119
                }
              },
              {
                "Resource": "module.hashistack_aws[0]",
                "Filename": "infrastructure-as-code/hashistack/dev/terraform-aws/main.tf",
                "Location": {
                  "StartLine": 90,
                  "EndLine": 113
                }
              }
            ],
            "RenderedCause": {}
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0088",
          "AVDID": "AVD-AWS-0088",
          "Title": "Unencrypted S3 bucket.",
          "Description": "S3 Buckets should be encrypted to protect the data that is stored within them if access is compromised.\n",
          "Message": "Bucket does not have encryption enabled",
          "Namespace": "builtin.aws.s3.aws0088",
          "Query": "data.builtin.aws.s3.aws0088.deny",
          "Resolution": "Configure bucket encryption",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0088",
          "References": [
            "https://docs.aws.amazon.com/AmazonS3/latest/userguide/bucket-encryption.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0088"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "module.hashistack_aws[0]",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 80,
            "EndLine": 110,
            "Code": {
              "Lines": [
                {
                  "Number": 80,
                  "Content": "resource \"aws_s3_bucket\" \"consul_lb_access_logs\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_s3_bucket\"\u001b[0m \u001b[38;5;37m\"consul_lb_access_logs\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 81,
                  "Content": "  count = \"${var.create \u0026\u0026 !var.lb_bucket_override ? 1 : 0}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mcount\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.create \u001b[38;5;245m\u0026\u0026\u001b[0m \u001b[38;5;245m!\u001b[0m\u001b[38;5;33mvar\u001b[0m.lb_bucket_override \u001b[38;5;245m?\u001b[0m \u001b[38;5;37m1\u001b[0m \u001b[38;5;245m:\u001b[0m \u001b[38;5;37m0\u001b[0m\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 82,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 83,
                  "Content": "  bucket = \"${random_id.consul_lb_access_logs.hex}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mbucket\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0mrandom_id.consul_lb_access_logs.hex\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 84,
                  "Content": "  acl    = \"private\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245macl\u001b[0m    = \u001b[38;5;37m\"private\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 85,
                  "Content": "  tags   = \"${merge(var.tags, map(\"Name\", format(\"%s-consul-lb-access-logs\", var.name)))}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mtags\u001b[0m   = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0mmerge(\u001b[38;5;33mvar\u001b[0m.tags,\u001b[38;5;33m map\u001b[0m(\u001b[38;5;37m\"Name\"\u001b[0m, \u001b[38;5;33mformat\u001b[0m(\u001b[38;5;37m\"%s-consul-lb-access-logs\"\u001b[0m, \u001b[38;5;33mvar\u001b[0m.name)))\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 86,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 87,
                  "Content": "  force_destroy = true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mforce_destroy\u001b[0m = \u001b[38;5;166mtrue",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 88,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 89,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "module.consul_lb_aws",
                "Filename": "github.com/hashicorp-modules/hashistack-aws/main.tf",
                "Location": {
                  "StartLine": 100,
                  "EndLine": 119
                }
              },
              {
                "Resource": "module.hashistack_aws[0]",
                "Filename": "infrastructure-as-code/hashistack/dev/terraform-aws/main.tf",
                "Location": {
                  "StartLine": 90,
                  "EndLine": 113
                }
              }
            ],
            "RenderedCause": {}
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "s3-bucket-logging",
          "AVDID": "AVD-AWS-0089",
          "Title": "S3 Bucket Logging",
          "Description": "Ensures S3 bucket logging is enabled for S3 buckets",
          "Message": "Bucket has logging disabled",
          "Namespace": "builtin.aws.s3.aws0089",
          "Query": "data.builtin.aws.s3.aws0089.deny",
          "Resolution": "Add a logging block to the resource to enable access logging",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/s3-bucket-logging",
          "References": [
            "https://docs.aws.amazon.com/AmazonS3/latest/userguide/ServerLogs.html",
            "https://docs.aws.amazon.com/AmazonS3/latest/userguide/enable-server-access-logging.html",
            "https://avd.aquasec.com/misconfig/s3-bucket-logging"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "module.hashistack_aws[0]",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 80,
            "EndLine": 110,
            "Code": {
              "Lines": [
                {
                  "Number": 80,
                  "Content": "resource \"aws_s3_bucket\" \"consul_lb_access_logs\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_s3_bucket\"\u001b[0m \u001b[38;5;37m\"consul_lb_access_logs\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 81,
                  "Content": "  count = \"${var.create \u0026\u0026 !var.lb_bucket_override ? 1 : 0}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mcount\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.create \u001b[38;5;245m\u0026\u0026\u001b[0m \u001b[38;5;245m!\u001b[0m\u001b[38;5;33mvar\u001b[0m.lb_bucket_override \u001b[38;5;245m?\u001b[0m \u001b[38;5;37m1\u001b[0m \u001b[38;5;245m:\u001b[0m \u001b[38;5;37m0\u001b[0m\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 82,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 83,
                  "Content": "  bucket = \"${random_id.consul_lb_access_logs.hex}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mbucket\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0mrandom_id.consul_lb_access_logs.hex\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 84,
                  "Content": "  acl    = \"private\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245macl\u001b[0m    = \u001b[38;5;37m\"private\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 85,
                  "Content": "  tags   = \"${merge(var.tags, map(\"Name\", format(\"%s-consul-lb-access-logs\", var.name)))}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mtags\u001b[0m   = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0mmerge(\u001b[38;5;33mvar\u001b[0m.tags,\u001b[38;5;33m map\u001b[0m(\u001b[38;5;37m\"Name\"\u001b[0m, \u001b[38;5;33mformat\u001b[0m(\u001b[38;5;37m\"%s-consul-lb-access-logs\"\u001b[0m, \u001b[38;5;33mvar\u001b[0m.name)))\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 86,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 87,
                  "Content": "  force_destroy = true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mforce_destroy\u001b[0m = \u001b[38;5;166mtrue",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 88,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 89,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "module.consul_lb_aws",
                "Filename": "github.com/hashicorp-modules/hashistack-aws/main.tf",
                "Location": {
                  "StartLine": 100,
                  "EndLine": 119
                }
              },
              {
                "Resource": "module.hashistack_aws[0]",
                "Filename": "infrastructure-as-code/hashistack/dev/terraform-aws/main.tf",
                "Location": {
                  "StartLine": 90,
                  "EndLine": 113
                }
              }
            ],
            "RenderedCause": {}
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0090",
          "AVDID": "AVD-AWS-0090",
          "Title": "S3 Data should be versioned",
          "Description": "Versioning in Amazon S3 is a means of keeping multiple variants of an object in the same bucket.\n\nYou can use the S3 Versioning feature to preserve, retrieve, and restore every version of every object stored in your buckets.\n\nWith versioning you can recover more easily from both unintended user actions and application failures.\n",
          "Message": "Bucket does not have versioning enabled",
          "Namespace": "builtin.aws.s3.aws0090",
          "Query": "data.builtin.aws.s3.aws0090.deny",
          "Resolution": "Enable versioning to protect against accidental/malicious removal or modification",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0090",
          "References": [
            "https://docs.aws.amazon.com/AmazonS3/latest/userguide/Versioning.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0090"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "module.hashistack_aws[0]",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 80,
            "EndLine": 110,
            "Code": {
              "Lines": [
                {
                  "Number": 80,
                  "Content": "resource \"aws_s3_bucket\" \"consul_lb_access_logs\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_s3_bucket\"\u001b[0m \u001b[38;5;37m\"consul_lb_access_logs\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 81,
                  "Content": "  count = \"${var.create \u0026\u0026 !var.lb_bucket_override ? 1 : 0}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mcount\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.create \u001b[38;5;245m\u0026\u0026\u001b[0m \u001b[38;5;245m!\u001b[0m\u001b[38;5;33mvar\u001b[0m.lb_bucket_override \u001b[38;5;245m?\u001b[0m \u001b[38;5;37m1\u001b[0m \u001b[38;5;245m:\u001b[0m \u001b[38;5;37m0\u001b[0m\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 82,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 83,
                  "Content": "  bucket = \"${random_id.consul_lb_access_logs.hex}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mbucket\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0mrandom_id.consul_lb_access_logs.hex\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 84,
                  "Content": "  acl    = \"private\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245macl\u001b[0m    = \u001b[38;5;37m\"private\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 85,
                  "Content": "  tags   = \"${merge(var.tags, map(\"Name\", format(\"%s-consul-lb-access-logs\", var.name)))}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mtags\u001b[0m   = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0mmerge(\u001b[38;5;33mvar\u001b[0m.tags,\u001b[38;5;33m map\u001b[0m(\u001b[38;5;37m\"Name\"\u001b[0m, \u001b[38;5;33mformat\u001b[0m(\u001b[38;5;37m\"%s-consul-lb-access-logs\"\u001b[0m, \u001b[38;5;33mvar\u001b[0m.name)))\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 86,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 87,
                  "Content": "  force_destroy = true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mforce_destroy\u001b[0m = \u001b[38;5;166mtrue",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 88,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 89,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "module.consul_lb_aws",
                "Filename": "github.com/hashicorp-modules/hashistack-aws/main.tf",
                "Location": {
                  "StartLine": 100,
                  "EndLine": 119
                }
              },
              {
                "Resource": "module.hashistack_aws[0]",
                "Filename": "infrastructure-as-code/hashistack/dev/terraform-aws/main.tf",
                "Location": {
                  "StartLine": 90,
                  "EndLine": 113
                }
              }
            ],
            "RenderedCause": {}
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0091",
          "AVDID": "AVD-AWS-0091",
          "Title": "S3 Access Block should Ignore Public ACL",
          "Description": "S3 buckets should ignore public ACLs on buckets and any objects they contain. By ignoring rather than blocking, PUT calls with public ACLs will still be applied but the ACL will be ignored.\n",
          "Message": "No public access block so not blocking public acls",
          "Namespace": "builtin.aws.s3.aws0091",
          "Query": "data.builtin.aws.s3.aws0091.deny",
          "Resolution": "Enable ignoring the application of public ACLs in PUT calls",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0091",
          "References": [
            "https://docs.aws.amazon.com/AmazonS3/latest/userguide/access-control-block-public-access.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0091"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "module.hashistack_aws[0]",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 80,
            "EndLine": 110,
            "Code": {
              "Lines": [
                {
                  "Number": 80,
                  "Content": "resource \"aws_s3_bucket\" \"consul_lb_access_logs\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_s3_bucket\"\u001b[0m \u001b[38;5;37m\"consul_lb_access_logs\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 81,
                  "Content": "  count = \"${var.create \u0026\u0026 !var.lb_bucket_override ? 1 : 0}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mcount\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.create \u001b[38;5;245m\u0026\u0026\u001b[0m \u001b[38;5;245m!\u001b[0m\u001b[38;5;33mvar\u001b[0m.lb_bucket_override \u001b[38;5;245m?\u001b[0m \u001b[38;5;37m1\u001b[0m \u001b[38;5;245m:\u001b[0m \u001b[38;5;37m0\u001b[0m\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 82,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 83,
                  "Content": "  bucket = \"${random_id.consul_lb_access_logs.hex}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mbucket\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0mrandom_id.consul_lb_access_logs.hex\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 84,
                  "Content": "  acl    = \"private\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245macl\u001b[0m    = \u001b[38;5;37m\"private\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 85,
                  "Content": "  tags   = \"${merge(var.tags, map(\"Name\", format(\"%s-consul-lb-access-logs\", var.name)))}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mtags\u001b[0m   = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0mmerge(\u001b[38;5;33mvar\u001b[0m.tags,\u001b[38;5;33m map\u001b[0m(\u001b[38;5;37m\"Name\"\u001b[0m, \u001b[38;5;33mformat\u001b[0m(\u001b[38;5;37m\"%s-consul-lb-access-logs\"\u001b[0m, \u001b[38;5;33mvar\u001b[0m.name)))\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 86,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 87,
                  "Content": "  force_destroy = true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mforce_destroy\u001b[0m = \u001b[38;5;166mtrue",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 88,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 89,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "module.consul_lb_aws",
                "Filename": "github.com/hashicorp-modules/hashistack-aws/main.tf",
                "Location": {
                  "StartLine": 100,
                  "EndLine": 119
                }
              },
              {
                "Resource": "module.hashistack_aws[0]",
                "Filename": "infrastructure-as-code/hashistack/dev/terraform-aws/main.tf",
                "Location": {
                  "StartLine": 90,
                  "EndLine": 113
                }
              }
            ],
            "RenderedCause": {}
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0093",
          "AVDID": "AVD-AWS-0093",
          "Title": "S3 Access block should restrict public bucket to limit access",
          "Description": "S3 buckets should restrict public policies for the bucket. By enabling, the restrict_public_buckets, only the bucket owner and AWS Services can access if it has a public policy.\n",
          "Message": "No public access block so not restricting public buckets",
          "Namespace": "builtin.aws.s3.aws0093",
          "Query": "data.builtin.aws.s3.aws0093.deny",
          "Resolution": "Limit the access to public buckets to only the owner or AWS Services (eg; CloudFront)",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0093",
          "References": [
            "https://docs.aws.amazon.com/AmazonS3/latest/dev-retired/access-control-block-public-access.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0093"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "module.hashistack_aws[0]",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 80,
            "EndLine": 110,
            "Code": {
              "Lines": [
                {
                  "Number": 80,
                  "Content": "resource \"aws_s3_bucket\" \"consul_lb_access_logs\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_s3_bucket\"\u001b[0m \u001b[38;5;37m\"consul_lb_access_logs\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 81,
                  "Content": "  count = \"${var.create \u0026\u0026 !var.lb_bucket_override ? 1 : 0}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mcount\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.create \u001b[38;5;245m\u0026\u0026\u001b[0m \u001b[38;5;245m!\u001b[0m\u001b[38;5;33mvar\u001b[0m.lb_bucket_override \u001b[38;5;245m?\u001b[0m \u001b[38;5;37m1\u001b[0m \u001b[38;5;245m:\u001b[0m \u001b[38;5;37m0\u001b[0m\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 82,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 83,
                  "Content": "  bucket = \"${random_id.consul_lb_access_logs.hex}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mbucket\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0mrandom_id.consul_lb_access_logs.hex\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 84,
                  "Content": "  acl    = \"private\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245macl\u001b[0m    = \u001b[38;5;37m\"private\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 85,
                  "Content": "  tags   = \"${merge(var.tags, map(\"Name\", format(\"%s-consul-lb-access-logs\", var.name)))}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mtags\u001b[0m   = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0mmerge(\u001b[38;5;33mvar\u001b[0m.tags,\u001b[38;5;33m map\u001b[0m(\u001b[38;5;37m\"Name\"\u001b[0m, \u001b[38;5;33mformat\u001b[0m(\u001b[38;5;37m\"%s-consul-lb-access-logs\"\u001b[0m, \u001b[38;5;33mvar\u001b[0m.name)))\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 86,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 87,
                  "Content": "  force_destroy = true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mforce_destroy\u001b[0m = \u001b[38;5;166mtrue",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 88,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 89,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "module.consul_lb_aws",
                "Filename": "github.com/hashicorp-modules/hashistack-aws/main.tf",
                "Location": {
                  "StartLine": 100,
                  "EndLine": 119
                }
              },
              {
                "Resource": "module.hashistack_aws[0]",
                "Filename": "infrastructure-as-code/hashistack/dev/terraform-aws/main.tf",
                "Location": {
                  "StartLine": 90,
                  "EndLine": 113
                }
              }
            ],
            "RenderedCause": {}
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0094",
          "AVDID": "AVD-AWS-0094",
          "Title": "S3 buckets should each define an aws_s3_bucket_public_access_block",
          "Description": "The \"block public access\" settings in S3 override individual policies that apply to a given bucket, meaning that all public access can be controlled in one central types for that bucket. It is therefore good practice to define these settings for each bucket in order to clearly define the public access that can be allowed for it.\n",
          "Message": "Bucket does not have a corresponding public access block.",
          "Namespace": "builtin.aws.s3.aws0094",
          "Query": "data.builtin.aws.s3.aws0094.deny",
          "Resolution": "Define a aws_s3_bucket_public_access_block for the given bucket to control public access policies",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0094",
          "References": [
            "https://docs.aws.amazon.com/AmazonS3/latest/userguide/access-control-block-public-access.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0094"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "module.hashistack_aws[0]",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 80,
            "EndLine": 110,
            "Code": {
              "Lines": [
                {
                  "Number": 80,
                  "Content": "resource \"aws_s3_bucket\" \"consul_lb_access_logs\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_s3_bucket\"\u001b[0m \u001b[38;5;37m\"consul_lb_access_logs\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 81,
                  "Content": "  count = \"${var.create \u0026\u0026 !var.lb_bucket_override ? 1 : 0}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mcount\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.create \u001b[38;5;245m\u0026\u0026\u001b[0m \u001b[38;5;245m!\u001b[0m\u001b[38;5;33mvar\u001b[0m.lb_bucket_override \u001b[38;5;245m?\u001b[0m \u001b[38;5;37m1\u001b[0m \u001b[38;5;245m:\u001b[0m \u001b[38;5;37m0\u001b[0m\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 82,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 83,
                  "Content": "  bucket = \"${random_id.consul_lb_access_logs.hex}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mbucket\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0mrandom_id.consul_lb_access_logs.hex\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 84,
                  "Content": "  acl    = \"private\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245macl\u001b[0m    = \u001b[38;5;37m\"private\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 85,
                  "Content": "  tags   = \"${merge(var.tags, map(\"Name\", format(\"%s-consul-lb-access-logs\", var.name)))}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mtags\u001b[0m   = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0mmerge(\u001b[38;5;33mvar\u001b[0m.tags,\u001b[38;5;33m map\u001b[0m(\u001b[38;5;37m\"Name\"\u001b[0m, \u001b[38;5;33mformat\u001b[0m(\u001b[38;5;37m\"%s-consul-lb-access-logs\"\u001b[0m, \u001b[38;5;33mvar\u001b[0m.name)))\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 86,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 87,
                  "Content": "  force_destroy = true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mforce_destroy\u001b[0m = \u001b[38;5;166mtrue",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 88,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 89,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "module.consul_lb_aws",
                "Filename": "github.com/hashicorp-modules/hashistack-aws/main.tf",
                "Location": {
                  "StartLine": 100,
                  "EndLine": 119
                }
              },
              {
                "Resource": "module.hashistack_aws[0]",
                "Filename": "infrastructure-as-code/hashistack/dev/terraform-aws/main.tf",
                "Location": {
                  "StartLine": 90,
                  "EndLine": 113
                }
              }
            ],
            "RenderedCause": {}
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "aws-vpc-no-public-egress-sgr",
          "AVDID": "AVD-AWS-0104",
          "Title": "A security group rule should not allow unrestricted egress to any IP address.",
          "Description": "Opening up ports to connect out to the public internet is generally to be avoided. You should restrict access to IP addresses or ranges that are explicitly required where possible.\n",
          "Message": "Security group rule allows unrestricted egress to any IP address.",
          "Namespace": "builtin.aws.ec2.aws0104",
          "Query": "data.builtin.aws.ec2.aws0104.deny",
          "Resolution": "Set a more restrictive cidr range",
          "Severity": "CRITICAL",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/aws-vpc-no-public-egress-sgr",
          "References": [
            "https://docs.aws.amazon.com/whitepapers/latest/building-scalable-secure-multi-vpc-network-infrastructure/centralized-egress-to-internet.html",
            "https://avd.aquasec.com/misconfig/aws-vpc-no-public-egress-sgr"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "module.hashistack_aws[0]",
            "Provider": "AWS",
            "Service": "ec2",
            "StartLine": 66,
            "EndLine": 66,
            "Code": {
              "Lines": [
                {
                  "Number": 58,
                  "Content": "resource \"aws_security_group_rule\" \"outbound_tcp\" {",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_security_group_rule\"\u001b[0m \u001b[38;5;37m\"outbound_tcp\"\u001b[0m {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 59,
                  "Content": "  count = \"${var.create ? 1 : 0}\"",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mcount\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.create \u001b[38;5;245m?\u001b[0m \u001b[38;5;37m1\u001b[0m \u001b[38;5;245m:\u001b[0m \u001b[38;5;37m0\u001b[0m\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 60,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 61,
                  "Content": "  security_group_id = \"${aws_security_group.consul_lb.id}\"",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245msecurity_group_id\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0maws_security_group.consul_lb.id\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 62,
                  "Content": "  type              = \"egress\"",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mtype\u001b[0m              = \u001b[38;5;37m\"egress\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 63,
                  "Content": "  protocol          = \"tcp\"",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mprotocol\u001b[0m          = \u001b[38;5;37m\"tcp\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 64,
                  "Content": "  from_port         = 0",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mfrom_port\u001b[0m         = \u001b[38;5;37m0",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 65,
                  "Content": "  to_port           = 65535",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mto_port\u001b[0m           = \u001b[38;5;37m65535",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 66,
                  "Content": "  cidr_blocks       = [\"0.0.0.0/0\"]",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mcidr_blocks\u001b[0m       = [\u001b[38;5;37m\"0.0.0.0/0\"\u001b[0m]",
                  "FirstCause": true,
                  "LastCause": true
                },
                {
                  "Number": 67,
                  "Content": "}",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "}",
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "aws_security_group_rule.outbound_tcp[0]",
                "Filename": "github.com/hashicorp-modules/hashistack-aws/github.com/hashicorp-modules/consul-lb-aws/main.tf",
                "Location": {
                  "StartLine": 58,
                  "EndLine": 67
                }
              },
              {
                "Resource": "module.consul_lb_aws",
                "Filename": "github.com/hashicorp-modules/hashistack-aws/main.tf",
                "Location": {
                  "StartLine": 100,
                  "EndLine": 119
                }
              },
              {
                "Resource": "module.hashistack_aws[0]",
                "Filename": "infrastructure-as-code/hashistack/dev/terraform-aws/main.tf",
                "Location": {
                  "StartLine": 90,
                  "EndLine": 113
                }
              }
            ],
            "RenderedCause": {}
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "aws-vpc-add-description-to-security-group-rule",
          "AVDID": "AVD-AWS-0124",
          "Title": "Missing description for security group rule.",
          "Description": "Security group rules should include a description for auditing purposes.\n\nSimplifies auditing, debugging, and managing security groups.\n",
          "Message": "Security group rule does not have a description.",
          "Namespace": "builtin.aws.ec2.aws0124",
          "Query": "data.builtin.aws.ec2.aws0124.deny",
          "Resolution": "Add descriptions for all security groups rules",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/aws-vpc-add-description-to-security-group-rule",
          "References": [
            "https://www.cloudconformity.com/knowledge-base/aws/EC2/security-group-rules-description.html",
            "https://avd.aquasec.com/misconfig/aws-vpc-add-description-to-security-group-rule"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "module.hashistack_aws[0]",
            "Provider": "AWS",
            "Service": "ec2",
            "StartLine": 58,
            "EndLine": 67,
            "Code": {
              "Lines": [
                {
                  "Number": 58,
                  "Content": "resource \"aws_security_group_rule\" \"outbound_tcp\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_security_group_rule\"\u001b[0m \u001b[38;5;37m\"outbound_tcp\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 59,
                  "Content": "  count = \"${var.create ? 1 : 0}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mcount\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.create \u001b[38;5;245m?\u001b[0m \u001b[38;5;37m1\u001b[0m \u001b[38;5;245m:\u001b[0m \u001b[38;5;37m0\u001b[0m\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 60,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 61,
                  "Content": "  security_group_id = \"${aws_security_group.consul_lb.id}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245msecurity_group_id\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0maws_security_group.consul_lb.id\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 62,
                  "Content": "  type              = \"egress\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mtype\u001b[0m              = \u001b[38;5;37m\"egress\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 63,
                  "Content": "  protocol          = \"tcp\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mprotocol\u001b[0m          = \u001b[38;5;37m\"tcp\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 64,
                  "Content": "  from_port         = 0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mfrom_port\u001b[0m         = \u001b[38;5;37m0",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 65,
                  "Content": "  to_port           = 65535",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mto_port\u001b[0m           = \u001b[38;5;37m65535",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 66,
                  "Content": "  cidr_blocks       = [\"0.0.0.0/0\"]",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mcidr_blocks\u001b[0m       = [\u001b[38;5;37m\"0.0.0.0/0\"\u001b[0m]",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 67,
                  "Content": "}",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "}",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "module.consul_lb_aws",
                "Filename": "github.com/hashicorp-modules/hashistack-aws/main.tf",
                "Location": {
                  "StartLine": 100,
                  "EndLine": 119
                }
              },
              {
                "Resource": "module.hashistack_aws[0]",
                "Filename": "infrastructure-as-code/hashistack/dev/terraform-aws/main.tf",
                "Location": {
                  "StartLine": 90,
                  "EndLine": 113
                }
              }
            ],
            "RenderedCause": {}
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "aws-vpc-add-description-to-security-group-rule",
          "AVDID": "AVD-AWS-0124",
          "Title": "Missing description for security group rule.",
          "Description": "Security group rules should include a description for auditing purposes.\n\nSimplifies auditing, debugging, and managing security groups.\n",
          "Message": "Security group rule does not have a description.",
          "Namespace": "builtin.aws.ec2.aws0124",
          "Query": "data.builtin.aws.ec2.aws0124.deny",
          "Resolution": "Add descriptions for all security groups rules",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/aws-vpc-add-description-to-security-group-rule",
          "References": [
            "https://www.cloudconformity.com/knowledge-base/aws/EC2/security-group-rules-description.html",
            "https://avd.aquasec.com/misconfig/aws-vpc-add-description-to-security-group-rule"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "module.hashistack_aws[0]",
            "Provider": "AWS",
            "Service": "ec2",
            "StartLine": 14,
            "EndLine": 23,
            "Code": {
              "Lines": [
                {
                  "Number": 14,
                  "Content": "resource \"aws_security_group_rule\" \"consul_lb_http_80\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_security_group_rule\"\u001b[0m \u001b[38;5;37m\"consul_lb_http_80\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 15,
                  "Content": "  count = \"${var.create ? 1 : 0}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mcount\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.create \u001b[38;5;245m?\u001b[0m \u001b[38;5;37m1\u001b[0m \u001b[38;5;245m:\u001b[0m \u001b[38;5;37m0\u001b[0m\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 16,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 17,
                  "Content": "  security_group_id = \"${aws_security_group.consul_lb.id}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245msecurity_group_id\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0maws_security_group.consul_lb.id\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 18,
                  "Content": "  type              = \"ingress\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mtype\u001b[0m              = \u001b[38;5;37m\"ingress\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "  protocol          = \"tcp\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mprotocol\u001b[0m          = \u001b[38;5;37m\"tcp\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "  from_port         = 80",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mfrom_port\u001b[0m         = \u001b[38;5;37m80",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "  to_port           = 80",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mto_port\u001b[0m           = \u001b[38;5;37m80",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "  cidr_blocks       = [\"${split(\",\", var.is_internal_lb ? join(\",\", var.cidr_blocks) : \"0.0.0.0/0\")}\"]",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mcidr_blocks\u001b[0m       = [\u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33msplit\u001b[0m(\u001b[38;5;37m\",\"\u001b[0m, \u001b[38;5;33mvar\u001b[0m.is_internal_lb \u001b[38;5;245m?\u001b[0m \u001b[38;5;33mjoin\u001b[0m(\u001b[38;5;37m\",\"\u001b[0m, \u001b[38;5;33mvar\u001b[0m.cidr_blocks) \u001b[38;5;245m:\u001b[0m \u001b[38;5;37m\"0.0.0.0/0\"\u001b[0m)\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"\u001b[0m]",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "}",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "}",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "module.consul_lb_aws",
                "Filename": "github.com/hashicorp-modules/hashistack-aws/main.tf",
                "Location": {
                  "StartLine": 100,
                  "EndLine": 119
                }
              },
              {
                "Resource": "module.hashistack_aws[0]",
                "Filename": "infrastructure-as-code/hashistack/dev/terraform-aws/main.tf",
                "Location": {
                  "StartLine": 90,
                  "EndLine": 113
                }
              }
            ],
            "RenderedCause": {}
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "aws-vpc-add-description-to-security-group-rule",
          "AVDID": "AVD-AWS-0124",
          "Title": "Missing description for security group rule.",
          "Description": "Security group rules should include a description for auditing purposes.\n\nSimplifies auditing, debugging, and managing security groups.\n",
          "Message": "Security group rule does not have a description.",
          "Namespace": "builtin.aws.ec2.aws0124",
          "Query": "data.builtin.aws.ec2.aws0124.deny",
          "Resolution": "Add descriptions for all security groups rules",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/aws-vpc-add-description-to-security-group-rule",
          "References": [
            "https://www.cloudconformity.com/knowledge-base/aws/EC2/security-group-rules-description.html",
            "https://avd.aquasec.com/misconfig/aws-vpc-add-description-to-security-group-rule"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "module.hashistack_aws[0]",
            "Provider": "AWS",
            "Service": "ec2",
            "StartLine": 36,
            "EndLine": 45,
            "Code": {
              "Lines": [
                {
                  "Number": 36,
                  "Content": "resource \"aws_security_group_rule\" \"consul_lb_tcp_8500\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_security_group_rule\"\u001b[0m \u001b[38;5;37m\"consul_lb_tcp_8500\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 37,
                  "Content": "  count = \"${var.create ? 1 : 0}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mcount\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.create \u001b[38;5;245m?\u001b[0m \u001b[38;5;37m1\u001b[0m \u001b[38;5;245m:\u001b[0m \u001b[38;5;37m0\u001b[0m\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 38,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 39,
                  "Content": "  security_group_id = \"${aws_security_group.consul_lb.id}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245msecurity_group_id\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0maws_security_group.consul_lb.id\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 40,
                  "Content": "  type              = \"ingress\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mtype\u001b[0m              = \u001b[38;5;37m\"ingress\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 41,
                  "Content": "  protocol          = \"tcp\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mprotocol\u001b[0m          = \u001b[38;5;37m\"tcp\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 42,
                  "Content": "  from_port         = 8500",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mfrom_port\u001b[0m         = \u001b[38;5;37m8500",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 43,
                  "Content": "  to_port           = 8500",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mto_port\u001b[0m           = \u001b[38;5;37m8500",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 44,
                  "Content": "  cidr_blocks       = [\"${split(\",\", var.is_internal_lb ? join(\",\", var.cidr_blocks) : \"0.0.0.0/0\")}\"]",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mcidr_blocks\u001b[0m       = [\u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33msplit\u001b[0m(\u001b[38;5;37m\",\"\u001b[0m, \u001b[38;5;33mvar\u001b[0m.is_internal_lb \u001b[38;5;245m?\u001b[0m \u001b[38;5;33mjoin\u001b[0m(\u001b[38;5;37m\",\"\u001b[0m, \u001b[38;5;33mvar\u001b[0m.cidr_blocks) \u001b[38;5;245m:\u001b[0m \u001b[38;5;37m\"0.0.0.0/0\"\u001b[0m)\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"\u001b[0m]",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 45,
                  "Content": "}",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "}",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "module.consul_lb_aws",
                "Filename": "github.com/hashicorp-modules/hashistack-aws/main.tf",
                "Location": {
                  "StartLine": 100,
                  "EndLine": 119
                }
              },
              {
                "Resource": "module.hashistack_aws[0]",
                "Filename": "infrastructure-as-code/hashistack/dev/terraform-aws/main.tf",
                "Location": {
                  "StartLine": 90,
                  "EndLine": 113
                }
              }
            ],
            "RenderedCause": {}
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "aws-vpc-add-description-to-security-group-rule",
          "AVDID": "AVD-AWS-0124",
          "Title": "Missing description for security group rule.",
          "Description": "Security group rules should include a description for auditing purposes.\n\nSimplifies auditing, debugging, and managing security groups.\n",
          "Message": "Security group rule does not have a description.",
          "Namespace": "builtin.aws.ec2.aws0124",
          "Query": "data.builtin.aws.ec2.aws0124.deny",
          "Resolution": "Add descriptions for all security groups rules",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/aws-vpc-add-description-to-security-group-rule",
          "References": [
            "https://www.cloudconformity.com/knowledge-base/aws/EC2/security-group-rules-description.html",
            "https://avd.aquasec.com/misconfig/aws-vpc-add-description-to-security-group-rule"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "module.hashistack_aws[0]",
            "Provider": "AWS",
            "Service": "ec2",
            "StartLine": 47,
            "EndLine": 56,
            "Code": {
              "Lines": [
                {
                  "Number": 47,
                  "Content": "resource \"aws_security_group_rule\" \"consul_lb_tcp_8080\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_security_group_rule\"\u001b[0m \u001b[38;5;37m\"consul_lb_tcp_8080\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 48,
                  "Content": "  count = \"${var.create ? 1 : 0}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mcount\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.create \u001b[38;5;245m?\u001b[0m \u001b[38;5;37m1\u001b[0m \u001b[38;5;245m:\u001b[0m \u001b[38;5;37m0\u001b[0m\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 49,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 50,
                  "Content": "  security_group_id = \"${aws_security_group.consul_lb.id}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245msecurity_group_id\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0maws_security_group.consul_lb.id\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 51,
                  "Content": "  type              = \"ingress\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mtype\u001b[0m              = \u001b[38;5;37m\"ingress\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 52,
                  "Content": "  protocol          = \"tcp\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mprotocol\u001b[0m          = \u001b[38;5;37m\"tcp\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 53,
                  "Content": "  from_port         = 8080",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mfrom_port\u001b[0m         = \u001b[38;5;37m8080",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 54,
                  "Content": "  to_port           = 8080",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mto_port\u001b[0m           = \u001b[38;5;37m8080",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 55,
                  "Content": "  cidr_blocks       = [\"${split(\",\", var.is_internal_lb ? join(\",\", var.cidr_blocks) : \"0.0.0.0/0\")}\"]",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mcidr_blocks\u001b[0m       = [\u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33msplit\u001b[0m(\u001b[38;5;37m\",\"\u001b[0m, \u001b[38;5;33mvar\u001b[0m.is_internal_lb \u001b[38;5;245m?\u001b[0m \u001b[38;5;33mjoin\u001b[0m(\u001b[38;5;37m\",\"\u001b[0m, \u001b[38;5;33mvar\u001b[0m.cidr_blocks) \u001b[38;5;245m:\u001b[0m \u001b[38;5;37m\"0.0.0.0/0\"\u001b[0m)\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"\u001b[0m]",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 56,
                  "Content": "}",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "}",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "module.consul_lb_aws",
                "Filename": "github.com/hashicorp-modules/hashistack-aws/main.tf",
                "Location": {
                  "StartLine": 100,
                  "EndLine": 119
                }
              },
              {
                "Resource": "module.hashistack_aws[0]",
                "Filename": "infrastructure-as-code/hashistack/dev/terraform-aws/main.tf",
                "Location": {
                  "StartLine": 90,
                  "EndLine": 113
                }
              }
            ],
            "RenderedCause": {}
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0132",
          "AVDID": "AVD-AWS-0132",
          "Title": "S3 encryption should use Customer Managed Keys",
          "Description": "Encryption using AWS keys provides protection for your S3 buckets. To increase control of the encryption and manage factors like rotation use customer managed keys.\n",
          "Message": "Bucket does not encrypt data with a customer managed key.",
          "Namespace": "builtin.aws.s3.aws0132",
          "Query": "data.builtin.aws.s3.aws0132.deny",
          "Resolution": "Enable encryption using customer managed keys",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0132",
          "References": [
            "https://docs.aws.amazon.com/AmazonS3/latest/userguide/bucket-encryption.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0132"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "module.hashistack_aws[0]",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 80,
            "EndLine": 110,
            "Code": {
              "Lines": [
                {
                  "Number": 80,
                  "Content": "resource \"aws_s3_bucket\" \"consul_lb_access_logs\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_s3_bucket\"\u001b[0m \u001b[38;5;37m\"consul_lb_access_logs\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 81,
                  "Content": "  count = \"${var.create \u0026\u0026 !var.lb_bucket_override ? 1 : 0}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mcount\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.create \u001b[38;5;245m\u0026\u0026\u001b[0m \u001b[38;5;245m!\u001b[0m\u001b[38;5;33mvar\u001b[0m.lb_bucket_override \u001b[38;5;245m?\u001b[0m \u001b[38;5;37m1\u001b[0m \u001b[38;5;245m:\u001b[0m \u001b[38;5;37m0\u001b[0m\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 82,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 83,
                  "Content": "  bucket = \"${random_id.consul_lb_access_logs.hex}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mbucket\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0mrandom_id.consul_lb_access_logs.hex\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 84,
                  "Content": "  acl    = \"private\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245macl\u001b[0m    = \u001b[38;5;37m\"private\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 85,
                  "Content": "  tags   = \"${merge(var.tags, map(\"Name\", format(\"%s-consul-lb-access-logs\", var.name)))}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mtags\u001b[0m   = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0mmerge(\u001b[38;5;33mvar\u001b[0m.tags,\u001b[38;5;33m map\u001b[0m(\u001b[38;5;37m\"Name\"\u001b[0m, \u001b[38;5;33mformat\u001b[0m(\u001b[38;5;37m\"%s-consul-lb-access-logs\"\u001b[0m, \u001b[38;5;33mvar\u001b[0m.name)))\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 86,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 87,
                  "Content": "  force_destroy = true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mforce_destroy\u001b[0m = \u001b[38;5;166mtrue",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 88,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 89,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "module.consul_lb_aws",
                "Filename": "github.com/hashicorp-modules/hashistack-aws/main.tf",
                "Location": {
                  "StartLine": 100,
                  "EndLine": 119
                }
              },
              {
                "Resource": "module.hashistack_aws[0]",
                "Filename": "infrastructure-as-code/hashistack/dev/terraform-aws/main.tf",
                "Location": {
                  "StartLine": 90,
                  "EndLine": 113
                }
              }
            ],
            "RenderedCause": {}
          }
        }
      ]
    },
    {
      "Target": "github.com/hashicorp-modules/hashistack-aws/github.com/hashicorp-modules/consul-server-ports-aws/github.com/hashicorp-modules/consul-client-ports-aws/main.tf",
      "Class": "config",
      "Type": "terraform",
      "MisconfSummary": {
        "Successes": 0,
        "Failures": 11
      },
      "Misconfigurations": [
        {
          "Type": "Terraform Security Check",
          "ID": "aws-vpc-no-public-egress-sgr",
          "AVDID": "AVD-AWS-0104",
          "Title": "A security group rule should not allow unrestricted egress to any IP address.",
          "Description": "Opening up ports to connect out to the public internet is generally to be avoided. You should restrict access to IP addresses or ranges that are explicitly required where possible.\n",
          "Message": "Security group rule allows unrestricted egress to any IP address.",
          "Namespace": "builtin.aws.ec2.aws0104",
          "Query": "data.builtin.aws.ec2.aws0104.deny",
          "Resolution": "Set a more restrictive cidr range",
          "Severity": "CRITICAL",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/aws-vpc-no-public-egress-sgr",
          "References": [
            "https://docs.aws.amazon.com/whitepapers/latest/building-scalable-secure-multi-vpc-network-infrastructure/centralized-egress-to-internet.html",
            "https://avd.aquasec.com/misconfig/aws-vpc-no-public-egress-sgr"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "module.hashistack_aws[0]",
            "Provider": "AWS",
            "Service": "ec2",
            "StartLine": 122,
            "EndLine": 122,
            "Code": {
              "Lines": [
                {
                  "Number": 114,
                  "Content": "resource \"aws_security_group_rule\" \"outbound_udp\" {",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_security_group_rule\"\u001b[0m \u001b[38;5;37m\"outbound_udp\"\u001b[0m {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 115,
                  "Content": "  count = \"${var.create ? 1 : 0}\"",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mcount\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.create \u001b[38;5;245m?\u001b[0m \u001b[38;5;37m1\u001b[0m \u001b[38;5;245m:\u001b[0m \u001b[38;5;37m0\u001b[0m\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 116,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 117,
                  "Content": "  security_group_id = \"${aws_security_group.consul_client.id}\"",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245msecurity_group_id\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0maws_security_group.consul_client.id\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 118,
                  "Content": "  type              = \"egress\"",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mtype\u001b[0m              = \u001b[38;5;37m\"egress\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 119,
                  "Content": "  protocol          = \"udp\"",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mprotocol\u001b[0m          = \u001b[38;5;37m\"udp\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 120,
                  "Content": "  from_port         = 0",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mfrom_port\u001b[0m         = \u001b[38;5;37m0",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 121,
                  "Content": "  to_port           = 65535",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mto_port\u001b[0m           = \u001b[38;5;37m65535",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 122,
                  "Content": "  cidr_blocks       = [\"0.0.0.0/0\"]",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mcidr_blocks\u001b[0m       = [\u001b[38;5;37m\"0.0.0.0/0\"\u001b[0m]",
                  "FirstCause": true,
                  "LastCause": true
                },
                {
                  "Number": 123,
                  "Content": "}",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "}",
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "aws_security_group_rule.outbound_udp[0]",
                "Filename": "github.com/hashicorp-modules/hashistack-aws/github.com/hashicorp-modules/consul-server-ports-aws/github.com/hashicorp-modules/consul-client-ports-aws/main.tf",
                "Location": {
                  "StartLine": 114,
                  "EndLine": 123
                }
              },
              {
                "Resource": "module.consul_client_ports_aws",
                "Filename": "github.com/hashicorp-modules/hashistack-aws/github.com/hashicorp-modules/consul-server-ports-aws/main.tf",
                "Location": {
                  "StartLine": 6,
                  "EndLine": 14
                }
              },
              {
                "Resource": "module.consul_server_sg",
                "Filename": "github.com/hashicorp-modules/hashistack-aws/main.tf",
                "Location": {
                  "StartLine": 39,
                  "EndLine": 46
                }
              },
              {
                "Resource": "module.hashistack_aws[0]",
                "Filename": "infrastructure-as-code/hashistack/dev/terraform-aws/main.tf",
                "Location": {
                  "StartLine": 90,
                  "EndLine": 113
                }
              }
            ],
            "RenderedCause": {}
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "aws-vpc-no-public-egress-sgr",
          "AVDID": "AVD-AWS-0104",
          "Title": "A security group rule should not allow unrestricted egress to any IP address.",
          "Description": "Opening up ports to connect out to the public internet is generally to be avoided. You should restrict access to IP addresses or ranges that are explicitly required where possible.\n",
          "Message": "Security group rule allows unrestricted egress to any IP address.",
          "Namespace": "builtin.aws.ec2.aws0104",
          "Query": "data.builtin.aws.ec2.aws0104.deny",
          "Resolution": "Set a more restrictive cidr range",
          "Severity": "CRITICAL",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/aws-vpc-no-public-egress-sgr",
          "References": [
            "https://docs.aws.amazon.com/whitepapers/latest/building-scalable-secure-multi-vpc-network-infrastructure/centralized-egress-to-internet.html",
            "https://avd.aquasec.com/misconfig/aws-vpc-no-public-egress-sgr"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "module.hashistack_aws[0]",
            "Provider": "AWS",
            "Service": "ec2",
            "StartLine": 110,
            "EndLine": 110,
            "Code": {
              "Lines": [
                {
                  "Number": 102,
                  "Content": "resource \"aws_security_group_rule\" \"outbound_tcp\" {",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_security_group_rule\"\u001b[0m \u001b[38;5;37m\"outbound_tcp\"\u001b[0m {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 103,
                  "Content": "  count = \"${var.create ? 1 : 0}\"",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mcount\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.create \u001b[38;5;245m?\u001b[0m \u001b[38;5;37m1\u001b[0m \u001b[38;5;245m:\u001b[0m \u001b[38;5;37m0\u001b[0m\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 104,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 105,
                  "Content": "  security_group_id = \"${aws_security_group.consul_client.id}\"",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245msecurity_group_id\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0maws_security_group.consul_client.id\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 106,
                  "Content": "  type              = \"egress\"",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mtype\u001b[0m              = \u001b[38;5;37m\"egress\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 107,
                  "Content": "  protocol          = \"tcp\"",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mprotocol\u001b[0m          = \u001b[38;5;37m\"tcp\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 108,
                  "Content": "  from_port         = 0",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mfrom_port\u001b[0m         = \u001b[38;5;37m0",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 109,
                  "Content": "  to_port           = 65535",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mto_port\u001b[0m           = \u001b[38;5;37m65535",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 110,
                  "Content": "  cidr_blocks       = [\"0.0.0.0/0\"]",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mcidr_blocks\u001b[0m       = [\u001b[38;5;37m\"0.0.0.0/0\"\u001b[0m]",
                  "FirstCause": true,
                  "LastCause": true
                },
                {
                  "Number": 111,
                  "Content": "}",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "}",
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "aws_security_group_rule.outbound_tcp[0]",
                "Filename": "github.com/hashicorp-modules/hashistack-aws/github.com/hashicorp-modules/consul-server-ports-aws/github.com/hashicorp-modules/consul-client-ports-aws/main.tf",
                "Location": {
                  "StartLine": 102,
                  "EndLine": 111
                }
              },
              {
                "Resource": "module.consul_client_ports_aws",
                "Filename": "github.com/hashicorp-modules/hashistack-aws/github.com/hashicorp-modules/consul-server-ports-aws/main.tf",
                "Location": {
                  "StartLine": 6,
                  "EndLine": 14
                }
              },
              {
                "Resource": "module.consul_server_sg",
                "Filename": "github.com/hashicorp-modules/hashistack-aws/main.tf",
                "Location": {
                  "StartLine": 39,
                  "EndLine": 46
                }
              },
              {
                "Resource": "module.hashistack_aws[0]",
                "Filename": "infrastructure-as-code/hashistack/dev/terraform-aws/main.tf",
                "Location": {
                  "StartLine": 90,
                  "EndLine": 113
                }
              }
            ],
            "RenderedCause": {}
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "aws-vpc-add-description-to-security-group-rule",
          "AVDID": "AVD-AWS-0124",
          "Title": "Missing description for security group rule.",
          "Description": "Security group rules should include a description for auditing purposes.\n\nSimplifies auditing, debugging, and managing security groups.\n",
          "Message": "Security group rule does not have a description.",
          "Namespace": "builtin.aws.ec2.aws0124",
          "Query": "data.builtin.aws.ec2.aws0124.deny",
          "Resolution": "Add descriptions for all security groups rules",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/aws-vpc-add-description-to-security-group-rule",
          "References": [
            "https://www.cloudconformity.com/knowledge-base/aws/EC2/security-group-rules-description.html",
            "https://avd.aquasec.com/misconfig/aws-vpc-add-description-to-security-group-rule"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "module.hashistack_aws[0]",
            "Provider": "AWS",
            "Service": "ec2",
            "StartLine": 90,
            "EndLine": 99,
            "Code": {
              "Lines": [
                {
                  "Number": 90,
                  "Content": "resource \"aws_security_group_rule\" \"dns_interface_udp\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_security_group_rule\"\u001b[0m \u001b[38;5;37m\"dns_interface_udp\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 91,
                  "Content": "  count = \"${var.create ? 1 : 0}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mcount\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.create \u001b[38;5;245m?\u001b[0m \u001b[38;5;37m1\u001b[0m \u001b[38;5;245m:\u001b[0m \u001b[38;5;37m0\u001b[0m\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 92,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 93,
                  "Content": "  security_group_id = \"${aws_security_group.consul_client.id}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245msecurity_group_id\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0maws_security_group.consul_client.id\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 94,
                  "Content": "  type              = \"ingress\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mtype\u001b[0m              = \u001b[38;5;37m\"ingress\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 95,
                  "Content": "  protocol          = \"udp\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mprotocol\u001b[0m          = \u001b[38;5;37m\"udp\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 96,
                  "Content": "  from_port         = 8600",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mfrom_port\u001b[0m         = \u001b[38;5;37m8600",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 97,
                  "Content": "  to_port           = 8600",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mto_port\u001b[0m           = \u001b[38;5;37m8600",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 98,
                  "Content": "  cidr_blocks       = [\"${var.cidr_blocks}\"]",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mcidr_blocks\u001b[0m       = [\u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.cidr_blocks\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"\u001b[0m]",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 99,
                  "Content": "}",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "}",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "module.consul_client_ports_aws",
                "Filename": "github.com/hashicorp-modules/hashistack-aws/github.com/hashicorp-modules/consul-server-ports-aws/main.tf",
                "Location": {
                  "StartLine": 6,
                  "EndLine": 14
                }
              },
              {
                "Resource": "module.consul_server_sg",
                "Filename": "github.com/hashicorp-modules/hashistack-aws/main.tf",
                "Location": {
                  "StartLine": 39,
                  "EndLine": 46
                }
              },
              {
                "Resource": "module.hashistack_aws[0]",
                "Filename": "infrastructure-as-code/hashistack/dev/terraform-aws/main.tf",
                "Location": {
                  "StartLine": 90,
                  "EndLine": 113
                }
              }
            ],
            "RenderedCause": {}
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "aws-vpc-add-description-to-security-group-rule",
          "AVDID": "AVD-AWS-0124",
          "Title": "Missing description for security group rule.",
          "Description": "Security group rules should include a description for auditing purposes.\n\nSimplifies auditing, debugging, and managing security groups.\n",
          "Message": "Security group rule does not have a description.",
          "Namespace": "builtin.aws.ec2.aws0124",
          "Query": "data.builtin.aws.ec2.aws0124.deny",
          "Resolution": "Add descriptions for all security groups rules",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/aws-vpc-add-description-to-security-group-rule",
          "References": [
            "https://www.cloudconformity.com/knowledge-base/aws/EC2/security-group-rules-description.html",
            "https://avd.aquasec.com/misconfig/aws-vpc-add-description-to-security-group-rule"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "module.hashistack_aws[0]",
            "Provider": "AWS",
            "Service": "ec2",
            "StartLine": 78,
            "EndLine": 87,
            "Code": {
              "Lines": [
                {
                  "Number": 78,
                  "Content": "resource \"aws_security_group_rule\" \"dns_interface_tcp\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_security_group_rule\"\u001b[0m \u001b[38;5;37m\"dns_interface_tcp\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 79,
                  "Content": "  count = \"${var.create ? 1 : 0}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mcount\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.create \u001b[38;5;245m?\u001b[0m \u001b[38;5;37m1\u001b[0m \u001b[38;5;245m:\u001b[0m \u001b[38;5;37m0\u001b[0m\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 80,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 81,
                  "Content": "  security_group_id = \"${aws_security_group.consul_client.id}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245msecurity_group_id\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0maws_security_group.consul_client.id\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 82,
                  "Content": "  type              = \"ingress\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mtype\u001b[0m              = \u001b[38;5;37m\"ingress\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 83,
                  "Content": "  protocol          = \"tcp\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mprotocol\u001b[0m          = \u001b[38;5;37m\"tcp\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 84,
                  "Content": "  from_port         = 8600",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mfrom_port\u001b[0m         = \u001b[38;5;37m8600",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 85,
                  "Content": "  to_port           = 8600",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mto_port\u001b[0m           = \u001b[38;5;37m8600",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 86,
                  "Content": "  cidr_blocks       = [\"${var.cidr_blocks}\"]",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mcidr_blocks\u001b[0m       = [\u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.cidr_blocks\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"\u001b[0m]",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 87,
                  "Content": "}",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "}",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "module.consul_client_ports_aws",
                "Filename": "github.com/hashicorp-modules/hashistack-aws/github.com/hashicorp-modules/consul-server-ports-aws/main.tf",
                "Location": {
                  "StartLine": 6,
                  "EndLine": 14
                }
              },
              {
                "Resource": "module.consul_server_sg",
                "Filename": "github.com/hashicorp-modules/hashistack-aws/main.tf",
                "Location": {
                  "StartLine": 39,
                  "EndLine": 46
                }
              },
              {
                "Resource": "module.hashistack_aws[0]",
                "Filename": "infrastructure-as-code/hashistack/dev/terraform-aws/main.tf",
                "Location": {
                  "StartLine": 90,
                  "EndLine": 113
                }
              }
            ],
            "RenderedCause": {}
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "aws-vpc-add-description-to-security-group-rule",
          "AVDID": "AVD-AWS-0124",
          "Title": "Missing description for security group rule.",
          "Description": "Security group rules should include a description for auditing purposes.\n\nSimplifies auditing, debugging, and managing security groups.\n",
          "Message": "Security group rule does not have a description.",
          "Namespace": "builtin.aws.ec2.aws0124",
          "Query": "data.builtin.aws.ec2.aws0124.deny",
          "Resolution": "Add descriptions for all security groups rules",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/aws-vpc-add-description-to-security-group-rule",
          "References": [
            "https://www.cloudconformity.com/knowledge-base/aws/EC2/security-group-rules-description.html",
            "https://avd.aquasec.com/misconfig/aws-vpc-add-description-to-security-group-rule"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "module.hashistack_aws[0]",
            "Provider": "AWS",
            "Service": "ec2",
            "StartLine": 66,
            "EndLine": 75,
            "Code": {
              "Lines": [
                {
                  "Number": 66,
                  "Content": "resource \"aws_security_group_rule\" \"http_api_tcp\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_security_group_rule\"\u001b[0m \u001b[38;5;37m\"http_api_tcp\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 67,
                  "Content": "  count = \"${var.create ? 1 : 0}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mcount\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.create \u001b[38;5;245m?\u001b[0m \u001b[38;5;37m1\u001b[0m \u001b[38;5;245m:\u001b[0m \u001b[38;5;37m0\u001b[0m\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 68,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 69,
                  "Content": "  security_group_id = \"${aws_security_group.consul_client.id}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245msecurity_group_id\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0maws_security_group.consul_client.id\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 70,
                  "Content": "  type              = \"ingress\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mtype\u001b[0m              = \u001b[38;5;37m\"ingress\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 71,
                  "Content": "  protocol          = \"tcp\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mprotocol\u001b[0m          = \u001b[38;5;37m\"tcp\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 72,
                  "Content": "  from_port         = 8500",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mfrom_port\u001b[0m         = \u001b[38;5;37m8500",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 73,
                  "Content": "  to_port           = 8500",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mto_port\u001b[0m           = \u001b[38;5;37m8500",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 74,
                  "Content": "  cidr_blocks       = [\"${var.cidr_blocks}\"]",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mcidr_blocks\u001b[0m       = [\u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.cidr_blocks\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"\u001b[0m]",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 75,
                  "Content": "}",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "}",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "module.consul_client_ports_aws",
                "Filename": "github.com/hashicorp-modules/hashistack-aws/github.com/hashicorp-modules/consul-server-ports-aws/main.tf",
                "Location": {
                  "StartLine": 6,
                  "EndLine": 14
                }
              },
              {
                "Resource": "module.consul_server_sg",
                "Filename": "github.com/hashicorp-modules/hashistack-aws/main.tf",
                "Location": {
                  "StartLine": 39,
                  "EndLine": 46
                }
              },
              {
                "Resource": "module.hashistack_aws[0]",
                "Filename": "infrastructure-as-code/hashistack/dev/terraform-aws/main.tf",
                "Location": {
                  "StartLine": 90,
                  "EndLine": 113
                }
              }
            ],
            "RenderedCause": {}
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "aws-vpc-add-description-to-security-group-rule",
          "AVDID": "AVD-AWS-0124",
          "Title": "Missing description for security group rule.",
          "Description": "Security group rules should include a description for auditing purposes.\n\nSimplifies auditing, debugging, and managing security groups.\n",
          "Message": "Security group rule does not have a description.",
          "Namespace": "builtin.aws.ec2.aws0124",
          "Query": "data.builtin.aws.ec2.aws0124.deny",
          "Resolution": "Add descriptions for all security groups rules",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/aws-vpc-add-description-to-security-group-rule",
          "References": [
            "https://www.cloudconformity.com/knowledge-base/aws/EC2/security-group-rules-description.html",
            "https://avd.aquasec.com/misconfig/aws-vpc-add-description-to-security-group-rule"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "module.hashistack_aws[0]",
            "Provider": "AWS",
            "Service": "ec2",
            "StartLine": 54,
            "EndLine": 63,
            "Code": {
              "Lines": [
                {
                  "Number": 54,
                  "Content": "resource \"aws_security_group_rule\" \"cli_rpc_tcp\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_security_group_rule\"\u001b[0m \u001b[38;5;37m\"cli_rpc_tcp\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 55,
                  "Content": "  count = \"${var.create ? 1 : 0}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mcount\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.create \u001b[38;5;245m?\u001b[0m \u001b[38;5;37m1\u001b[0m \u001b[38;5;245m:\u001b[0m \u001b[38;5;37m0\u001b[0m\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 56,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 57,
                  "Content": "  security_group_id = \"${aws_security_group.consul_client.id}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245msecurity_group_id\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0maws_security_group.consul_client.id\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 58,
                  "Content": "  type              = \"ingress\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mtype\u001b[0m              = \u001b[38;5;37m\"ingress\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 59,
                  "Content": "  protocol          = \"tcp\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mprotocol\u001b[0m          = \u001b[38;5;37m\"tcp\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 60,
                  "Content": "  from_port         = 8400",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mfrom_port\u001b[0m         = \u001b[38;5;37m8400",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 61,
                  "Content": "  to_port           = 8400",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mto_port\u001b[0m           = \u001b[38;5;37m8400",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 62,
                  "Content": "  cidr_blocks       = [\"${var.cidr_blocks}\"]",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mcidr_blocks\u001b[0m       = [\u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.cidr_blocks\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"\u001b[0m]",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 63,
                  "Content": "}",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "}",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "module.consul_client_ports_aws",
                "Filename": "github.com/hashicorp-modules/hashistack-aws/github.com/hashicorp-modules/consul-server-ports-aws/main.tf",
                "Location": {
                  "StartLine": 6,
                  "EndLine": 14
                }
              },
              {
                "Resource": "module.consul_server_sg",
                "Filename": "github.com/hashicorp-modules/hashistack-aws/main.tf",
                "Location": {
                  "StartLine": 39,
                  "EndLine": 46
                }
              },
              {
                "Resource": "module.hashistack_aws[0]",
                "Filename": "infrastructure-as-code/hashistack/dev/terraform-aws/main.tf",
                "Location": {
                  "StartLine": 90,
                  "EndLine": 113
                }
              }
            ],
            "RenderedCause": {}
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "aws-vpc-add-description-to-security-group-rule",
          "AVDID": "AVD-AWS-0124",
          "Title": "Missing description for security group rule.",
          "Description": "Security group rules should include a description for auditing purposes.\n\nSimplifies auditing, debugging, and managing security groups.\n",
          "Message": "Security group rule does not have a description.",
          "Namespace": "builtin.aws.ec2.aws0124",
          "Query": "data.builtin.aws.ec2.aws0124.deny",
          "Resolution": "Add descriptions for all security groups rules",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/aws-vpc-add-description-to-security-group-rule",
          "References": [
            "https://www.cloudconformity.com/knowledge-base/aws/EC2/security-group-rules-description.html",
            "https://avd.aquasec.com/misconfig/aws-vpc-add-description-to-security-group-rule"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "module.hashistack_aws[0]",
            "Provider": "AWS",
            "Service": "ec2",
            "StartLine": 40,
            "EndLine": 49,
            "Code": {
              "Lines": [
                {
                  "Number": 40,
                  "Content": "resource \"aws_security_group_rule\" \"server_connect_tcp\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_security_group_rule\"\u001b[0m \u001b[38;5;37m\"server_connect_tcp\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 41,
                  "Content": "  count = \"${var.create ? 1 : 0}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mcount\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.create \u001b[38;5;245m?\u001b[0m \u001b[38;5;37m1\u001b[0m \u001b[38;5;245m:\u001b[0m \u001b[38;5;37m0\u001b[0m\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 42,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 43,
                  "Content": "  security_group_id = \"${aws_security_group.consul_client.id}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245msecurity_group_id\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0maws_security_group.consul_client.id\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 44,
                  "Content": "  type              = \"ingress\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mtype\u001b[0m              = \u001b[38;5;37m\"ingress\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 45,
                  "Content": "  protocol          = \"tcp\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mprotocol\u001b[0m          = \u001b[38;5;37m\"tcp\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 46,
                  "Content": "  from_port         = 20000",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mfrom_port\u001b[0m         = \u001b[38;5;37m20000",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 47,
                  "Content": "  to_port           = 20255",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mto_port\u001b[0m           = \u001b[38;5;37m20255",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 48,
                  "Content": "  cidr_blocks       = [\"${var.cidr_blocks}\"]",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mcidr_blocks\u001b[0m       = [\u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.cidr_blocks\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"\u001b[0m]",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 49,
                  "Content": "}",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "}",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "module.consul_client_ports_aws",
                "Filename": "github.com/hashicorp-modules/hashistack-aws/github.com/hashicorp-modules/consul-server-ports-aws/main.tf",
                "Location": {
                  "StartLine": 6,
                  "EndLine": 14
                }
              },
              {
                "Resource": "module.consul_server_sg",
                "Filename": "github.com/hashicorp-modules/hashistack-aws/main.tf",
                "Location": {
                  "StartLine": 39,
                  "EndLine": 46
                }
              },
              {
                "Resource": "module.hashistack_aws[0]",
                "Filename": "infrastructure-as-code/hashistack/dev/terraform-aws/main.tf",
                "Location": {
                  "StartLine": 90,
                  "EndLine": 113
                }
              }
            ],
            "RenderedCause": {}
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "aws-vpc-add-description-to-security-group-rule",
          "AVDID": "AVD-AWS-0124",
          "Title": "Missing description for security group rule.",
          "Description": "Security group rules should include a description for auditing purposes.\n\nSimplifies auditing, debugging, and managing security groups.\n",
          "Message": "Security group rule does not have a description.",
          "Namespace": "builtin.aws.ec2.aws0124",
          "Query": "data.builtin.aws.ec2.aws0124.deny",
          "Resolution": "Add descriptions for all security groups rules",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/aws-vpc-add-description-to-security-group-rule",
          "References": [
            "https://www.cloudconformity.com/knowledge-base/aws/EC2/security-group-rules-description.html",
            "https://avd.aquasec.com/misconfig/aws-vpc-add-description-to-security-group-rule"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "module.hashistack_aws[0]",
            "Provider": "AWS",
            "Service": "ec2",
            "StartLine": 28,
            "EndLine": 37,
            "Code": {
              "Lines": [
                {
                  "Number": 28,
                  "Content": "resource \"aws_security_group_rule\" \"serf_lan_udp\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_security_group_rule\"\u001b[0m \u001b[38;5;37m\"serf_lan_udp\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 29,
                  "Content": "  count = \"${var.create ? 1 : 0}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mcount\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.create \u001b[38;5;245m?\u001b[0m \u001b[38;5;37m1\u001b[0m \u001b[38;5;245m:\u001b[0m \u001b[38;5;37m0\u001b[0m\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 30,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 31,
                  "Content": "  security_group_id = \"${aws_security_group.consul_client.id}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245msecurity_group_id\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0maws_security_group.consul_client.id\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 32,
                  "Content": "  type              = \"ingress\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mtype\u001b[0m              = \u001b[38;5;37m\"ingress\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 33,
                  "Content": "  protocol          = \"udp\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mprotocol\u001b[0m          = \u001b[38;5;37m\"udp\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 34,
                  "Content": "  from_port         = 8301",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mfrom_port\u001b[0m         = \u001b[38;5;37m8301",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 35,
                  "Content": "  to_port           = 8301",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mto_port\u001b[0m           = \u001b[38;5;37m8301",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 36,
                  "Content": "  cidr_blocks       = [\"${var.cidr_blocks}\"]",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mcidr_blocks\u001b[0m       = [\u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.cidr_blocks\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"\u001b[0m]",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 37,
                  "Content": "}",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "}",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "module.consul_client_ports_aws",
                "Filename": "github.com/hashicorp-modules/hashistack-aws/github.com/hashicorp-modules/consul-server-ports-aws/main.tf",
                "Location": {
                  "StartLine": 6,
                  "EndLine": 14
                }
              },
              {
                "Resource": "module.consul_server_sg",
                "Filename": "github.com/hashicorp-modules/hashistack-aws/main.tf",
                "Location": {
                  "StartLine": 39,
                  "EndLine": 46
                }
              },
              {
                "Resource": "module.hashistack_aws[0]",
                "Filename": "infrastructure-as-code/hashistack/dev/terraform-aws/main.tf",
                "Location": {
                  "StartLine": 90,
                  "EndLine": 113
                }
              }
            ],
            "RenderedCause": {}
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "aws-vpc-add-description-to-security-group-rule",
          "AVDID": "AVD-AWS-0124",
          "Title": "Missing description for security group rule.",
          "Description": "Security group rules should include a description for auditing purposes.\n\nSimplifies auditing, debugging, and managing security groups.\n",
          "Message": "Security group rule does not have a description.",
          "Namespace": "builtin.aws.ec2.aws0124",
          "Query": "data.builtin.aws.ec2.aws0124.deny",
          "Resolution": "Add descriptions for all security groups rules",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/aws-vpc-add-description-to-security-group-rule",
          "References": [
            "https://www.cloudconformity.com/knowledge-base/aws/EC2/security-group-rules-description.html",
            "https://avd.aquasec.com/misconfig/aws-vpc-add-description-to-security-group-rule"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "module.hashistack_aws[0]",
            "Provider": "AWS",
            "Service": "ec2",
            "StartLine": 16,
            "EndLine": 25,
            "Code": {
              "Lines": [
                {
                  "Number": 16,
                  "Content": "resource \"aws_security_group_rule\" \"serf_lan_tcp\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_security_group_rule\"\u001b[0m \u001b[38;5;37m\"serf_lan_tcp\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 17,
                  "Content": "  count = \"${var.create ? 1 : 0}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mcount\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.create \u001b[38;5;245m?\u001b[0m \u001b[38;5;37m1\u001b[0m \u001b[38;5;245m:\u001b[0m \u001b[38;5;37m0\u001b[0m\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 18,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "  security_group_id = \"${aws_security_group.consul_client.id}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245msecurity_group_id\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0maws_security_group.consul_client.id\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "  type              = \"ingress\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mtype\u001b[0m              = \u001b[38;5;37m\"ingress\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "  protocol          = \"tcp\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mprotocol\u001b[0m          = \u001b[38;5;37m\"tcp\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "  from_port         = 8301",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mfrom_port\u001b[0m         = \u001b[38;5;37m8301",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "  to_port           = 8301",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mto_port\u001b[0m           = \u001b[38;5;37m8301",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 24,
                  "Content": "  cidr_blocks       = [\"${var.cidr_blocks}\"]",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mcidr_blocks\u001b[0m       = [\u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.cidr_blocks\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"\u001b[0m]",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 25,
                  "Content": "}",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "}",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "module.consul_client_ports_aws",
                "Filename": "github.com/hashicorp-modules/hashistack-aws/github.com/hashicorp-modules/consul-server-ports-aws/main.tf",
                "Location": {
                  "StartLine": 6,
                  "EndLine": 14
                }
              },
              {
                "Resource": "module.consul_server_sg",
                "Filename": "github.com/hashicorp-modules/hashistack-aws/main.tf",
                "Location": {
                  "StartLine": 39,
                  "EndLine": 46
                }
              },
              {
                "Resource": "module.hashistack_aws[0]",
                "Filename": "infrastructure-as-code/hashistack/dev/terraform-aws/main.tf",
                "Location": {
                  "StartLine": 90,
                  "EndLine": 113
                }
              }
            ],
            "RenderedCause": {}
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "aws-vpc-add-description-to-security-group-rule",
          "AVDID": "AVD-AWS-0124",
          "Title": "Missing description for security group rule.",
          "Description": "Security group rules should include a description for auditing purposes.\n\nSimplifies auditing, debugging, and managing security groups.\n",
          "Message": "Security group rule does not have a description.",
          "Namespace": "builtin.aws.ec2.aws0124",
          "Query": "data.builtin.aws.ec2.aws0124.deny",
          "Resolution": "Add descriptions for all security groups rules",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/aws-vpc-add-description-to-security-group-rule",
          "References": [
            "https://www.cloudconformity.com/knowledge-base/aws/EC2/security-group-rules-description.html",
            "https://avd.aquasec.com/misconfig/aws-vpc-add-description-to-security-group-rule"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "module.hashistack_aws[0]",
            "Provider": "AWS",
            "Service": "ec2",
            "StartLine": 114,
            "EndLine": 123,
            "Code": {
              "Lines": [
                {
                  "Number": 114,
                  "Content": "resource \"aws_security_group_rule\" \"outbound_udp\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_security_group_rule\"\u001b[0m \u001b[38;5;37m\"outbound_udp\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 115,
                  "Content": "  count = \"${var.create ? 1 : 0}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mcount\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.create \u001b[38;5;245m?\u001b[0m \u001b[38;5;37m1\u001b[0m \u001b[38;5;245m:\u001b[0m \u001b[38;5;37m0\u001b[0m\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 116,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 117,
                  "Content": "  security_group_id = \"${aws_security_group.consul_client.id}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245msecurity_group_id\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0maws_security_group.consul_client.id\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 118,
                  "Content": "  type              = \"egress\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mtype\u001b[0m              = \u001b[38;5;37m\"egress\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 119,
                  "Content": "  protocol          = \"udp\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mprotocol\u001b[0m          = \u001b[38;5;37m\"udp\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 120,
                  "Content": "  from_port         = 0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mfrom_port\u001b[0m         = \u001b[38;5;37m0",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 121,
                  "Content": "  to_port           = 65535",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mto_port\u001b[0m           = \u001b[38;5;37m65535",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 122,
                  "Content": "  cidr_blocks       = [\"0.0.0.0/0\"]",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mcidr_blocks\u001b[0m       = [\u001b[38;5;37m\"0.0.0.0/0\"\u001b[0m]",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 123,
                  "Content": "}",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "}",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "module.consul_client_ports_aws",
                "Filename": "github.com/hashicorp-modules/hashistack-aws/github.com/hashicorp-modules/consul-server-ports-aws/main.tf",
                "Location": {
                  "StartLine": 6,
                  "EndLine": 14
                }
              },
              {
                "Resource": "module.consul_server_sg",
                "Filename": "github.com/hashicorp-modules/hashistack-aws/main.tf",
                "Location": {
                  "StartLine": 39,
                  "EndLine": 46
                }
              },
              {
                "Resource": "module.hashistack_aws[0]",
                "Filename": "infrastructure-as-code/hashistack/dev/terraform-aws/main.tf",
                "Location": {
                  "StartLine": 90,
                  "EndLine": 113
                }
              }
            ],
            "RenderedCause": {}
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "aws-vpc-add-description-to-security-group-rule",
          "AVDID": "AVD-AWS-0124",
          "Title": "Missing description for security group rule.",
          "Description": "Security group rules should include a description for auditing purposes.\n\nSimplifies auditing, debugging, and managing security groups.\n",
          "Message": "Security group rule does not have a description.",
          "Namespace": "builtin.aws.ec2.aws0124",
          "Query": "data.builtin.aws.ec2.aws0124.deny",
          "Resolution": "Add descriptions for all security groups rules",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/aws-vpc-add-description-to-security-group-rule",
          "References": [
            "https://www.cloudconformity.com/knowledge-base/aws/EC2/security-group-rules-description.html",
            "https://avd.aquasec.com/misconfig/aws-vpc-add-description-to-security-group-rule"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "module.hashistack_aws[0]",
            "Provider": "AWS",
            "Service": "ec2",
            "StartLine": 102,
            "EndLine": 111,
            "Code": {
              "Lines": [
                {
                  "Number": 102,
                  "Content": "resource \"aws_security_group_rule\" \"outbound_tcp\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_security_group_rule\"\u001b[0m \u001b[38;5;37m\"outbound_tcp\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 103,
                  "Content": "  count = \"${var.create ? 1 : 0}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mcount\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.create \u001b[38;5;245m?\u001b[0m \u001b[38;5;37m1\u001b[0m \u001b[38;5;245m:\u001b[0m \u001b[38;5;37m0\u001b[0m\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 104,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 105,
                  "Content": "  security_group_id = \"${aws_security_group.consul_client.id}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245msecurity_group_id\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0maws_security_group.consul_client.id\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 106,
                  "Content": "  type              = \"egress\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mtype\u001b[0m              = \u001b[38;5;37m\"egress\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 107,
                  "Content": "  protocol          = \"tcp\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mprotocol\u001b[0m          = \u001b[38;5;37m\"tcp\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 108,
                  "Content": "  from_port         = 0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mfrom_port\u001b[0m         = \u001b[38;5;37m0",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 109,
                  "Content": "  to_port           = 65535",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mto_port\u001b[0m           = \u001b[38;5;37m65535",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 110,
                  "Content": "  cidr_blocks       = [\"0.0.0.0/0\"]",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mcidr_blocks\u001b[0m       = [\u001b[38;5;37m\"0.0.0.0/0\"\u001b[0m]",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 111,
                  "Content": "}",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "}",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "module.consul_client_ports_aws",
                "Filename": "github.com/hashicorp-modules/hashistack-aws/github.com/hashicorp-modules/consul-server-ports-aws/main.tf",
                "Location": {
                  "StartLine": 6,
                  "EndLine": 14
                }
              },
              {
                "Resource": "module.consul_server_sg",
                "Filename": "github.com/hashicorp-modules/hashistack-aws/main.tf",
                "Location": {
                  "StartLine": 39,
                  "EndLine": 46
                }
              },
              {
                "Resource": "module.hashistack_aws[0]",
                "Filename": "infrastructure-as-code/hashistack/dev/terraform-aws/main.tf",
                "Location": {
                  "StartLine": 90,
                  "EndLine": 113
                }
              }
            ],
            "RenderedCause": {}
          }
        }
      ]
    },
    {
      "Target": "github.com/hashicorp-modules/hashistack-aws/github.com/hashicorp-modules/consul-server-ports-aws/main.tf",
      "Class": "config",
      "Type": "terraform",
      "MisconfSummary": {
        "Successes": 0,
        "Failures": 3
      },
      "Misconfigurations": [
        {
          "Type": "Terraform Security Check",
          "ID": "aws-vpc-add-description-to-security-group-rule",
          "AVDID": "AVD-AWS-0124",
          "Title": "Missing description for security group rule.",
          "Description": "Security group rules should include a description for auditing purposes.\n\nSimplifies auditing, debugging, and managing security groups.\n",
          "Message": "Security group rule does not have a description.",
          "Namespace": "builtin.aws.ec2.aws0124",
          "Query": "data.builtin.aws.ec2.aws0124.deny",
          "Resolution": "Add descriptions for all security groups rules",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/aws-vpc-add-description-to-security-group-rule",
          "References": [
            "https://www.cloudconformity.com/knowledge-base/aws/EC2/security-group-rules-description.html",
            "https://avd.aquasec.com/misconfig/aws-vpc-add-description-to-security-group-rule"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "module.hashistack_aws[0]",
            "Provider": "AWS",
            "Service": "ec2",
            "StartLine": 48,
            "EndLine": 57,
            "Code": {
              "Lines": [
                {
                  "Number": 48,
                  "Content": "resource \"aws_security_group_rule\" \"serf_wan_udp\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_security_group_rule\"\u001b[0m \u001b[38;5;37m\"serf_wan_udp\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 49,
                  "Content": "  count = \"${var.create ? 1 : 0}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mcount\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.create \u001b[38;5;245m?\u001b[0m \u001b[38;5;37m1\u001b[0m \u001b[38;5;245m:\u001b[0m \u001b[38;5;37m0\u001b[0m\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 50,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 51,
                  "Content": "  security_group_id = \"${module.consul_client_ports_aws.consul_client_sg_id}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245msecurity_group_id\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mmodule\u001b[0m.consul_client_ports_aws.consul_client_sg_id\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 52,
                  "Content": "  type              = \"ingress\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mtype\u001b[0m              = \u001b[38;5;37m\"ingress\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 53,
                  "Content": "  protocol          = \"udp\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mprotocol\u001b[0m          = \u001b[38;5;37m\"udp\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 54,
                  "Content": "  from_port         = 8302",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mfrom_port\u001b[0m         = \u001b[38;5;37m8302",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 55,
                  "Content": "  to_port           = 8302",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mto_port\u001b[0m           = \u001b[38;5;37m8302",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 56,
                  "Content": "  cidr_blocks       = [\"${var.cidr_blocks}\"]",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mcidr_blocks\u001b[0m       = [\u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.cidr_blocks\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"\u001b[0m]",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 57,
                  "Content": "}",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "}",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "module.consul_server_sg",
                "Filename": "github.com/hashicorp-modules/hashistack-aws/main.tf",
                "Location": {
                  "StartLine": 39,
                  "EndLine": 46
                }
              },
              {
                "Resource": "module.hashistack_aws[0]",
                "Filename": "infrastructure-as-code/hashistack/dev/terraform-aws/main.tf",
                "Location": {
                  "StartLine": 90,
                  "EndLine": 113
                }
              }
            ],
            "RenderedCause": {}
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "aws-vpc-add-description-to-security-group-rule",
          "AVDID": "AVD-AWS-0124",
          "Title": "Missing description for security group rule.",
          "Description": "Security group rules should include a description for auditing purposes.\n\nSimplifies auditing, debugging, and managing security groups.\n",
          "Message": "Security group rule does not have a description.",
          "Namespace": "builtin.aws.ec2.aws0124",
          "Query": "data.builtin.aws.ec2.aws0124.deny",
          "Resolution": "Add descriptions for all security groups rules",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/aws-vpc-add-description-to-security-group-rule",
          "References": [
            "https://www.cloudconformity.com/knowledge-base/aws/EC2/security-group-rules-description.html",
            "https://avd.aquasec.com/misconfig/aws-vpc-add-description-to-security-group-rule"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "module.hashistack_aws[0]",
            "Provider": "AWS",
            "Service": "ec2",
            "StartLine": 36,
            "EndLine": 45,
            "Code": {
              "Lines": [
                {
                  "Number": 36,
                  "Content": "resource \"aws_security_group_rule\" \"serf_wan_tcp\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_security_group_rule\"\u001b[0m \u001b[38;5;37m\"serf_wan_tcp\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 37,
                  "Content": "  count = \"${var.create ? 1 : 0}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mcount\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.create \u001b[38;5;245m?\u001b[0m \u001b[38;5;37m1\u001b[0m \u001b[38;5;245m:\u001b[0m \u001b[38;5;37m0\u001b[0m\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 38,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 39,
                  "Content": "  security_group_id = \"${module.consul_client_ports_aws.consul_client_sg_id}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245msecurity_group_id\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mmodule\u001b[0m.consul_client_ports_aws.consul_client_sg_id\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 40,
                  "Content": "  type              = \"ingress\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mtype\u001b[0m              = \u001b[38;5;37m\"ingress\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 41,
                  "Content": "  protocol          = \"tcp\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mprotocol\u001b[0m          = \u001b[38;5;37m\"tcp\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 42,
                  "Content": "  from_port         = 8302",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mfrom_port\u001b[0m         = \u001b[38;5;37m8302",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 43,
                  "Content": "  to_port           = 8302",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mto_port\u001b[0m           = \u001b[38;5;37m8302",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 44,
                  "Content": "  cidr_blocks       = [\"${var.cidr_blocks}\"]",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mcidr_blocks\u001b[0m       = [\u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.cidr_blocks\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"\u001b[0m]",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 45,
                  "Content": "}",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "}",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "module.consul_server_sg",
                "Filename": "github.com/hashicorp-modules/hashistack-aws/main.tf",
                "Location": {
                  "StartLine": 39,
                  "EndLine": 46
                }
              },
              {
                "Resource": "module.hashistack_aws[0]",
                "Filename": "infrastructure-as-code/hashistack/dev/terraform-aws/main.tf",
                "Location": {
                  "StartLine": 90,
                  "EndLine": 113
                }
              }
            ],
            "RenderedCause": {}
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "aws-vpc-add-description-to-security-group-rule",
          "AVDID": "AVD-AWS-0124",
          "Title": "Missing description for security group rule.",
          "Description": "Security group rules should include a description for auditing purposes.\n\nSimplifies auditing, debugging, and managing security groups.\n",
          "Message": "Security group rule does not have a description.",
          "Namespace": "builtin.aws.ec2.aws0124",
          "Query": "data.builtin.aws.ec2.aws0124.deny",
          "Resolution": "Add descriptions for all security groups rules",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/aws-vpc-add-description-to-security-group-rule",
          "References": [
            "https://www.cloudconformity.com/knowledge-base/aws/EC2/security-group-rules-description.html",
            "https://avd.aquasec.com/misconfig/aws-vpc-add-description-to-security-group-rule"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "module.hashistack_aws[0]",
            "Provider": "AWS",
            "Service": "ec2",
            "StartLine": 17,
            "EndLine": 26,
            "Code": {
              "Lines": [
                {
                  "Number": 17,
                  "Content": "resource \"aws_security_group_rule\" \"server_rpc_tcp\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_security_group_rule\"\u001b[0m \u001b[38;5;37m\"server_rpc_tcp\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 18,
                  "Content": "  count = \"${var.create ? 1 : 0}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mcount\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.create \u001b[38;5;245m?\u001b[0m \u001b[38;5;37m1\u001b[0m \u001b[38;5;245m:\u001b[0m \u001b[38;5;37m0\u001b[0m\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "  security_group_id = \"${module.consul_client_ports_aws.consul_client_sg_id}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245msecurity_group_id\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mmodule\u001b[0m.consul_client_ports_aws.consul_client_sg_id\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "  type              = \"ingress\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mtype\u001b[0m              = \u001b[38;5;37m\"ingress\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "  protocol          = \"tcp\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mprotocol\u001b[0m          = \u001b[38;5;37m\"tcp\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "  from_port         = 8300",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mfrom_port\u001b[0m         = \u001b[38;5;37m8300",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 24,
                  "Content": "  to_port           = 8300",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mto_port\u001b[0m           = \u001b[38;5;37m8300",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 25,
                  "Content": "  cidr_blocks       = [\"${var.cidr_blocks}\"]",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mcidr_blocks\u001b[0m       = [\u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.cidr_blocks\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"\u001b[0m]",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 26,
                  "Content": "}",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "}",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "module.consul_server_sg",
                "Filename": "github.com/hashicorp-modules/hashistack-aws/main.tf",
                "Location": {
                  "StartLine": 39,
                  "EndLine": 46
                }
              },
              {
                "Resource": "module.hashistack_aws[0]",
                "Filename": "infrastructure-as-code/hashistack/dev/terraform-aws/main.tf",
                "Location": {
                  "StartLine": 90,
                  "EndLine": 113
                }
              }
            ],
            "RenderedCause": {}
          }
        }
      ]
    },
    {
      "Target": "github.com/hashicorp-modules/hashistack-aws/github.com/hashicorp-modules/nomad-lb-aws/main.tf",
      "Class": "config",
      "Type": "terraform",
      "MisconfSummary": {
        "Successes": 0,
        "Failures": 15
      },
      "Misconfigurations": [
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0052",
          "AVDID": "AVD-AWS-0052",
          "Title": "Load balancers should drop invalid headers",
          "Description": "Passing unknown or invalid headers through to the target poses a potential risk of compromise.\nBy setting drop_invalid_header_fields to true, anything that does not conform to well known, defined headers will be removed by the load balancer.\n",
          "Message": "Application load balancer is not set to drop invalid headers.",
          "Namespace": "builtin.aws.elb.aws0052",
          "Query": "data.builtin.aws.elb.aws0052.deny",
          "Resolution": "Set drop_invalid_header_fields to true",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0052",
          "References": [
            "https://docs.aws.amazon.com/elasticloadbalancing/latest/application/application-load-balancers.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0052"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "module.hashistack_aws[0]",
            "Provider": "AWS",
            "Service": "elb",
            "StartLine": 108,
            "EndLine": 122,
            "Code": {
              "Lines": [
                {
                  "Number": 108,
                  "Content": "resource \"aws_lb\" \"nomad\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_lb\"\u001b[0m \u001b[38;5;37m\"nomad\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 109,
                  "Content": "  count = \"${var.create ? 1 : 0}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mcount\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.create \u001b[38;5;245m?\u001b[0m \u001b[38;5;37m1\u001b[0m \u001b[38;5;245m:\u001b[0m \u001b[38;5;37m0\u001b[0m\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 110,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 111,
                  "Content": "  name            = \"${random_id.nomad_lb.hex}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mname\u001b[0m            = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0mrandom_id.nomad_lb.hex\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 112,
                  "Content": "  internal        = \"${var.is_internal_lb ? true : false}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245minternal\u001b[0m        = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.is_internal_lb \u001b[38;5;245m?\u001b[0m \u001b[38;5;166mtrue\u001b[0m \u001b[38;5;245m:\u001b[0m \u001b[38;5;166mfalse\u001b[0m\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 113,
                  "Content": "  subnets         = [\"${var.subnet_ids}\"]",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245msubnets\u001b[0m         = [\u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.subnet_ids\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"\u001b[0m]",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 114,
                  "Content": "  security_groups = [\"${aws_security_group.nomad_lb.id}\"]",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245msecurity_groups\u001b[0m = [\u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0maws_security_group.nomad_lb.id\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"\u001b[0m]",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 115,
                  "Content": "  tags            = \"${merge(var.tags, map(\"Name\", format(\"%s-nomad-lb\", var.name)))}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mtags\u001b[0m            = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0mmerge(\u001b[38;5;33mvar\u001b[0m.tags,\u001b[38;5;33m map\u001b[0m(\u001b[38;5;37m\"Name\"\u001b[0m, \u001b[38;5;33mformat\u001b[0m(\u001b[38;5;37m\"%s-nomad-lb\"\u001b[0m, \u001b[38;5;33mvar\u001b[0m.name)))\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 116,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 117,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "module.nomad_lb_aws",
                "Filename": "github.com/hashicorp-modules/hashistack-aws/main.tf",
                "Location": {
                  "StartLine": 142,
                  "EndLine": 161
                }
              },
              {
                "Resource": "module.hashistack_aws[0]",
                "Filename": "infrastructure-as-code/hashistack/dev/terraform-aws/main.tf",
                "Location": {
                  "StartLine": 90,
                  "EndLine": 113
                }
              }
            ],
            "RenderedCause": {}
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0053",
          "AVDID": "AVD-AWS-0053",
          "Title": "Load balancer is exposed to the internet.",
          "Description": "There are many scenarios in which you would want to expose a load balancer to the wider internet, but this check exists as a warning to prevent accidental exposure of internal assets. You should ensure that this resource should be exposed publicly.\n",
          "Message": "Load balancer is exposed publicly.",
          "Namespace": "builtin.aws.elb.aws0053",
          "Query": "data.builtin.aws.elb.aws0053.deny",
          "Resolution": "Switch to an internal load balancer or add a tfsec ignore",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0053",
          "References": [
            "https://avd.aquasec.com/misconfig/avd-aws-0053"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "module.hashistack_aws[0]",
            "Provider": "AWS",
            "Service": "elb",
            "StartLine": 112,
            "EndLine": 112,
            "Code": {
              "Lines": [
                {
                  "Number": 108,
                  "Content": "resource \"aws_lb\" \"nomad\" {",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_lb\"\u001b[0m \u001b[38;5;37m\"nomad\"\u001b[0m {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 109,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 112,
                  "Content": "  internal        = \"${var.is_internal_lb ? true : false}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245minternal\u001b[0m        = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.is_internal_lb \u001b[38;5;245m?\u001b[0m \u001b[38;5;166mtrue\u001b[0m \u001b[38;5;245m:\u001b[0m \u001b[38;5;166mfalse\u001b[0m\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": true,
                  "LastCause": true
                },
                {
                  "Number": 121,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 122,
                  "Content": "}",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "}",
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "aws_lb.nomad[0]",
                "Filename": "github.com/hashicorp-modules/hashistack-aws/github.com/hashicorp-modules/nomad-lb-aws/main.tf",
                "Location": {
                  "StartLine": 108,
                  "EndLine": 122
                }
              },
              {
                "Resource": "module.nomad_lb_aws",
                "Filename": "github.com/hashicorp-modules/hashistack-aws/main.tf",
                "Location": {
                  "StartLine": 142,
                  "EndLine": 161
                }
              },
              {
                "Resource": "module.hashistack_aws[0]",
                "Filename": "infrastructure-as-code/hashistack/dev/terraform-aws/main.tf",
                "Location": {
                  "StartLine": 90,
                  "EndLine": 113
                }
              }
            ],
            "RenderedCause": {
              "Raw": "resource \"aws_lb\" \"nomad\" {\n  internal = false\n}",
              "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_lb\"\u001b[0m \u001b[38;5;37m\"nomad\"\u001b[0m {\n  \u001b[38;5;245minternal\u001b[0m = \u001b[38;5;166mfalse\n\u001b[0m}"
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0086",
          "AVDID": "AVD-AWS-0086",
          "Title": "S3 Access block should block public ACL",
          "Description": "S3 buckets should block public ACLs on buckets and any objects they contain. By blocking, PUTs with fail if the object has any public ACL a.\n",
          "Message": "No public access block so not blocking public acls",
          "Namespace": "builtin.aws.s3.aws0086",
          "Query": "data.builtin.aws.s3.aws0086.deny",
          "Resolution": "Enable blocking any PUT calls with a public ACL specified",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0086",
          "References": [
            "https://docs.aws.amazon.com/AmazonS3/latest/userguide/access-control-block-public-access.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0086"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "module.hashistack_aws[0]",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 69,
            "EndLine": 99,
            "Code": {
              "Lines": [
                {
                  "Number": 69,
                  "Content": "resource \"aws_s3_bucket\" \"nomad_lb_access_logs\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_s3_bucket\"\u001b[0m \u001b[38;5;37m\"nomad_lb_access_logs\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 70,
                  "Content": "  count = \"${var.create \u0026\u0026 !var.lb_bucket_override ? 1 : 0}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mcount\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.create \u001b[38;5;245m\u0026\u0026\u001b[0m \u001b[38;5;245m!\u001b[0m\u001b[38;5;33mvar\u001b[0m.lb_bucket_override \u001b[38;5;245m?\u001b[0m \u001b[38;5;37m1\u001b[0m \u001b[38;5;245m:\u001b[0m \u001b[38;5;37m0\u001b[0m\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 71,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 72,
                  "Content": "  bucket = \"${random_id.nomad_lb_access_logs.hex}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mbucket\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0mrandom_id.nomad_lb_access_logs.hex\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 73,
                  "Content": "  acl    = \"private\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245macl\u001b[0m    = \u001b[38;5;37m\"private\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 74,
                  "Content": "  tags   = \"${merge(var.tags, map(\"Name\", format(\"%s-nomad-lb-access-logs\", var.name)))}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mtags\u001b[0m   = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0mmerge(\u001b[38;5;33mvar\u001b[0m.tags,\u001b[38;5;33m map\u001b[0m(\u001b[38;5;37m\"Name\"\u001b[0m, \u001b[38;5;33mformat\u001b[0m(\u001b[38;5;37m\"%s-nomad-lb-access-logs\"\u001b[0m, \u001b[38;5;33mvar\u001b[0m.name)))\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 75,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 76,
                  "Content": "  force_destroy = true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mforce_destroy\u001b[0m = \u001b[38;5;166mtrue",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 77,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 78,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "module.nomad_lb_aws",
                "Filename": "github.com/hashicorp-modules/hashistack-aws/main.tf",
                "Location": {
                  "StartLine": 142,
                  "EndLine": 161
                }
              },
              {
                "Resource": "module.hashistack_aws[0]",
                "Filename": "infrastructure-as-code/hashistack/dev/terraform-aws/main.tf",
                "Location": {
                  "StartLine": 90,
                  "EndLine": 113
                }
              }
            ],
            "RenderedCause": {}
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0087",
          "AVDID": "AVD-AWS-0087",
          "Title": "S3 Access block should block public policy",
          "Description": "S3 bucket policy should have block public policy to prevent users from putting a policy that enable public access.\n",
          "Message": "No public access block so not blocking public policies",
          "Namespace": "builtin.aws.s3.aws0087",
          "Query": "data.builtin.aws.s3.aws0087.deny",
          "Resolution": "Prevent policies that allow public access being PUT",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0087",
          "References": [
            "https://docs.aws.amazon.com/AmazonS3/latest/dev-retired/access-control-block-public-access.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0087"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "module.hashistack_aws[0]",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 69,
            "EndLine": 99,
            "Code": {
              "Lines": [
                {
                  "Number": 69,
                  "Content": "resource \"aws_s3_bucket\" \"nomad_lb_access_logs\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_s3_bucket\"\u001b[0m \u001b[38;5;37m\"nomad_lb_access_logs\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 70,
                  "Content": "  count = \"${var.create \u0026\u0026 !var.lb_bucket_override ? 1 : 0}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mcount\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.create \u001b[38;5;245m\u0026\u0026\u001b[0m \u001b[38;5;245m!\u001b[0m\u001b[38;5;33mvar\u001b[0m.lb_bucket_override \u001b[38;5;245m?\u001b[0m \u001b[38;5;37m1\u001b[0m \u001b[38;5;245m:\u001b[0m \u001b[38;5;37m0\u001b[0m\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 71,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 72,
                  "Content": "  bucket = \"${random_id.nomad_lb_access_logs.hex}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mbucket\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0mrandom_id.nomad_lb_access_logs.hex\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 73,
                  "Content": "  acl    = \"private\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245macl\u001b[0m    = \u001b[38;5;37m\"private\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 74,
                  "Content": "  tags   = \"${merge(var.tags, map(\"Name\", format(\"%s-nomad-lb-access-logs\", var.name)))}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mtags\u001b[0m   = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0mmerge(\u001b[38;5;33mvar\u001b[0m.tags,\u001b[38;5;33m map\u001b[0m(\u001b[38;5;37m\"Name\"\u001b[0m, \u001b[38;5;33mformat\u001b[0m(\u001b[38;5;37m\"%s-nomad-lb-access-logs\"\u001b[0m, \u001b[38;5;33mvar\u001b[0m.name)))\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 75,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 76,
                  "Content": "  force_destroy = true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mforce_destroy\u001b[0m = \u001b[38;5;166mtrue",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 77,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 78,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "module.nomad_lb_aws",
                "Filename": "github.com/hashicorp-modules/hashistack-aws/main.tf",
                "Location": {
                  "StartLine": 142,
                  "EndLine": 161
                }
              },
              {
                "Resource": "module.hashistack_aws[0]",
                "Filename": "infrastructure-as-code/hashistack/dev/terraform-aws/main.tf",
                "Location": {
                  "StartLine": 90,
                  "EndLine": 113
                }
              }
            ],
            "RenderedCause": {}
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0088",
          "AVDID": "AVD-AWS-0088",
          "Title": "Unencrypted S3 bucket.",
          "Description": "S3 Buckets should be encrypted to protect the data that is stored within them if access is compromised.\n",
          "Message": "Bucket does not have encryption enabled",
          "Namespace": "builtin.aws.s3.aws0088",
          "Query": "data.builtin.aws.s3.aws0088.deny",
          "Resolution": "Configure bucket encryption",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0088",
          "References": [
            "https://docs.aws.amazon.com/AmazonS3/latest/userguide/bucket-encryption.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0088"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "module.hashistack_aws[0]",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 69,
            "EndLine": 99,
            "Code": {
              "Lines": [
                {
                  "Number": 69,
                  "Content": "resource \"aws_s3_bucket\" \"nomad_lb_access_logs\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_s3_bucket\"\u001b[0m \u001b[38;5;37m\"nomad_lb_access_logs\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 70,
                  "Content": "  count = \"${var.create \u0026\u0026 !var.lb_bucket_override ? 1 : 0}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mcount\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.create \u001b[38;5;245m\u0026\u0026\u001b[0m \u001b[38;5;245m!\u001b[0m\u001b[38;5;33mvar\u001b[0m.lb_bucket_override \u001b[38;5;245m?\u001b[0m \u001b[38;5;37m1\u001b[0m \u001b[38;5;245m:\u001b[0m \u001b[38;5;37m0\u001b[0m\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 71,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 72,
                  "Content": "  bucket = \"${random_id.nomad_lb_access_logs.hex}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mbucket\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0mrandom_id.nomad_lb_access_logs.hex\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 73,
                  "Content": "  acl    = \"private\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245macl\u001b[0m    = \u001b[38;5;37m\"private\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 74,
                  "Content": "  tags   = \"${merge(var.tags, map(\"Name\", format(\"%s-nomad-lb-access-logs\", var.name)))}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mtags\u001b[0m   = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0mmerge(\u001b[38;5;33mvar\u001b[0m.tags,\u001b[38;5;33m map\u001b[0m(\u001b[38;5;37m\"Name\"\u001b[0m, \u001b[38;5;33mformat\u001b[0m(\u001b[38;5;37m\"%s-nomad-lb-access-logs\"\u001b[0m, \u001b[38;5;33mvar\u001b[0m.name)))\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 75,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 76,
                  "Content": "  force_destroy = true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mforce_destroy\u001b[0m = \u001b[38;5;166mtrue",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 77,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 78,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "module.nomad_lb_aws",
                "Filename": "github.com/hashicorp-modules/hashistack-aws/main.tf",
                "Location": {
                  "StartLine": 142,
                  "EndLine": 161
                }
              },
              {
                "Resource": "module.hashistack_aws[0]",
                "Filename": "infrastructure-as-code/hashistack/dev/terraform-aws/main.tf",
                "Location": {
                  "StartLine": 90,
                  "EndLine": 113
                }
              }
            ],
            "RenderedCause": {}
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "s3-bucket-logging",
          "AVDID": "AVD-AWS-0089",
          "Title": "S3 Bucket Logging",
          "Description": "Ensures S3 bucket logging is enabled for S3 buckets",
          "Message": "Bucket has logging disabled",
          "Namespace": "builtin.aws.s3.aws0089",
          "Query": "data.builtin.aws.s3.aws0089.deny",
          "Resolution": "Add a logging block to the resource to enable access logging",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/s3-bucket-logging",
          "References": [
            "https://docs.aws.amazon.com/AmazonS3/latest/userguide/ServerLogs.html",
            "https://docs.aws.amazon.com/AmazonS3/latest/userguide/enable-server-access-logging.html",
            "https://avd.aquasec.com/misconfig/s3-bucket-logging"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "module.hashistack_aws[0]",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 69,
            "EndLine": 99,
            "Code": {
              "Lines": [
                {
                  "Number": 69,
                  "Content": "resource \"aws_s3_bucket\" \"nomad_lb_access_logs\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_s3_bucket\"\u001b[0m \u001b[38;5;37m\"nomad_lb_access_logs\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 70,
                  "Content": "  count = \"${var.create \u0026\u0026 !var.lb_bucket_override ? 1 : 0}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mcount\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.create \u001b[38;5;245m\u0026\u0026\u001b[0m \u001b[38;5;245m!\u001b[0m\u001b[38;5;33mvar\u001b[0m.lb_bucket_override \u001b[38;5;245m?\u001b[0m \u001b[38;5;37m1\u001b[0m \u001b[38;5;245m:\u001b[0m \u001b[38;5;37m0\u001b[0m\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 71,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 72,
                  "Content": "  bucket = \"${random_id.nomad_lb_access_logs.hex}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mbucket\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0mrandom_id.nomad_lb_access_logs.hex\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 73,
                  "Content": "  acl    = \"private\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245macl\u001b[0m    = \u001b[38;5;37m\"private\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 74,
                  "Content": "  tags   = \"${merge(var.tags, map(\"Name\", format(\"%s-nomad-lb-access-logs\", var.name)))}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mtags\u001b[0m   = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0mmerge(\u001b[38;5;33mvar\u001b[0m.tags,\u001b[38;5;33m map\u001b[0m(\u001b[38;5;37m\"Name\"\u001b[0m, \u001b[38;5;33mformat\u001b[0m(\u001b[38;5;37m\"%s-nomad-lb-access-logs\"\u001b[0m, \u001b[38;5;33mvar\u001b[0m.name)))\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 75,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 76,
                  "Content": "  force_destroy = true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mforce_destroy\u001b[0m = \u001b[38;5;166mtrue",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 77,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 78,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "module.nomad_lb_aws",
                "Filename": "github.com/hashicorp-modules/hashistack-aws/main.tf",
                "Location": {
                  "StartLine": 142,
                  "EndLine": 161
                }
              },
              {
                "Resource": "module.hashistack_aws[0]",
                "Filename": "infrastructure-as-code/hashistack/dev/terraform-aws/main.tf",
                "Location": {
                  "StartLine": 90,
                  "EndLine": 113
                }
              }
            ],
            "RenderedCause": {}
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0090",
          "AVDID": "AVD-AWS-0090",
          "Title": "S3 Data should be versioned",
          "Description": "Versioning in Amazon S3 is a means of keeping multiple variants of an object in the same bucket.\n\nYou can use the S3 Versioning feature to preserve, retrieve, and restore every version of every object stored in your buckets.\n\nWith versioning you can recover more easily from both unintended user actions and application failures.\n",
          "Message": "Bucket does not have versioning enabled",
          "Namespace": "builtin.aws.s3.aws0090",
          "Query": "data.builtin.aws.s3.aws0090.deny",
          "Resolution": "Enable versioning to protect against accidental/malicious removal or modification",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0090",
          "References": [
            "https://docs.aws.amazon.com/AmazonS3/latest/userguide/Versioning.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0090"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "module.hashistack_aws[0]",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 69,
            "EndLine": 99,
            "Code": {
              "Lines": [
                {
                  "Number": 69,
                  "Content": "resource \"aws_s3_bucket\" \"nomad_lb_access_logs\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_s3_bucket\"\u001b[0m \u001b[38;5;37m\"nomad_lb_access_logs\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 70,
                  "Content": "  count = \"${var.create \u0026\u0026 !var.lb_bucket_override ? 1 : 0}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mcount\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.create \u001b[38;5;245m\u0026\u0026\u001b[0m \u001b[38;5;245m!\u001b[0m\u001b[38;5;33mvar\u001b[0m.lb_bucket_override \u001b[38;5;245m?\u001b[0m \u001b[38;5;37m1\u001b[0m \u001b[38;5;245m:\u001b[0m \u001b[38;5;37m0\u001b[0m\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 71,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 72,
                  "Content": "  bucket = \"${random_id.nomad_lb_access_logs.hex}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mbucket\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0mrandom_id.nomad_lb_access_logs.hex\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 73,
                  "Content": "  acl    = \"private\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245macl\u001b[0m    = \u001b[38;5;37m\"private\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 74,
                  "Content": "  tags   = \"${merge(var.tags, map(\"Name\", format(\"%s-nomad-lb-access-logs\", var.name)))}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mtags\u001b[0m   = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0mmerge(\u001b[38;5;33mvar\u001b[0m.tags,\u001b[38;5;33m map\u001b[0m(\u001b[38;5;37m\"Name\"\u001b[0m, \u001b[38;5;33mformat\u001b[0m(\u001b[38;5;37m\"%s-nomad-lb-access-logs\"\u001b[0m, \u001b[38;5;33mvar\u001b[0m.name)))\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 75,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 76,
                  "Content": "  force_destroy = true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mforce_destroy\u001b[0m = \u001b[38;5;166mtrue",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 77,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 78,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "module.nomad_lb_aws",
                "Filename": "github.com/hashicorp-modules/hashistack-aws/main.tf",
                "Location": {
                  "StartLine": 142,
                  "EndLine": 161
                }
              },
              {
                "Resource": "module.hashistack_aws[0]",
                "Filename": "infrastructure-as-code/hashistack/dev/terraform-aws/main.tf",
                "Location": {
                  "StartLine": 90,
                  "EndLine": 113
                }
              }
            ],
            "RenderedCause": {}
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0091",
          "AVDID": "AVD-AWS-0091",
          "Title": "S3 Access Block should Ignore Public ACL",
          "Description": "S3 buckets should ignore public ACLs on buckets and any objects they contain. By ignoring rather than blocking, PUT calls with public ACLs will still be applied but the ACL will be ignored.\n",
          "Message": "No public access block so not blocking public acls",
          "Namespace": "builtin.aws.s3.aws0091",
          "Query": "data.builtin.aws.s3.aws0091.deny",
          "Resolution": "Enable ignoring the application of public ACLs in PUT calls",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0091",
          "References": [
            "https://docs.aws.amazon.com/AmazonS3/latest/userguide/access-control-block-public-access.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0091"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "module.hashistack_aws[0]",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 69,
            "EndLine": 99,
            "Code": {
              "Lines": [
                {
                  "Number": 69,
                  "Content": "resource \"aws_s3_bucket\" \"nomad_lb_access_logs\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_s3_bucket\"\u001b[0m \u001b[38;5;37m\"nomad_lb_access_logs\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 70,
                  "Content": "  count = \"${var.create \u0026\u0026 !var.lb_bucket_override ? 1 : 0}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mcount\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.create \u001b[38;5;245m\u0026\u0026\u001b[0m \u001b[38;5;245m!\u001b[0m\u001b[38;5;33mvar\u001b[0m.lb_bucket_override \u001b[38;5;245m?\u001b[0m \u001b[38;5;37m1\u001b[0m \u001b[38;5;245m:\u001b[0m \u001b[38;5;37m0\u001b[0m\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 71,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 72,
                  "Content": "  bucket = \"${random_id.nomad_lb_access_logs.hex}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mbucket\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0mrandom_id.nomad_lb_access_logs.hex\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 73,
                  "Content": "  acl    = \"private\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245macl\u001b[0m    = \u001b[38;5;37m\"private\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 74,
                  "Content": "  tags   = \"${merge(var.tags, map(\"Name\", format(\"%s-nomad-lb-access-logs\", var.name)))}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mtags\u001b[0m   = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0mmerge(\u001b[38;5;33mvar\u001b[0m.tags,\u001b[38;5;33m map\u001b[0m(\u001b[38;5;37m\"Name\"\u001b[0m, \u001b[38;5;33mformat\u001b[0m(\u001b[38;5;37m\"%s-nomad-lb-access-logs\"\u001b[0m, \u001b[38;5;33mvar\u001b[0m.name)))\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 75,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 76,
                  "Content": "  force_destroy = true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mforce_destroy\u001b[0m = \u001b[38;5;166mtrue",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 77,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 78,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "module.nomad_lb_aws",
                "Filename": "github.com/hashicorp-modules/hashistack-aws/main.tf",
                "Location": {
                  "StartLine": 142,
                  "EndLine": 161
                }
              },
              {
                "Resource": "module.hashistack_aws[0]",
                "Filename": "infrastructure-as-code/hashistack/dev/terraform-aws/main.tf",
                "Location": {
                  "StartLine": 90,
                  "EndLine": 113
                }
              }
            ],
            "RenderedCause": {}
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0093",
          "AVDID": "AVD-AWS-0093",
          "Title": "S3 Access block should restrict public bucket to limit access",
          "Description": "S3 buckets should restrict public policies for the bucket. By enabling, the restrict_public_buckets, only the bucket owner and AWS Services can access if it has a public policy.\n",
          "Message": "No public access block so not restricting public buckets",
          "Namespace": "builtin.aws.s3.aws0093",
          "Query": "data.builtin.aws.s3.aws0093.deny",
          "Resolution": "Limit the access to public buckets to only the owner or AWS Services (eg; CloudFront)",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0093",
          "References": [
            "https://docs.aws.amazon.com/AmazonS3/latest/dev-retired/access-control-block-public-access.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0093"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "module.hashistack_aws[0]",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 69,
            "EndLine": 99,
            "Code": {
              "Lines": [
                {
                  "Number": 69,
                  "Content": "resource \"aws_s3_bucket\" \"nomad_lb_access_logs\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_s3_bucket\"\u001b[0m \u001b[38;5;37m\"nomad_lb_access_logs\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 70,
                  "Content": "  count = \"${var.create \u0026\u0026 !var.lb_bucket_override ? 1 : 0}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mcount\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.create \u001b[38;5;245m\u0026\u0026\u001b[0m \u001b[38;5;245m!\u001b[0m\u001b[38;5;33mvar\u001b[0m.lb_bucket_override \u001b[38;5;245m?\u001b[0m \u001b[38;5;37m1\u001b[0m \u001b[38;5;245m:\u001b[0m \u001b[38;5;37m0\u001b[0m\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 71,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 72,
                  "Content": "  bucket = \"${random_id.nomad_lb_access_logs.hex}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mbucket\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0mrandom_id.nomad_lb_access_logs.hex\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 73,
                  "Content": "  acl    = \"private\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245macl\u001b[0m    = \u001b[38;5;37m\"private\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 74,
                  "Content": "  tags   = \"${merge(var.tags, map(\"Name\", format(\"%s-nomad-lb-access-logs\", var.name)))}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mtags\u001b[0m   = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0mmerge(\u001b[38;5;33mvar\u001b[0m.tags,\u001b[38;5;33m map\u001b[0m(\u001b[38;5;37m\"Name\"\u001b[0m, \u001b[38;5;33mformat\u001b[0m(\u001b[38;5;37m\"%s-nomad-lb-access-logs\"\u001b[0m, \u001b[38;5;33mvar\u001b[0m.name)))\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 75,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 76,
                  "Content": "  force_destroy = true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mforce_destroy\u001b[0m = \u001b[38;5;166mtrue",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 77,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 78,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "module.nomad_lb_aws",
                "Filename": "github.com/hashicorp-modules/hashistack-aws/main.tf",
                "Location": {
                  "StartLine": 142,
                  "EndLine": 161
                }
              },
              {
                "Resource": "module.hashistack_aws[0]",
                "Filename": "infrastructure-as-code/hashistack/dev/terraform-aws/main.tf",
                "Location": {
                  "StartLine": 90,
                  "EndLine": 113
                }
              }
            ],
            "RenderedCause": {}
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0094",
          "AVDID": "AVD-AWS-0094",
          "Title": "S3 buckets should each define an aws_s3_bucket_public_access_block",
          "Description": "The \"block public access\" settings in S3 override individual policies that apply to a given bucket, meaning that all public access can be controlled in one central types for that bucket. It is therefore good practice to define these settings for each bucket in order to clearly define the public access that can be allowed for it.\n",
          "Message": "Bucket does not have a corresponding public access block.",
          "Namespace": "builtin.aws.s3.aws0094",
          "Query": "data.builtin.aws.s3.aws0094.deny",
          "Resolution": "Define a aws_s3_bucket_public_access_block for the given bucket to control public access policies",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0094",
          "References": [
            "https://docs.aws.amazon.com/AmazonS3/latest/userguide/access-control-block-public-access.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0094"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "module.hashistack_aws[0]",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 69,
            "EndLine": 99,
            "Code": {
              "Lines": [
                {
                  "Number": 69,
                  "Content": "resource \"aws_s3_bucket\" \"nomad_lb_access_logs\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_s3_bucket\"\u001b[0m \u001b[38;5;37m\"nomad_lb_access_logs\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 70,
                  "Content": "  count = \"${var.create \u0026\u0026 !var.lb_bucket_override ? 1 : 0}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mcount\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.create \u001b[38;5;245m\u0026\u0026\u001b[0m \u001b[38;5;245m!\u001b[0m\u001b[38;5;33mvar\u001b[0m.lb_bucket_override \u001b[38;5;245m?\u001b[0m \u001b[38;5;37m1\u001b[0m \u001b[38;5;245m:\u001b[0m \u001b[38;5;37m0\u001b[0m\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 71,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 72,
                  "Content": "  bucket = \"${random_id.nomad_lb_access_logs.hex}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mbucket\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0mrandom_id.nomad_lb_access_logs.hex\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 73,
                  "Content": "  acl    = \"private\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245macl\u001b[0m    = \u001b[38;5;37m\"private\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 74,
                  "Content": "  tags   = \"${merge(var.tags, map(\"Name\", format(\"%s-nomad-lb-access-logs\", var.name)))}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mtags\u001b[0m   = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0mmerge(\u001b[38;5;33mvar\u001b[0m.tags,\u001b[38;5;33m map\u001b[0m(\u001b[38;5;37m\"Name\"\u001b[0m, \u001b[38;5;33mformat\u001b[0m(\u001b[38;5;37m\"%s-nomad-lb-access-logs\"\u001b[0m, \u001b[38;5;33mvar\u001b[0m.name)))\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 75,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 76,
                  "Content": "  force_destroy = true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mforce_destroy\u001b[0m = \u001b[38;5;166mtrue",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 77,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 78,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "module.nomad_lb_aws",
                "Filename": "github.com/hashicorp-modules/hashistack-aws/main.tf",
                "Location": {
                  "StartLine": 142,
                  "EndLine": 161
                }
              },
              {
                "Resource": "module.hashistack_aws[0]",
                "Filename": "infrastructure-as-code/hashistack/dev/terraform-aws/main.tf",
                "Location": {
                  "StartLine": 90,
                  "EndLine": 113
                }
              }
            ],
            "RenderedCause": {}
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "aws-vpc-no-public-egress-sgr",
          "AVDID": "AVD-AWS-0104",
          "Title": "A security group rule should not allow unrestricted egress to any IP address.",
          "Description": "Opening up ports to connect out to the public internet is generally to be avoided. You should restrict access to IP addresses or ranges that are explicitly required where possible.\n",
          "Message": "Security group rule allows unrestricted egress to any IP address.",
          "Namespace": "builtin.aws.ec2.aws0104",
          "Query": "data.builtin.aws.ec2.aws0104.deny",
          "Resolution": "Set a more restrictive cidr range",
          "Severity": "CRITICAL",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/aws-vpc-no-public-egress-sgr",
          "References": [
            "https://docs.aws.amazon.com/whitepapers/latest/building-scalable-secure-multi-vpc-network-infrastructure/centralized-egress-to-internet.html",
            "https://avd.aquasec.com/misconfig/aws-vpc-no-public-egress-sgr"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "module.hashistack_aws[0]",
            "Provider": "AWS",
            "Service": "ec2",
            "StartLine": 55,
            "EndLine": 55,
            "Code": {
              "Lines": [
                {
                  "Number": 47,
                  "Content": "resource \"aws_security_group_rule\" \"outbound_tcp\" {",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_security_group_rule\"\u001b[0m \u001b[38;5;37m\"outbound_tcp\"\u001b[0m {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 48,
                  "Content": "  count = \"${var.create ? 1 : 0}\"",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mcount\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.create \u001b[38;5;245m?\u001b[0m \u001b[38;5;37m1\u001b[0m \u001b[38;5;245m:\u001b[0m \u001b[38;5;37m0\u001b[0m\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 49,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 50,
                  "Content": "  security_group_id = \"${aws_security_group.nomad_lb.id}\"",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245msecurity_group_id\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0maws_security_group.nomad_lb.id\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 51,
                  "Content": "  type              = \"egress\"",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mtype\u001b[0m              = \u001b[38;5;37m\"egress\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 52,
                  "Content": "  protocol          = \"tcp\"",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mprotocol\u001b[0m          = \u001b[38;5;37m\"tcp\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 53,
                  "Content": "  from_port         = 0",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mfrom_port\u001b[0m         = \u001b[38;5;37m0",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 54,
                  "Content": "  to_port           = 65535",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mto_port\u001b[0m           = \u001b[38;5;37m65535",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 55,
                  "Content": "  cidr_blocks       = [\"0.0.0.0/0\"]",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mcidr_blocks\u001b[0m       = [\u001b[38;5;37m\"0.0.0.0/0\"\u001b[0m]",
                  "FirstCause": true,
                  "LastCause": true
                },
                {
                  "Number": 56,
                  "Content": "}",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "}",
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "aws_security_group_rule.outbound_tcp[0]",
                "Filename": "github.com/hashicorp-modules/hashistack-aws/github.com/hashicorp-modules/nomad-lb-aws/main.tf",
                "Location": {
                  "StartLine": 47,
                  "EndLine": 56
                }
              },
              {
                "Resource": "module.nomad_lb_aws",
                "Filename": "github.com/hashicorp-modules/hashistack-aws/main.tf",
                "Location": {
                  "StartLine": 142,
                  "EndLine": 161
                }
              },
              {
                "Resource": "module.hashistack_aws[0]",
                "Filename": "infrastructure-as-code/hashistack/dev/terraform-aws/main.tf",
                "Location": {
                  "StartLine": 90,
                  "EndLine": 113
                }
              }
            ],
            "RenderedCause": {}
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "aws-vpc-add-description-to-security-group-rule",
          "AVDID": "AVD-AWS-0124",
          "Title": "Missing description for security group rule.",
          "Description": "Security group rules should include a description for auditing purposes.\n\nSimplifies auditing, debugging, and managing security groups.\n",
          "Message": "Security group rule does not have a description.",
          "Namespace": "builtin.aws.ec2.aws0124",
          "Query": "data.builtin.aws.ec2.aws0124.deny",
          "Resolution": "Add descriptions for all security groups rules",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/aws-vpc-add-description-to-security-group-rule",
          "References": [
            "https://www.cloudconformity.com/knowledge-base/aws/EC2/security-group-rules-description.html",
            "https://avd.aquasec.com/misconfig/aws-vpc-add-description-to-security-group-rule"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "module.hashistack_aws[0]",
            "Provider": "AWS",
            "Service": "ec2",
            "StartLine": 14,
            "EndLine": 23,
            "Code": {
              "Lines": [
                {
                  "Number": 14,
                  "Content": "resource \"aws_security_group_rule\" \"nomad_lb_http_80\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_security_group_rule\"\u001b[0m \u001b[38;5;37m\"nomad_lb_http_80\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 15,
                  "Content": "  count = \"${var.create ? 1 : 0}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mcount\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.create \u001b[38;5;245m?\u001b[0m \u001b[38;5;37m1\u001b[0m \u001b[38;5;245m:\u001b[0m \u001b[38;5;37m0\u001b[0m\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 16,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 17,
                  "Content": "  security_group_id = \"${aws_security_group.nomad_lb.id}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245msecurity_group_id\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0maws_security_group.nomad_lb.id\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 18,
                  "Content": "  type              = \"ingress\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mtype\u001b[0m              = \u001b[38;5;37m\"ingress\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "  protocol          = \"tcp\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mprotocol\u001b[0m          = \u001b[38;5;37m\"tcp\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "  from_port         = 80",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mfrom_port\u001b[0m         = \u001b[38;5;37m80",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "  to_port           = 80",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mto_port\u001b[0m           = \u001b[38;5;37m80",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "  cidr_blocks       = [\"${split(\",\", var.is_internal_lb ? join(\",\", var.cidr_blocks) : \"0.0.0.0/0\")}\"]",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mcidr_blocks\u001b[0m       = [\u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33msplit\u001b[0m(\u001b[38;5;37m\",\"\u001b[0m, \u001b[38;5;33mvar\u001b[0m.is_internal_lb \u001b[38;5;245m?\u001b[0m \u001b[38;5;33mjoin\u001b[0m(\u001b[38;5;37m\",\"\u001b[0m, \u001b[38;5;33mvar\u001b[0m.cidr_blocks) \u001b[38;5;245m:\u001b[0m \u001b[38;5;37m\"0.0.0.0/0\"\u001b[0m)\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"\u001b[0m]",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "}",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "}",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "module.nomad_lb_aws",
                "Filename": "github.com/hashicorp-modules/hashistack-aws/main.tf",
                "Location": {
                  "StartLine": 142,
                  "EndLine": 161
                }
              },
              {
                "Resource": "module.hashistack_aws[0]",
                "Filename": "infrastructure-as-code/hashistack/dev/terraform-aws/main.tf",
                "Location": {
                  "StartLine": 90,
                  "EndLine": 113
                }
              }
            ],
            "RenderedCause": {}
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "aws-vpc-add-description-to-security-group-rule",
          "AVDID": "AVD-AWS-0124",
          "Title": "Missing description for security group rule.",
          "Description": "Security group rules should include a description for auditing purposes.\n\nSimplifies auditing, debugging, and managing security groups.\n",
          "Message": "Security group rule does not have a description.",
          "Namespace": "builtin.aws.ec2.aws0124",
          "Query": "data.builtin.aws.ec2.aws0124.deny",
          "Resolution": "Add descriptions for all security groups rules",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/aws-vpc-add-description-to-security-group-rule",
          "References": [
            "https://www.cloudconformity.com/knowledge-base/aws/EC2/security-group-rules-description.html",
            "https://avd.aquasec.com/misconfig/aws-vpc-add-description-to-security-group-rule"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "module.hashistack_aws[0]",
            "Provider": "AWS",
            "Service": "ec2",
            "StartLine": 36,
            "EndLine": 45,
            "Code": {
              "Lines": [
                {
                  "Number": 36,
                  "Content": "resource \"aws_security_group_rule\" \"nomad_lb_tcp_4646\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_security_group_rule\"\u001b[0m \u001b[38;5;37m\"nomad_lb_tcp_4646\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 37,
                  "Content": "  count = \"${var.create ? 1 : 0}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mcount\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.create \u001b[38;5;245m?\u001b[0m \u001b[38;5;37m1\u001b[0m \u001b[38;5;245m:\u001b[0m \u001b[38;5;37m0\u001b[0m\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 38,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 39,
                  "Content": "  security_group_id = \"${aws_security_group.nomad_lb.id}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245msecurity_group_id\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0maws_security_group.nomad_lb.id\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 40,
                  "Content": "  type              = \"ingress\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mtype\u001b[0m              = \u001b[38;5;37m\"ingress\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 41,
                  "Content": "  protocol          = \"tcp\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mprotocol\u001b[0m          = \u001b[38;5;37m\"tcp\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 42,
                  "Content": "  from_port         = 4646",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mfrom_port\u001b[0m         = \u001b[38;5;37m4646",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 43,
                  "Content": "  to_port           = 4646",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mto_port\u001b[0m           = \u001b[38;5;37m4646",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 44,
                  "Content": "  cidr_blocks       = [\"${split(\",\", var.is_internal_lb ? join(\",\", var.cidr_blocks) : \"0.0.0.0/0\")}\"]",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mcidr_blocks\u001b[0m       = [\u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33msplit\u001b[0m(\u001b[38;5;37m\",\"\u001b[0m, \u001b[38;5;33mvar\u001b[0m.is_internal_lb \u001b[38;5;245m?\u001b[0m \u001b[38;5;33mjoin\u001b[0m(\u001b[38;5;37m\",\"\u001b[0m, \u001b[38;5;33mvar\u001b[0m.cidr_blocks) \u001b[38;5;245m:\u001b[0m \u001b[38;5;37m\"0.0.0.0/0\"\u001b[0m)\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"\u001b[0m]",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 45,
                  "Content": "}",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "}",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "module.nomad_lb_aws",
                "Filename": "github.com/hashicorp-modules/hashistack-aws/main.tf",
                "Location": {
                  "StartLine": 142,
                  "EndLine": 161
                }
              },
              {
                "Resource": "module.hashistack_aws[0]",
                "Filename": "infrastructure-as-code/hashistack/dev/terraform-aws/main.tf",
                "Location": {
                  "StartLine": 90,
                  "EndLine": 113
                }
              }
            ],
            "RenderedCause": {}
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "aws-vpc-add-description-to-security-group-rule",
          "AVDID": "AVD-AWS-0124",
          "Title": "Missing description for security group rule.",
          "Description": "Security group rules should include a description for auditing purposes.\n\nSimplifies auditing, debugging, and managing security groups.\n",
          "Message": "Security group rule does not have a description.",
          "Namespace": "builtin.aws.ec2.aws0124",
          "Query": "data.builtin.aws.ec2.aws0124.deny",
          "Resolution": "Add descriptions for all security groups rules",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/aws-vpc-add-description-to-security-group-rule",
          "References": [
            "https://www.cloudconformity.com/knowledge-base/aws/EC2/security-group-rules-description.html",
            "https://avd.aquasec.com/misconfig/aws-vpc-add-description-to-security-group-rule"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "module.hashistack_aws[0]",
            "Provider": "AWS",
            "Service": "ec2",
            "StartLine": 47,
            "EndLine": 56,
            "Code": {
              "Lines": [
                {
                  "Number": 47,
                  "Content": "resource \"aws_security_group_rule\" \"outbound_tcp\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_security_group_rule\"\u001b[0m \u001b[38;5;37m\"outbound_tcp\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 48,
                  "Content": "  count = \"${var.create ? 1 : 0}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mcount\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.create \u001b[38;5;245m?\u001b[0m \u001b[38;5;37m1\u001b[0m \u001b[38;5;245m:\u001b[0m \u001b[38;5;37m0\u001b[0m\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 49,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 50,
                  "Content": "  security_group_id = \"${aws_security_group.nomad_lb.id}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245msecurity_group_id\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0maws_security_group.nomad_lb.id\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 51,
                  "Content": "  type              = \"egress\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mtype\u001b[0m              = \u001b[38;5;37m\"egress\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 52,
                  "Content": "  protocol          = \"tcp\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mprotocol\u001b[0m          = \u001b[38;5;37m\"tcp\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 53,
                  "Content": "  from_port         = 0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mfrom_port\u001b[0m         = \u001b[38;5;37m0",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 54,
                  "Content": "  to_port           = 65535",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mto_port\u001b[0m           = \u001b[38;5;37m65535",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 55,
                  "Content": "  cidr_blocks       = [\"0.0.0.0/0\"]",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mcidr_blocks\u001b[0m       = [\u001b[38;5;37m\"0.0.0.0/0\"\u001b[0m]",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 56,
                  "Content": "}",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "}",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "module.nomad_lb_aws",
                "Filename": "github.com/hashicorp-modules/hashistack-aws/main.tf",
                "Location": {
                  "StartLine": 142,
                  "EndLine": 161
                }
              },
              {
                "Resource": "module.hashistack_aws[0]",
                "Filename": "infrastructure-as-code/hashistack/dev/terraform-aws/main.tf",
                "Location": {
                  "StartLine": 90,
                  "EndLine": 113
                }
              }
            ],
            "RenderedCause": {}
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0132",
          "AVDID": "AVD-AWS-0132",
          "Title": "S3 encryption should use Customer Managed Keys",
          "Description": "Encryption using AWS keys provides protection for your S3 buckets. To increase control of the encryption and manage factors like rotation use customer managed keys.\n",
          "Message": "Bucket does not encrypt data with a customer managed key.",
          "Namespace": "builtin.aws.s3.aws0132",
          "Query": "data.builtin.aws.s3.aws0132.deny",
          "Resolution": "Enable encryption using customer managed keys",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0132",
          "References": [
            "https://docs.aws.amazon.com/AmazonS3/latest/userguide/bucket-encryption.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0132"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "module.hashistack_aws[0]",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 69,
            "EndLine": 99,
            "Code": {
              "Lines": [
                {
                  "Number": 69,
                  "Content": "resource \"aws_s3_bucket\" \"nomad_lb_access_logs\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_s3_bucket\"\u001b[0m \u001b[38;5;37m\"nomad_lb_access_logs\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 70,
                  "Content": "  count = \"${var.create \u0026\u0026 !var.lb_bucket_override ? 1 : 0}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mcount\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.create \u001b[38;5;245m\u0026\u0026\u001b[0m \u001b[38;5;245m!\u001b[0m\u001b[38;5;33mvar\u001b[0m.lb_bucket_override \u001b[38;5;245m?\u001b[0m \u001b[38;5;37m1\u001b[0m \u001b[38;5;245m:\u001b[0m \u001b[38;5;37m0\u001b[0m\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 71,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 72,
                  "Content": "  bucket = \"${random_id.nomad_lb_access_logs.hex}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mbucket\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0mrandom_id.nomad_lb_access_logs.hex\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 73,
                  "Content": "  acl    = \"private\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245macl\u001b[0m    = \u001b[38;5;37m\"private\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 74,
                  "Content": "  tags   = \"${merge(var.tags, map(\"Name\", format(\"%s-nomad-lb-access-logs\", var.name)))}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mtags\u001b[0m   = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0mmerge(\u001b[38;5;33mvar\u001b[0m.tags,\u001b[38;5;33m map\u001b[0m(\u001b[38;5;37m\"Name\"\u001b[0m, \u001b[38;5;33mformat\u001b[0m(\u001b[38;5;37m\"%s-nomad-lb-access-logs\"\u001b[0m, \u001b[38;5;33mvar\u001b[0m.name)))\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 75,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 76,
                  "Content": "  force_destroy = true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mforce_destroy\u001b[0m = \u001b[38;5;166mtrue",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 77,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 78,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "module.nomad_lb_aws",
                "Filename": "github.com/hashicorp-modules/hashistack-aws/main.tf",
                "Location": {
                  "StartLine": 142,
                  "EndLine": 161
                }
              },
              {
                "Resource": "module.hashistack_aws[0]",
                "Filename": "infrastructure-as-code/hashistack/dev/terraform-aws/main.tf",
                "Location": {
                  "StartLine": 90,
                  "EndLine": 113
                }
              }
            ],
            "RenderedCause": {}
          }
        }
      ]
    },
    {
      "Target": "github.com/hashicorp-modules/hashistack-aws/github.com/hashicorp-modules/nomad-server-ports-aws/github.com/hashicorp-modules/nomad-client-ports-aws/main.tf",
      "Class": "config",
      "Type": "terraform",
      "MisconfSummary": {
        "Successes": 0,
        "Failures": 6
      },
      "Misconfigurations": [
        {
          "Type": "Terraform Security Check",
          "ID": "aws-vpc-no-public-egress-sgr",
          "AVDID": "AVD-AWS-0104",
          "Title": "A security group rule should not allow unrestricted egress to any IP address.",
          "Description": "Opening up ports to connect out to the public internet is generally to be avoided. You should restrict access to IP addresses or ranges that are explicitly required where possible.\n",
          "Message": "Security group rule allows unrestricted egress to any IP address.",
          "Namespace": "builtin.aws.ec2.aws0104",
          "Query": "data.builtin.aws.ec2.aws0104.deny",
          "Resolution": "Set a more restrictive cidr range",
          "Severity": "CRITICAL",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/aws-vpc-no-public-egress-sgr",
          "References": [
            "https://docs.aws.amazon.com/whitepapers/latest/building-scalable-secure-multi-vpc-network-infrastructure/centralized-egress-to-internet.html",
            "https://avd.aquasec.com/misconfig/aws-vpc-no-public-egress-sgr"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "module.hashistack_aws[0]",
            "Provider": "AWS",
            "Service": "ec2",
            "StartLine": 65,
            "EndLine": 65,
            "Code": {
              "Lines": [
                {
                  "Number": 57,
                  "Content": "resource \"aws_security_group_rule\" \"outbound_udp\" {",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_security_group_rule\"\u001b[0m \u001b[38;5;37m\"outbound_udp\"\u001b[0m {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 58,
                  "Content": "  count = \"${var.create ? 1 : 0}\"",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mcount\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.create \u001b[38;5;245m?\u001b[0m \u001b[38;5;37m1\u001b[0m \u001b[38;5;245m:\u001b[0m \u001b[38;5;37m0\u001b[0m\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 59,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 60,
                  "Content": "  security_group_id = \"${aws_security_group.nomad_client.id}\"",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245msecurity_group_id\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0maws_security_group.nomad_client.id\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 61,
                  "Content": "  type              = \"egress\"",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mtype\u001b[0m              = \u001b[38;5;37m\"egress\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 62,
                  "Content": "  protocol          = \"udp\"",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mprotocol\u001b[0m          = \u001b[38;5;37m\"udp\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 63,
                  "Content": "  from_port         = 0",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mfrom_port\u001b[0m         = \u001b[38;5;37m0",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 64,
                  "Content": "  to_port           = 65535",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mto_port\u001b[0m           = \u001b[38;5;37m65535",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 65,
                  "Content": "  cidr_blocks       = [\"0.0.0.0/0\"]",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mcidr_blocks\u001b[0m       = [\u001b[38;5;37m\"0.0.0.0/0\"\u001b[0m]",
                  "FirstCause": true,
                  "LastCause": true
                },
                {
                  "Number": 66,
                  "Content": "}",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "}",
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "aws_security_group_rule.outbound_udp[0]",
                "Filename": "github.com/hashicorp-modules/hashistack-aws/github.com/hashicorp-modules/nomad-server-ports-aws/github.com/hashicorp-modules/nomad-client-ports-aws/main.tf",
                "Location": {
                  "StartLine": 57,
                  "EndLine": 66
                }
              },
              {
                "Resource": "module.nomad_client_ports_aws",
                "Filename": "github.com/hashicorp-modules/hashistack-aws/github.com/hashicorp-modules/nomad-server-ports-aws/main.tf",
                "Location": {
                  "StartLine": 6,
                  "EndLine": 14
                }
              },
              {
                "Resource": "module.nomad_server_sg",
                "Filename": "github.com/hashicorp-modules/hashistack-aws/main.tf",
                "Location": {
                  "StartLine": 57,
                  "EndLine": 64
                }
              },
              {
                "Resource": "module.hashistack_aws[0]",
                "Filename": "infrastructure-as-code/hashistack/dev/terraform-aws/main.tf",
                "Location": {
                  "StartLine": 90,
                  "EndLine": 113
                }
              }
            ],
            "RenderedCause": {}
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "aws-vpc-no-public-egress-sgr",
          "AVDID": "AVD-AWS-0104",
          "Title": "A security group rule should not allow unrestricted egress to any IP address.",
          "Description": "Opening up ports to connect out to the public internet is generally to be avoided. You should restrict access to IP addresses or ranges that are explicitly required where possible.\n",
          "Message": "Security group rule allows unrestricted egress to any IP address.",
          "Namespace": "builtin.aws.ec2.aws0104",
          "Query": "data.builtin.aws.ec2.aws0104.deny",
          "Resolution": "Set a more restrictive cidr range",
          "Severity": "CRITICAL",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/aws-vpc-no-public-egress-sgr",
          "References": [
            "https://docs.aws.amazon.com/whitepapers/latest/building-scalable-secure-multi-vpc-network-infrastructure/centralized-egress-to-internet.html",
            "https://avd.aquasec.com/misconfig/aws-vpc-no-public-egress-sgr"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "module.hashistack_aws[0]",
            "Provider": "AWS",
            "Service": "ec2",
            "StartLine": 53,
            "EndLine": 53,
            "Code": {
              "Lines": [
                {
                  "Number": 45,
                  "Content": "resource \"aws_security_group_rule\" \"outbound_tcp\" {",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_security_group_rule\"\u001b[0m \u001b[38;5;37m\"outbound_tcp\"\u001b[0m {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 46,
                  "Content": "  count = \"${var.create ? 1 : 0}\"",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mcount\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.create \u001b[38;5;245m?\u001b[0m \u001b[38;5;37m1\u001b[0m \u001b[38;5;245m:\u001b[0m \u001b[38;5;37m0\u001b[0m\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 47,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 48,
                  "Content": "  security_group_id = \"${aws_security_group.nomad_client.id}\"",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245msecurity_group_id\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0maws_security_group.nomad_client.id\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 49,
                  "Content": "  type              = \"egress\"",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mtype\u001b[0m              = \u001b[38;5;37m\"egress\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 50,
                  "Content": "  protocol          = \"tcp\"",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mprotocol\u001b[0m          = \u001b[38;5;37m\"tcp\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 51,
                  "Content": "  from_port         = 0",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mfrom_port\u001b[0m         = \u001b[38;5;37m0",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 52,
                  "Content": "  to_port           = 65535",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mto_port\u001b[0m           = \u001b[38;5;37m65535",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 53,
                  "Content": "  cidr_blocks       = [\"0.0.0.0/0\"]",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mcidr_blocks\u001b[0m       = [\u001b[38;5;37m\"0.0.0.0/0\"\u001b[0m]",
                  "FirstCause": true,
                  "LastCause": true
                },
                {
                  "Number": 54,
                  "Content": "}",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "}",
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "aws_security_group_rule.outbound_tcp[0]",
                "Filename": "github.com/hashicorp-modules/hashistack-aws/github.com/hashicorp-modules/nomad-server-ports-aws/github.com/hashicorp-modules/nomad-client-ports-aws/main.tf",
                "Location": {
                  "StartLine": 45,
                  "EndLine": 54
                }
              },
              {
                "Resource": "module.nomad_client_ports_aws",
                "Filename": "github.com/hashicorp-modules/hashistack-aws/github.com/hashicorp-modules/nomad-server-ports-aws/main.tf",
                "Location": {
                  "StartLine": 6,
                  "EndLine": 14
                }
              },
              {
                "Resource": "module.nomad_server_sg",
                "Filename": "github.com/hashicorp-modules/hashistack-aws/main.tf",
                "Location": {
                  "StartLine": 57,
                  "EndLine": 64
                }
              },
              {
                "Resource": "module.hashistack_aws[0]",
                "Filename": "infrastructure-as-code/hashistack/dev/terraform-aws/main.tf",
                "Location": {
                  "StartLine": 90,
                  "EndLine": 113
                }
              }
            ],
            "RenderedCause": {}
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "aws-vpc-add-description-to-security-group-rule",
          "AVDID": "AVD-AWS-0124",
          "Title": "Missing description for security group rule.",
          "Description": "Security group rules should include a description for auditing purposes.\n\nSimplifies auditing, debugging, and managing security groups.\n",
          "Message": "Security group rule does not have a description.",
          "Namespace": "builtin.aws.ec2.aws0124",
          "Query": "data.builtin.aws.ec2.aws0124.deny",
          "Resolution": "Add descriptions for all security groups rules",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/aws-vpc-add-description-to-security-group-rule",
          "References": [
            "https://www.cloudconformity.com/knowledge-base/aws/EC2/security-group-rules-description.html",
            "https://avd.aquasec.com/misconfig/aws-vpc-add-description-to-security-group-rule"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "module.hashistack_aws[0]",
            "Provider": "AWS",
            "Service": "ec2",
            "StartLine": 57,
            "EndLine": 66,
            "Code": {
              "Lines": [
                {
                  "Number": 57,
                  "Content": "resource \"aws_security_group_rule\" \"outbound_udp\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_security_group_rule\"\u001b[0m \u001b[38;5;37m\"outbound_udp\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 58,
                  "Content": "  count = \"${var.create ? 1 : 0}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mcount\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.create \u001b[38;5;245m?\u001b[0m \u001b[38;5;37m1\u001b[0m \u001b[38;5;245m:\u001b[0m \u001b[38;5;37m0\u001b[0m\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 59,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 60,
                  "Content": "  security_group_id = \"${aws_security_group.nomad_client.id}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245msecurity_group_id\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0maws_security_group.nomad_client.id\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 61,
                  "Content": "  type              = \"egress\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mtype\u001b[0m              = \u001b[38;5;37m\"egress\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 62,
                  "Content": "  protocol          = \"udp\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mprotocol\u001b[0m          = \u001b[38;5;37m\"udp\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 63,
                  "Content": "  from_port         = 0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mfrom_port\u001b[0m         = \u001b[38;5;37m0",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 64,
                  "Content": "  to_port           = 65535",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mto_port\u001b[0m           = \u001b[38;5;37m65535",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 65,
                  "Content": "  cidr_blocks       = [\"0.0.0.0/0\"]",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mcidr_blocks\u001b[0m       = [\u001b[38;5;37m\"0.0.0.0/0\"\u001b[0m]",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 66,
                  "Content": "}",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "}",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "module.nomad_client_ports_aws",
                "Filename": "github.com/hashicorp-modules/hashistack-aws/github.com/hashicorp-modules/nomad-server-ports-aws/main.tf",
                "Location": {
                  "StartLine": 6,
                  "EndLine": 14
                }
              },
              {
                "Resource": "module.nomad_server_sg",
                "Filename": "github.com/hashicorp-modules/hashistack-aws/main.tf",
                "Location": {
                  "StartLine": 57,
                  "EndLine": 64
                }
              },
              {
                "Resource": "module.hashistack_aws[0]",
                "Filename": "infrastructure-as-code/hashistack/dev/terraform-aws/main.tf",
                "Location": {
                  "StartLine": 90,
                  "EndLine": 113
                }
              }
            ],
            "RenderedCause": {}
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "aws-vpc-add-description-to-security-group-rule",
          "AVDID": "AVD-AWS-0124",
          "Title": "Missing description for security group rule.",
          "Description": "Security group rules should include a description for auditing purposes.\n\nSimplifies auditing, debugging, and managing security groups.\n",
          "Message": "Security group rule does not have a description.",
          "Namespace": "builtin.aws.ec2.aws0124",
          "Query": "data.builtin.aws.ec2.aws0124.deny",
          "Resolution": "Add descriptions for all security groups rules",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/aws-vpc-add-description-to-security-group-rule",
          "References": [
            "https://www.cloudconformity.com/knowledge-base/aws/EC2/security-group-rules-description.html",
            "https://avd.aquasec.com/misconfig/aws-vpc-add-description-to-security-group-rule"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "module.hashistack_aws[0]",
            "Provider": "AWS",
            "Service": "ec2",
            "StartLine": 45,
            "EndLine": 54,
            "Code": {
              "Lines": [
                {
                  "Number": 45,
                  "Content": "resource \"aws_security_group_rule\" \"outbound_tcp\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_security_group_rule\"\u001b[0m \u001b[38;5;37m\"outbound_tcp\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 46,
                  "Content": "  count = \"${var.create ? 1 : 0}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mcount\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.create \u001b[38;5;245m?\u001b[0m \u001b[38;5;37m1\u001b[0m \u001b[38;5;245m:\u001b[0m \u001b[38;5;37m0\u001b[0m\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 47,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 48,
                  "Content": "  security_group_id = \"${aws_security_group.nomad_client.id}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245msecurity_group_id\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0maws_security_group.nomad_client.id\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 49,
                  "Content": "  type              = \"egress\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mtype\u001b[0m              = \u001b[38;5;37m\"egress\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 50,
                  "Content": "  protocol          = \"tcp\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mprotocol\u001b[0m          = \u001b[38;5;37m\"tcp\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 51,
                  "Content": "  from_port         = 0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mfrom_port\u001b[0m         = \u001b[38;5;37m0",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 52,
                  "Content": "  to_port           = 65535",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mto_port\u001b[0m           = \u001b[38;5;37m65535",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 53,
                  "Content": "  cidr_blocks       = [\"0.0.0.0/0\"]",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mcidr_blocks\u001b[0m       = [\u001b[38;5;37m\"0.0.0.0/0\"\u001b[0m]",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 54,
                  "Content": "}",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "}",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "module.nomad_client_ports_aws",
                "Filename": "github.com/hashicorp-modules/hashistack-aws/github.com/hashicorp-modules/nomad-server-ports-aws/main.tf",
                "Location": {
                  "StartLine": 6,
                  "EndLine": 14
                }
              },
              {
                "Resource": "module.nomad_server_sg",
                "Filename": "github.com/hashicorp-modules/hashistack-aws/main.tf",
                "Location": {
                  "StartLine": 57,
                  "EndLine": 64
                }
              },
              {
                "Resource": "module.hashistack_aws[0]",
                "Filename": "infrastructure-as-code/hashistack/dev/terraform-aws/main.tf",
                "Location": {
                  "StartLine": 90,
                  "EndLine": 113
                }
              }
            ],
            "RenderedCause": {}
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "aws-vpc-add-description-to-security-group-rule",
          "AVDID": "AVD-AWS-0124",
          "Title": "Missing description for security group rule.",
          "Description": "Security group rules should include a description for auditing purposes.\n\nSimplifies auditing, debugging, and managing security groups.\n",
          "Message": "Security group rule does not have a description.",
          "Namespace": "builtin.aws.ec2.aws0124",
          "Query": "data.builtin.aws.ec2.aws0124.deny",
          "Resolution": "Add descriptions for all security groups rules",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/aws-vpc-add-description-to-security-group-rule",
          "References": [
            "https://www.cloudconformity.com/knowledge-base/aws/EC2/security-group-rules-description.html",
            "https://avd.aquasec.com/misconfig/aws-vpc-add-description-to-security-group-rule"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "module.hashistack_aws[0]",
            "Provider": "AWS",
            "Service": "ec2",
            "StartLine": 33,
            "EndLine": 42,
            "Code": {
              "Lines": [
                {
                  "Number": 33,
                  "Content": "resource \"aws_security_group_rule\" \"rpc_tcp\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_security_group_rule\"\u001b[0m \u001b[38;5;37m\"rpc_tcp\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 34,
                  "Content": "  count = \"${var.create ? 1 : 0}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mcount\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.create \u001b[38;5;245m?\u001b[0m \u001b[38;5;37m1\u001b[0m \u001b[38;5;245m:\u001b[0m \u001b[38;5;37m0\u001b[0m\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 35,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 36,
                  "Content": "  security_group_id = \"${aws_security_group.nomad_client.id}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245msecurity_group_id\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0maws_security_group.nomad_client.id\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 37,
                  "Content": "  type              = \"ingress\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mtype\u001b[0m              = \u001b[38;5;37m\"ingress\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 38,
                  "Content": "  protocol          = \"tcp\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mprotocol\u001b[0m          = \u001b[38;5;37m\"tcp\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 39,
                  "Content": "  from_port         = 4647",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mfrom_port\u001b[0m         = \u001b[38;5;37m4647",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 40,
                  "Content": "  to_port           = 4647",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mto_port\u001b[0m           = \u001b[38;5;37m4647",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 41,
                  "Content": "  cidr_blocks       = [\"${var.cidr_blocks}\"]",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mcidr_blocks\u001b[0m       = [\u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.cidr_blocks\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"\u001b[0m]",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 42,
                  "Content": "}",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "}",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "module.nomad_client_ports_aws",
                "Filename": "github.com/hashicorp-modules/hashistack-aws/github.com/hashicorp-modules/nomad-server-ports-aws/main.tf",
                "Location": {
                  "StartLine": 6,
                  "EndLine": 14
                }
              },
              {
                "Resource": "module.nomad_server_sg",
                "Filename": "github.com/hashicorp-modules/hashistack-aws/main.tf",
                "Location": {
                  "StartLine": 57,
                  "EndLine": 64
                }
              },
              {
                "Resource": "module.hashistack_aws[0]",
                "Filename": "infrastructure-as-code/hashistack/dev/terraform-aws/main.tf",
                "Location": {
                  "StartLine": 90,
                  "EndLine": 113
                }
              }
            ],
            "RenderedCause": {}
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "aws-vpc-add-description-to-security-group-rule",
          "AVDID": "AVD-AWS-0124",
          "Title": "Missing description for security group rule.",
          "Description": "Security group rules should include a description for auditing purposes.\n\nSimplifies auditing, debugging, and managing security groups.\n",
          "Message": "Security group rule does not have a description.",
          "Namespace": "builtin.aws.ec2.aws0124",
          "Query": "data.builtin.aws.ec2.aws0124.deny",
          "Resolution": "Add descriptions for all security groups rules",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/aws-vpc-add-description-to-security-group-rule",
          "References": [
            "https://www.cloudconformity.com/knowledge-base/aws/EC2/security-group-rules-description.html",
            "https://avd.aquasec.com/misconfig/aws-vpc-add-description-to-security-group-rule"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "module.hashistack_aws[0]",
            "Provider": "AWS",
            "Service": "ec2",
            "StartLine": 17,
            "EndLine": 26,
            "Code": {
              "Lines": [
                {
                  "Number": 17,
                  "Content": "resource \"aws_security_group_rule\" \"http_tcp\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_security_group_rule\"\u001b[0m \u001b[38;5;37m\"http_tcp\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 18,
                  "Content": "  count = \"${var.create ? 1 : 0}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mcount\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.create \u001b[38;5;245m?\u001b[0m \u001b[38;5;37m1\u001b[0m \u001b[38;5;245m:\u001b[0m \u001b[38;5;37m0\u001b[0m\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "  security_group_id = \"${aws_security_group.nomad_client.id}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245msecurity_group_id\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0maws_security_group.nomad_client.id\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "  type              = \"ingress\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mtype\u001b[0m              = \u001b[38;5;37m\"ingress\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "  protocol          = \"tcp\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mprotocol\u001b[0m          = \u001b[38;5;37m\"tcp\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "  from_port         = 4646",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mfrom_port\u001b[0m         = \u001b[38;5;37m4646",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 24,
                  "Content": "  to_port           = 4646",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mto_port\u001b[0m           = \u001b[38;5;37m4646",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 25,
                  "Content": "  cidr_blocks       = [\"${var.cidr_blocks}\"]",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mcidr_blocks\u001b[0m       = [\u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.cidr_blocks\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"\u001b[0m]",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 26,
                  "Content": "}",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "}",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "module.nomad_client_ports_aws",
                "Filename": "github.com/hashicorp-modules/hashistack-aws/github.com/hashicorp-modules/nomad-server-ports-aws/main.tf",
                "Location": {
                  "StartLine": 6,
                  "EndLine": 14
                }
              },
              {
                "Resource": "module.nomad_server_sg",
                "Filename": "github.com/hashicorp-modules/hashistack-aws/main.tf",
                "Location": {
                  "StartLine": 57,
                  "EndLine": 64
                }
              },
              {
                "Resource": "module.hashistack_aws[0]",
                "Filename": "infrastructure-as-code/hashistack/dev/terraform-aws/main.tf",
                "Location": {
                  "StartLine": 90,
                  "EndLine": 113
                }
              }
            ],
            "RenderedCause": {}
          }
        }
      ]
    },
    {
      "Target": "github.com/hashicorp-modules/hashistack-aws/github.com/hashicorp-modules/nomad-server-ports-aws/main.tf",
      "Class": "config",
      "Type": "terraform",
      "MisconfSummary": {
        "Successes": 0,
        "Failures": 2
      },
      "Misconfigurations": [
        {
          "Type": "Terraform Security Check",
          "ID": "aws-vpc-add-description-to-security-group-rule",
          "AVDID": "AVD-AWS-0124",
          "Title": "Missing description for security group rule.",
          "Description": "Security group rules should include a description for auditing purposes.\n\nSimplifies auditing, debugging, and managing security groups.\n",
          "Message": "Security group rule does not have a description.",
          "Namespace": "builtin.aws.ec2.aws0124",
          "Query": "data.builtin.aws.ec2.aws0124.deny",
          "Resolution": "Add descriptions for all security groups rules",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/aws-vpc-add-description-to-security-group-rule",
          "References": [
            "https://www.cloudconformity.com/knowledge-base/aws/EC2/security-group-rules-description.html",
            "https://avd.aquasec.com/misconfig/aws-vpc-add-description-to-security-group-rule"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "module.hashistack_aws[0]",
            "Provider": "AWS",
            "Service": "ec2",
            "StartLine": 33,
            "EndLine": 42,
            "Code": {
              "Lines": [
                {
                  "Number": 33,
                  "Content": "resource \"aws_security_group_rule\" \"serf_udp\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_security_group_rule\"\u001b[0m \u001b[38;5;37m\"serf_udp\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 34,
                  "Content": "  count = \"${var.create ? 1 : 0}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mcount\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.create \u001b[38;5;245m?\u001b[0m \u001b[38;5;37m1\u001b[0m \u001b[38;5;245m:\u001b[0m \u001b[38;5;37m0\u001b[0m\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 35,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 36,
                  "Content": "  security_group_id = \"${module.nomad_client_ports_aws.nomad_client_sg_id}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245msecurity_group_id\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mmodule\u001b[0m.nomad_client_ports_aws.nomad_client_sg_id\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 37,
                  "Content": "  type              = \"ingress\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mtype\u001b[0m              = \u001b[38;5;37m\"ingress\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 38,
                  "Content": "  protocol          = \"udp\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mprotocol\u001b[0m          = \u001b[38;5;37m\"udp\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 39,
                  "Content": "  from_port         = 4648",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mfrom_port\u001b[0m         = \u001b[38;5;37m4648",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 40,
                  "Content": "  to_port           = 4648",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mto_port\u001b[0m           = \u001b[38;5;37m4648",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 41,
                  "Content": "  cidr_blocks       = [\"${var.cidr_blocks}\"]",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mcidr_blocks\u001b[0m       = [\u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.cidr_blocks\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"\u001b[0m]",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 42,
                  "Content": "}",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "}",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "module.nomad_server_sg",
                "Filename": "github.com/hashicorp-modules/hashistack-aws/main.tf",
                "Location": {
                  "StartLine": 57,
                  "EndLine": 64
                }
              },
              {
                "Resource": "module.hashistack_aws[0]",
                "Filename": "infrastructure-as-code/hashistack/dev/terraform-aws/main.tf",
                "Location": {
                  "StartLine": 90,
                  "EndLine": 113
                }
              }
            ],
            "RenderedCause": {}
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "aws-vpc-add-description-to-security-group-rule",
          "AVDID": "AVD-AWS-0124",
          "Title": "Missing description for security group rule.",
          "Description": "Security group rules should include a description for auditing purposes.\n\nSimplifies auditing, debugging, and managing security groups.\n",
          "Message": "Security group rule does not have a description.",
          "Namespace": "builtin.aws.ec2.aws0124",
          "Query": "data.builtin.aws.ec2.aws0124.deny",
          "Resolution": "Add descriptions for all security groups rules",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/aws-vpc-add-description-to-security-group-rule",
          "References": [
            "https://www.cloudconformity.com/knowledge-base/aws/EC2/security-group-rules-description.html",
            "https://avd.aquasec.com/misconfig/aws-vpc-add-description-to-security-group-rule"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "module.hashistack_aws[0]",
            "Provider": "AWS",
            "Service": "ec2",
            "StartLine": 19,
            "EndLine": 28,
            "Code": {
              "Lines": [
                {
                  "Number": 19,
                  "Content": "resource \"aws_security_group_rule\" \"serf_tcp\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_security_group_rule\"\u001b[0m \u001b[38;5;37m\"serf_tcp\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "  count = \"${var.create ? 1 : 0}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mcount\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.create \u001b[38;5;245m?\u001b[0m \u001b[38;5;37m1\u001b[0m \u001b[38;5;245m:\u001b[0m \u001b[38;5;37m0\u001b[0m\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "  security_group_id = \"${module.nomad_client_ports_aws.nomad_client_sg_id}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245msecurity_group_id\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mmodule\u001b[0m.nomad_client_ports_aws.nomad_client_sg_id\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "  type              = \"ingress\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mtype\u001b[0m              = \u001b[38;5;37m\"ingress\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 24,
                  "Content": "  protocol          = \"tcp\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mprotocol\u001b[0m          = \u001b[38;5;37m\"tcp\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 25,
                  "Content": "  from_port         = 4648",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mfrom_port\u001b[0m         = \u001b[38;5;37m4648",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 26,
                  "Content": "  to_port           = 4648",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mto_port\u001b[0m           = \u001b[38;5;37m4648",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 27,
                  "Content": "  cidr_blocks       = [\"${var.cidr_blocks}\"]",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mcidr_blocks\u001b[0m       = [\u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.cidr_blocks\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"\u001b[0m]",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 28,
                  "Content": "}",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "}",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "module.nomad_server_sg",
                "Filename": "github.com/hashicorp-modules/hashistack-aws/main.tf",
                "Location": {
                  "StartLine": 57,
                  "EndLine": 64
                }
              },
              {
                "Resource": "module.hashistack_aws[0]",
                "Filename": "infrastructure-as-code/hashistack/dev/terraform-aws/main.tf",
                "Location": {
                  "StartLine": 90,
                  "EndLine": 113
                }
              }
            ],
            "RenderedCause": {}
          }
        }
      ]
    },
    {
      "Target": "github.com/hashicorp-modules/hashistack-aws/github.com/hashicorp-modules/vault-lb-aws/main.tf",
      "Class": "config",
      "Type": "terraform",
      "MisconfSummary": {
        "Successes": 0,
        "Failures": 15
      },
      "Misconfigurations": [
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0052",
          "AVDID": "AVD-AWS-0052",
          "Title": "Load balancers should drop invalid headers",
          "Description": "Passing unknown or invalid headers through to the target poses a potential risk of compromise.\nBy setting drop_invalid_header_fields to true, anything that does not conform to well known, defined headers will be removed by the load balancer.\n",
          "Message": "Application load balancer is not set to drop invalid headers.",
          "Namespace": "builtin.aws.elb.aws0052",
          "Query": "data.builtin.aws.elb.aws0052.deny",
          "Resolution": "Set drop_invalid_header_fields to true",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0052",
          "References": [
            "https://docs.aws.amazon.com/elasticloadbalancing/latest/application/application-load-balancers.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0052"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "module.hashistack_aws[0]",
            "Provider": "AWS",
            "Service": "elb",
            "StartLine": 108,
            "EndLine": 122,
            "Code": {
              "Lines": [
                {
                  "Number": 108,
                  "Content": "resource \"aws_lb\" \"vault\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_lb\"\u001b[0m \u001b[38;5;37m\"vault\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 109,
                  "Content": "  count = \"${var.create ? 1 : 0}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mcount\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.create \u001b[38;5;245m?\u001b[0m \u001b[38;5;37m1\u001b[0m \u001b[38;5;245m:\u001b[0m \u001b[38;5;37m0\u001b[0m\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 110,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 111,
                  "Content": "  name            = \"${random_id.vault_lb.hex}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mname\u001b[0m            = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0mrandom_id.vault_lb.hex\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 112,
                  "Content": "  internal        = \"${var.is_internal_lb ? true : false}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245minternal\u001b[0m        = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.is_internal_lb \u001b[38;5;245m?\u001b[0m \u001b[38;5;166mtrue\u001b[0m \u001b[38;5;245m:\u001b[0m \u001b[38;5;166mfalse\u001b[0m\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 113,
                  "Content": "  subnets         = [\"${var.subnet_ids}\"]",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245msubnets\u001b[0m         = [\u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.subnet_ids\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"\u001b[0m]",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 114,
                  "Content": "  security_groups = [\"${aws_security_group.vault_lb.id}\"]",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245msecurity_groups\u001b[0m = [\u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0maws_security_group.vault_lb.id\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"\u001b[0m]",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 115,
                  "Content": "  tags            = \"${merge(var.tags, map(\"Name\", format(\"%s-vault-lb\", var.name)))}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mtags\u001b[0m            = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0mmerge(\u001b[38;5;33mvar\u001b[0m.tags,\u001b[38;5;33m map\u001b[0m(\u001b[38;5;37m\"Name\"\u001b[0m, \u001b[38;5;33mformat\u001b[0m(\u001b[38;5;37m\"%s-vault-lb\"\u001b[0m, \u001b[38;5;33mvar\u001b[0m.name)))\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 116,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 117,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "module.vault_lb_aws",
                "Filename": "github.com/hashicorp-modules/hashistack-aws/main.tf",
                "Location": {
                  "StartLine": 121,
                  "EndLine": 140
                }
              },
              {
                "Resource": "module.hashistack_aws[0]",
                "Filename": "infrastructure-as-code/hashistack/dev/terraform-aws/main.tf",
                "Location": {
                  "StartLine": 90,
                  "EndLine": 113
                }
              }
            ],
            "RenderedCause": {}
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0053",
          "AVDID": "AVD-AWS-0053",
          "Title": "Load balancer is exposed to the internet.",
          "Description": "There are many scenarios in which you would want to expose a load balancer to the wider internet, but this check exists as a warning to prevent accidental exposure of internal assets. You should ensure that this resource should be exposed publicly.\n",
          "Message": "Load balancer is exposed publicly.",
          "Namespace": "builtin.aws.elb.aws0053",
          "Query": "data.builtin.aws.elb.aws0053.deny",
          "Resolution": "Switch to an internal load balancer or add a tfsec ignore",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0053",
          "References": [
            "https://avd.aquasec.com/misconfig/avd-aws-0053"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "module.hashistack_aws[0]",
            "Provider": "AWS",
            "Service": "elb",
            "StartLine": 112,
            "EndLine": 112,
            "Code": {
              "Lines": [
                {
                  "Number": 108,
                  "Content": "resource \"aws_lb\" \"vault\" {",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_lb\"\u001b[0m \u001b[38;5;37m\"vault\"\u001b[0m {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 109,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 112,
                  "Content": "  internal        = \"${var.is_internal_lb ? true : false}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245minternal\u001b[0m        = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.is_internal_lb \u001b[38;5;245m?\u001b[0m \u001b[38;5;166mtrue\u001b[0m \u001b[38;5;245m:\u001b[0m \u001b[38;5;166mfalse\u001b[0m\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": true,
                  "LastCause": true
                },
                {
                  "Number": 121,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 122,
                  "Content": "}",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "}",
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "aws_lb.vault[0]",
                "Filename": "github.com/hashicorp-modules/hashistack-aws/github.com/hashicorp-modules/vault-lb-aws/main.tf",
                "Location": {
                  "StartLine": 108,
                  "EndLine": 122
                }
              },
              {
                "Resource": "module.vault_lb_aws",
                "Filename": "github.com/hashicorp-modules/hashistack-aws/main.tf",
                "Location": {
                  "StartLine": 121,
                  "EndLine": 140
                }
              },
              {
                "Resource": "module.hashistack_aws[0]",
                "Filename": "infrastructure-as-code/hashistack/dev/terraform-aws/main.tf",
                "Location": {
                  "StartLine": 90,
                  "EndLine": 113
                }
              }
            ],
            "RenderedCause": {
              "Raw": "resource \"aws_lb\" \"vault\" {\n  internal = false\n}",
              "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_lb\"\u001b[0m \u001b[38;5;37m\"vault\"\u001b[0m {\n  \u001b[38;5;245minternal\u001b[0m = \u001b[38;5;166mfalse\n\u001b[0m}"
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0086",
          "AVDID": "AVD-AWS-0086",
          "Title": "S3 Access block should block public ACL",
          "Description": "S3 buckets should block public ACLs on buckets and any objects they contain. By blocking, PUTs with fail if the object has any public ACL a.\n",
          "Message": "No public access block so not blocking public acls",
          "Namespace": "builtin.aws.s3.aws0086",
          "Query": "data.builtin.aws.s3.aws0086.deny",
          "Resolution": "Enable blocking any PUT calls with a public ACL specified",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0086",
          "References": [
            "https://docs.aws.amazon.com/AmazonS3/latest/userguide/access-control-block-public-access.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0086"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "module.hashistack_aws[0]",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 69,
            "EndLine": 99,
            "Code": {
              "Lines": [
                {
                  "Number": 69,
                  "Content": "resource \"aws_s3_bucket\" \"vault_lb_access_logs\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_s3_bucket\"\u001b[0m \u001b[38;5;37m\"vault_lb_access_logs\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 70,
                  "Content": "  count = \"${var.create \u0026\u0026 !var.lb_bucket_override ? 1 : 0}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mcount\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.create \u001b[38;5;245m\u0026\u0026\u001b[0m \u001b[38;5;245m!\u001b[0m\u001b[38;5;33mvar\u001b[0m.lb_bucket_override \u001b[38;5;245m?\u001b[0m \u001b[38;5;37m1\u001b[0m \u001b[38;5;245m:\u001b[0m \u001b[38;5;37m0\u001b[0m\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 71,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 72,
                  "Content": "  bucket = \"${random_id.vault_lb_access_logs.hex}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mbucket\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0mrandom_id.vault_lb_access_logs.hex\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 73,
                  "Content": "  acl    = \"private\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245macl\u001b[0m    = \u001b[38;5;37m\"private\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 74,
                  "Content": "  tags   = \"${merge(var.tags, map(\"Name\", format(\"%s-vault-lb-access-logs\", var.name)))}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mtags\u001b[0m   = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0mmerge(\u001b[38;5;33mvar\u001b[0m.tags,\u001b[38;5;33m map\u001b[0m(\u001b[38;5;37m\"Name\"\u001b[0m, \u001b[38;5;33mformat\u001b[0m(\u001b[38;5;37m\"%s-vault-lb-access-logs\"\u001b[0m, \u001b[38;5;33mvar\u001b[0m.name)))\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 75,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 76,
                  "Content": "  force_destroy = true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mforce_destroy\u001b[0m = \u001b[38;5;166mtrue",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 77,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 78,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "module.vault_lb_aws",
                "Filename": "github.com/hashicorp-modules/hashistack-aws/main.tf",
                "Location": {
                  "StartLine": 121,
                  "EndLine": 140
                }
              },
              {
                "Resource": "module.hashistack_aws[0]",
                "Filename": "infrastructure-as-code/hashistack/dev/terraform-aws/main.tf",
                "Location": {
                  "StartLine": 90,
                  "EndLine": 113
                }
              }
            ],
            "RenderedCause": {}
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0087",
          "AVDID": "AVD-AWS-0087",
          "Title": "S3 Access block should block public policy",
          "Description": "S3 bucket policy should have block public policy to prevent users from putting a policy that enable public access.\n",
          "Message": "No public access block so not blocking public policies",
          "Namespace": "builtin.aws.s3.aws0087",
          "Query": "data.builtin.aws.s3.aws0087.deny",
          "Resolution": "Prevent policies that allow public access being PUT",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0087",
          "References": [
            "https://docs.aws.amazon.com/AmazonS3/latest/dev-retired/access-control-block-public-access.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0087"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "module.hashistack_aws[0]",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 69,
            "EndLine": 99,
            "Code": {
              "Lines": [
                {
                  "Number": 69,
                  "Content": "resource \"aws_s3_bucket\" \"vault_lb_access_logs\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_s3_bucket\"\u001b[0m \u001b[38;5;37m\"vault_lb_access_logs\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 70,
                  "Content": "  count = \"${var.create \u0026\u0026 !var.lb_bucket_override ? 1 : 0}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mcount\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.create \u001b[38;5;245m\u0026\u0026\u001b[0m \u001b[38;5;245m!\u001b[0m\u001b[38;5;33mvar\u001b[0m.lb_bucket_override \u001b[38;5;245m?\u001b[0m \u001b[38;5;37m1\u001b[0m \u001b[38;5;245m:\u001b[0m \u001b[38;5;37m0\u001b[0m\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 71,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 72,
                  "Content": "  bucket = \"${random_id.vault_lb_access_logs.hex}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mbucket\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0mrandom_id.vault_lb_access_logs.hex\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 73,
                  "Content": "  acl    = \"private\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245macl\u001b[0m    = \u001b[38;5;37m\"private\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 74,
                  "Content": "  tags   = \"${merge(var.tags, map(\"Name\", format(\"%s-vault-lb-access-logs\", var.name)))}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mtags\u001b[0m   = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0mmerge(\u001b[38;5;33mvar\u001b[0m.tags,\u001b[38;5;33m map\u001b[0m(\u001b[38;5;37m\"Name\"\u001b[0m, \u001b[38;5;33mformat\u001b[0m(\u001b[38;5;37m\"%s-vault-lb-access-logs\"\u001b[0m, \u001b[38;5;33mvar\u001b[0m.name)))\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 75,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 76,
                  "Content": "  force_destroy = true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mforce_destroy\u001b[0m = \u001b[38;5;166mtrue",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 77,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 78,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "module.vault_lb_aws",
                "Filename": "github.com/hashicorp-modules/hashistack-aws/main.tf",
                "Location": {
                  "StartLine": 121,
                  "EndLine": 140
                }
              },
              {
                "Resource": "module.hashistack_aws[0]",
                "Filename": "infrastructure-as-code/hashistack/dev/terraform-aws/main.tf",
                "Location": {
                  "StartLine": 90,
                  "EndLine": 113
                }
              }
            ],
            "RenderedCause": {}
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0088",
          "AVDID": "AVD-AWS-0088",
          "Title": "Unencrypted S3 bucket.",
          "Description": "S3 Buckets should be encrypted to protect the data that is stored within them if access is compromised.\n",
          "Message": "Bucket does not have encryption enabled",
          "Namespace": "builtin.aws.s3.aws0088",
          "Query": "data.builtin.aws.s3.aws0088.deny",
          "Resolution": "Configure bucket encryption",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0088",
          "References": [
            "https://docs.aws.amazon.com/AmazonS3/latest/userguide/bucket-encryption.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0088"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "module.hashistack_aws[0]",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 69,
            "EndLine": 99,
            "Code": {
              "Lines": [
                {
                  "Number": 69,
                  "Content": "resource \"aws_s3_bucket\" \"vault_lb_access_logs\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_s3_bucket\"\u001b[0m \u001b[38;5;37m\"vault_lb_access_logs\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 70,
                  "Content": "  count = \"${var.create \u0026\u0026 !var.lb_bucket_override ? 1 : 0}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mcount\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.create \u001b[38;5;245m\u0026\u0026\u001b[0m \u001b[38;5;245m!\u001b[0m\u001b[38;5;33mvar\u001b[0m.lb_bucket_override \u001b[38;5;245m?\u001b[0m \u001b[38;5;37m1\u001b[0m \u001b[38;5;245m:\u001b[0m \u001b[38;5;37m0\u001b[0m\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 71,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 72,
                  "Content": "  bucket = \"${random_id.vault_lb_access_logs.hex}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mbucket\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0mrandom_id.vault_lb_access_logs.hex\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 73,
                  "Content": "  acl    = \"private\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245macl\u001b[0m    = \u001b[38;5;37m\"private\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 74,
                  "Content": "  tags   = \"${merge(var.tags, map(\"Name\", format(\"%s-vault-lb-access-logs\", var.name)))}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mtags\u001b[0m   = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0mmerge(\u001b[38;5;33mvar\u001b[0m.tags,\u001b[38;5;33m map\u001b[0m(\u001b[38;5;37m\"Name\"\u001b[0m, \u001b[38;5;33mformat\u001b[0m(\u001b[38;5;37m\"%s-vault-lb-access-logs\"\u001b[0m, \u001b[38;5;33mvar\u001b[0m.name)))\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 75,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 76,
                  "Content": "  force_destroy = true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mforce_destroy\u001b[0m = \u001b[38;5;166mtrue",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 77,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 78,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "module.vault_lb_aws",
                "Filename": "github.com/hashicorp-modules/hashistack-aws/main.tf",
                "Location": {
                  "StartLine": 121,
                  "EndLine": 140
                }
              },
              {
                "Resource": "module.hashistack_aws[0]",
                "Filename": "infrastructure-as-code/hashistack/dev/terraform-aws/main.tf",
                "Location": {
                  "StartLine": 90,
                  "EndLine": 113
                }
              }
            ],
            "RenderedCause": {}
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "s3-bucket-logging",
          "AVDID": "AVD-AWS-0089",
          "Title": "S3 Bucket Logging",
          "Description": "Ensures S3 bucket logging is enabled for S3 buckets",
          "Message": "Bucket has logging disabled",
          "Namespace": "builtin.aws.s3.aws0089",
          "Query": "data.builtin.aws.s3.aws0089.deny",
          "Resolution": "Add a logging block to the resource to enable access logging",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/s3-bucket-logging",
          "References": [
            "https://docs.aws.amazon.com/AmazonS3/latest/userguide/ServerLogs.html",
            "https://docs.aws.amazon.com/AmazonS3/latest/userguide/enable-server-access-logging.html",
            "https://avd.aquasec.com/misconfig/s3-bucket-logging"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "module.hashistack_aws[0]",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 69,
            "EndLine": 99,
            "Code": {
              "Lines": [
                {
                  "Number": 69,
                  "Content": "resource \"aws_s3_bucket\" \"vault_lb_access_logs\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_s3_bucket\"\u001b[0m \u001b[38;5;37m\"vault_lb_access_logs\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 70,
                  "Content": "  count = \"${var.create \u0026\u0026 !var.lb_bucket_override ? 1 : 0}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mcount\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.create \u001b[38;5;245m\u0026\u0026\u001b[0m \u001b[38;5;245m!\u001b[0m\u001b[38;5;33mvar\u001b[0m.lb_bucket_override \u001b[38;5;245m?\u001b[0m \u001b[38;5;37m1\u001b[0m \u001b[38;5;245m:\u001b[0m \u001b[38;5;37m0\u001b[0m\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 71,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 72,
                  "Content": "  bucket = \"${random_id.vault_lb_access_logs.hex}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mbucket\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0mrandom_id.vault_lb_access_logs.hex\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 73,
                  "Content": "  acl    = \"private\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245macl\u001b[0m    = \u001b[38;5;37m\"private\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 74,
                  "Content": "  tags   = \"${merge(var.tags, map(\"Name\", format(\"%s-vault-lb-access-logs\", var.name)))}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mtags\u001b[0m   = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0mmerge(\u001b[38;5;33mvar\u001b[0m.tags,\u001b[38;5;33m map\u001b[0m(\u001b[38;5;37m\"Name\"\u001b[0m, \u001b[38;5;33mformat\u001b[0m(\u001b[38;5;37m\"%s-vault-lb-access-logs\"\u001b[0m, \u001b[38;5;33mvar\u001b[0m.name)))\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 75,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 76,
                  "Content": "  force_destroy = true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mforce_destroy\u001b[0m = \u001b[38;5;166mtrue",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 77,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 78,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "module.vault_lb_aws",
                "Filename": "github.com/hashicorp-modules/hashistack-aws/main.tf",
                "Location": {
                  "StartLine": 121,
                  "EndLine": 140
                }
              },
              {
                "Resource": "module.hashistack_aws[0]",
                "Filename": "infrastructure-as-code/hashistack/dev/terraform-aws/main.tf",
                "Location": {
                  "StartLine": 90,
                  "EndLine": 113
                }
              }
            ],
            "RenderedCause": {}
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0090",
          "AVDID": "AVD-AWS-0090",
          "Title": "S3 Data should be versioned",
          "Description": "Versioning in Amazon S3 is a means of keeping multiple variants of an object in the same bucket.\n\nYou can use the S3 Versioning feature to preserve, retrieve, and restore every version of every object stored in your buckets.\n\nWith versioning you can recover more easily from both unintended user actions and application failures.\n",
          "Message": "Bucket does not have versioning enabled",
          "Namespace": "builtin.aws.s3.aws0090",
          "Query": "data.builtin.aws.s3.aws0090.deny",
          "Resolution": "Enable versioning to protect against accidental/malicious removal or modification",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0090",
          "References": [
            "https://docs.aws.amazon.com/AmazonS3/latest/userguide/Versioning.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0090"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "module.hashistack_aws[0]",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 69,
            "EndLine": 99,
            "Code": {
              "Lines": [
                {
                  "Number": 69,
                  "Content": "resource \"aws_s3_bucket\" \"vault_lb_access_logs\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_s3_bucket\"\u001b[0m \u001b[38;5;37m\"vault_lb_access_logs\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 70,
                  "Content": "  count = \"${var.create \u0026\u0026 !var.lb_bucket_override ? 1 : 0}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mcount\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.create \u001b[38;5;245m\u0026\u0026\u001b[0m \u001b[38;5;245m!\u001b[0m\u001b[38;5;33mvar\u001b[0m.lb_bucket_override \u001b[38;5;245m?\u001b[0m \u001b[38;5;37m1\u001b[0m \u001b[38;5;245m:\u001b[0m \u001b[38;5;37m0\u001b[0m\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 71,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 72,
                  "Content": "  bucket = \"${random_id.vault_lb_access_logs.hex}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mbucket\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0mrandom_id.vault_lb_access_logs.hex\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 73,
                  "Content": "  acl    = \"private\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245macl\u001b[0m    = \u001b[38;5;37m\"private\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 74,
                  "Content": "  tags   = \"${merge(var.tags, map(\"Name\", format(\"%s-vault-lb-access-logs\", var.name)))}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mtags\u001b[0m   = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0mmerge(\u001b[38;5;33mvar\u001b[0m.tags,\u001b[38;5;33m map\u001b[0m(\u001b[38;5;37m\"Name\"\u001b[0m, \u001b[38;5;33mformat\u001b[0m(\u001b[38;5;37m\"%s-vault-lb-access-logs\"\u001b[0m, \u001b[38;5;33mvar\u001b[0m.name)))\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 75,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 76,
                  "Content": "  force_destroy = true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mforce_destroy\u001b[0m = \u001b[38;5;166mtrue",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 77,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 78,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "module.vault_lb_aws",
                "Filename": "github.com/hashicorp-modules/hashistack-aws/main.tf",
                "Location": {
                  "StartLine": 121,
                  "EndLine": 140
                }
              },
              {
                "Resource": "module.hashistack_aws[0]",
                "Filename": "infrastructure-as-code/hashistack/dev/terraform-aws/main.tf",
                "Location": {
                  "StartLine": 90,
                  "EndLine": 113
                }
              }
            ],
            "RenderedCause": {}
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0091",
          "AVDID": "AVD-AWS-0091",
          "Title": "S3 Access Block should Ignore Public ACL",
          "Description": "S3 buckets should ignore public ACLs on buckets and any objects they contain. By ignoring rather than blocking, PUT calls with public ACLs will still be applied but the ACL will be ignored.\n",
          "Message": "No public access block so not blocking public acls",
          "Namespace": "builtin.aws.s3.aws0091",
          "Query": "data.builtin.aws.s3.aws0091.deny",
          "Resolution": "Enable ignoring the application of public ACLs in PUT calls",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0091",
          "References": [
            "https://docs.aws.amazon.com/AmazonS3/latest/userguide/access-control-block-public-access.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0091"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "module.hashistack_aws[0]",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 69,
            "EndLine": 99,
            "Code": {
              "Lines": [
                {
                  "Number": 69,
                  "Content": "resource \"aws_s3_bucket\" \"vault_lb_access_logs\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_s3_bucket\"\u001b[0m \u001b[38;5;37m\"vault_lb_access_logs\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 70,
                  "Content": "  count = \"${var.create \u0026\u0026 !var.lb_bucket_override ? 1 : 0}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mcount\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.create \u001b[38;5;245m\u0026\u0026\u001b[0m \u001b[38;5;245m!\u001b[0m\u001b[38;5;33mvar\u001b[0m.lb_bucket_override \u001b[38;5;245m?\u001b[0m \u001b[38;5;37m1\u001b[0m \u001b[38;5;245m:\u001b[0m \u001b[38;5;37m0\u001b[0m\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 71,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 72,
                  "Content": "  bucket = \"${random_id.vault_lb_access_logs.hex}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mbucket\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0mrandom_id.vault_lb_access_logs.hex\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 73,
                  "Content": "  acl    = \"private\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245macl\u001b[0m    = \u001b[38;5;37m\"private\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 74,
                  "Content": "  tags   = \"${merge(var.tags, map(\"Name\", format(\"%s-vault-lb-access-logs\", var.name)))}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mtags\u001b[0m   = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0mmerge(\u001b[38;5;33mvar\u001b[0m.tags,\u001b[38;5;33m map\u001b[0m(\u001b[38;5;37m\"Name\"\u001b[0m, \u001b[38;5;33mformat\u001b[0m(\u001b[38;5;37m\"%s-vault-lb-access-logs\"\u001b[0m, \u001b[38;5;33mvar\u001b[0m.name)))\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 75,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 76,
                  "Content": "  force_destroy = true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mforce_destroy\u001b[0m = \u001b[38;5;166mtrue",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 77,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 78,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "module.vault_lb_aws",
                "Filename": "github.com/hashicorp-modules/hashistack-aws/main.tf",
                "Location": {
                  "StartLine": 121,
                  "EndLine": 140
                }
              },
              {
                "Resource": "module.hashistack_aws[0]",
                "Filename": "infrastructure-as-code/hashistack/dev/terraform-aws/main.tf",
                "Location": {
                  "StartLine": 90,
                  "EndLine": 113
                }
              }
            ],
            "RenderedCause": {}
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0093",
          "AVDID": "AVD-AWS-0093",
          "Title": "S3 Access block should restrict public bucket to limit access",
          "Description": "S3 buckets should restrict public policies for the bucket. By enabling, the restrict_public_buckets, only the bucket owner and AWS Services can access if it has a public policy.\n",
          "Message": "No public access block so not restricting public buckets",
          "Namespace": "builtin.aws.s3.aws0093",
          "Query": "data.builtin.aws.s3.aws0093.deny",
          "Resolution": "Limit the access to public buckets to only the owner or AWS Services (eg; CloudFront)",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0093",
          "References": [
            "https://docs.aws.amazon.com/AmazonS3/latest/dev-retired/access-control-block-public-access.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0093"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "module.hashistack_aws[0]",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 69,
            "EndLine": 99,
            "Code": {
              "Lines": [
                {
                  "Number": 69,
                  "Content": "resource \"aws_s3_bucket\" \"vault_lb_access_logs\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_s3_bucket\"\u001b[0m \u001b[38;5;37m\"vault_lb_access_logs\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 70,
                  "Content": "  count = \"${var.create \u0026\u0026 !var.lb_bucket_override ? 1 : 0}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mcount\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.create \u001b[38;5;245m\u0026\u0026\u001b[0m \u001b[38;5;245m!\u001b[0m\u001b[38;5;33mvar\u001b[0m.lb_bucket_override \u001b[38;5;245m?\u001b[0m \u001b[38;5;37m1\u001b[0m \u001b[38;5;245m:\u001b[0m \u001b[38;5;37m0\u001b[0m\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 71,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 72,
                  "Content": "  bucket = \"${random_id.vault_lb_access_logs.hex}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mbucket\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0mrandom_id.vault_lb_access_logs.hex\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 73,
                  "Content": "  acl    = \"private\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245macl\u001b[0m    = \u001b[38;5;37m\"private\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 74,
                  "Content": "  tags   = \"${merge(var.tags, map(\"Name\", format(\"%s-vault-lb-access-logs\", var.name)))}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mtags\u001b[0m   = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0mmerge(\u001b[38;5;33mvar\u001b[0m.tags,\u001b[38;5;33m map\u001b[0m(\u001b[38;5;37m\"Name\"\u001b[0m, \u001b[38;5;33mformat\u001b[0m(\u001b[38;5;37m\"%s-vault-lb-access-logs\"\u001b[0m, \u001b[38;5;33mvar\u001b[0m.name)))\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 75,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 76,
                  "Content": "  force_destroy = true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mforce_destroy\u001b[0m = \u001b[38;5;166mtrue",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 77,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 78,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "module.vault_lb_aws",
                "Filename": "github.com/hashicorp-modules/hashistack-aws/main.tf",
                "Location": {
                  "StartLine": 121,
                  "EndLine": 140
                }
              },
              {
                "Resource": "module.hashistack_aws[0]",
                "Filename": "infrastructure-as-code/hashistack/dev/terraform-aws/main.tf",
                "Location": {
                  "StartLine": 90,
                  "EndLine": 113
                }
              }
            ],
            "RenderedCause": {}
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0094",
          "AVDID": "AVD-AWS-0094",
          "Title": "S3 buckets should each define an aws_s3_bucket_public_access_block",
          "Description": "The \"block public access\" settings in S3 override individual policies that apply to a given bucket, meaning that all public access can be controlled in one central types for that bucket. It is therefore good practice to define these settings for each bucket in order to clearly define the public access that can be allowed for it.\n",
          "Message": "Bucket does not have a corresponding public access block.",
          "Namespace": "builtin.aws.s3.aws0094",
          "Query": "data.builtin.aws.s3.aws0094.deny",
          "Resolution": "Define a aws_s3_bucket_public_access_block for the given bucket to control public access policies",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0094",
          "References": [
            "https://docs.aws.amazon.com/AmazonS3/latest/userguide/access-control-block-public-access.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0094"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "module.hashistack_aws[0]",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 69,
            "EndLine": 99,
            "Code": {
              "Lines": [
                {
                  "Number": 69,
                  "Content": "resource \"aws_s3_bucket\" \"vault_lb_access_logs\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_s3_bucket\"\u001b[0m \u001b[38;5;37m\"vault_lb_access_logs\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 70,
                  "Content": "  count = \"${var.create \u0026\u0026 !var.lb_bucket_override ? 1 : 0}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mcount\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.create \u001b[38;5;245m\u0026\u0026\u001b[0m \u001b[38;5;245m!\u001b[0m\u001b[38;5;33mvar\u001b[0m.lb_bucket_override \u001b[38;5;245m?\u001b[0m \u001b[38;5;37m1\u001b[0m \u001b[38;5;245m:\u001b[0m \u001b[38;5;37m0\u001b[0m\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 71,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 72,
                  "Content": "  bucket = \"${random_id.vault_lb_access_logs.hex}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mbucket\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0mrandom_id.vault_lb_access_logs.hex\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 73,
                  "Content": "  acl    = \"private\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245macl\u001b[0m    = \u001b[38;5;37m\"private\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 74,
                  "Content": "  tags   = \"${merge(var.tags, map(\"Name\", format(\"%s-vault-lb-access-logs\", var.name)))}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mtags\u001b[0m   = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0mmerge(\u001b[38;5;33mvar\u001b[0m.tags,\u001b[38;5;33m map\u001b[0m(\u001b[38;5;37m\"Name\"\u001b[0m, \u001b[38;5;33mformat\u001b[0m(\u001b[38;5;37m\"%s-vault-lb-access-logs\"\u001b[0m, \u001b[38;5;33mvar\u001b[0m.name)))\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 75,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 76,
                  "Content": "  force_destroy = true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mforce_destroy\u001b[0m = \u001b[38;5;166mtrue",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 77,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 78,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "module.vault_lb_aws",
                "Filename": "github.com/hashicorp-modules/hashistack-aws/main.tf",
                "Location": {
                  "StartLine": 121,
                  "EndLine": 140
                }
              },
              {
                "Resource": "module.hashistack_aws[0]",
                "Filename": "infrastructure-as-code/hashistack/dev/terraform-aws/main.tf",
                "Location": {
                  "StartLine": 90,
                  "EndLine": 113
                }
              }
            ],
            "RenderedCause": {}
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "aws-vpc-no-public-egress-sgr",
          "AVDID": "AVD-AWS-0104",
          "Title": "A security group rule should not allow unrestricted egress to any IP address.",
          "Description": "Opening up ports to connect out to the public internet is generally to be avoided. You should restrict access to IP addresses or ranges that are explicitly required where possible.\n",
          "Message": "Security group rule allows unrestricted egress to any IP address.",
          "Namespace": "builtin.aws.ec2.aws0104",
          "Query": "data.builtin.aws.ec2.aws0104.deny",
          "Resolution": "Set a more restrictive cidr range",
          "Severity": "CRITICAL",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/aws-vpc-no-public-egress-sgr",
          "References": [
            "https://docs.aws.amazon.com/whitepapers/latest/building-scalable-secure-multi-vpc-network-infrastructure/centralized-egress-to-internet.html",
            "https://avd.aquasec.com/misconfig/aws-vpc-no-public-egress-sgr"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "module.hashistack_aws[0]",
            "Provider": "AWS",
            "Service": "ec2",
            "StartLine": 55,
            "EndLine": 55,
            "Code": {
              "Lines": [
                {
                  "Number": 47,
                  "Content": "resource \"aws_security_group_rule\" \"outbound_tcp\" {",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_security_group_rule\"\u001b[0m \u001b[38;5;37m\"outbound_tcp\"\u001b[0m {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 48,
                  "Content": "  count = \"${var.create ? 1 : 0}\"",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mcount\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.create \u001b[38;5;245m?\u001b[0m \u001b[38;5;37m1\u001b[0m \u001b[38;5;245m:\u001b[0m \u001b[38;5;37m0\u001b[0m\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 49,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 50,
                  "Content": "  security_group_id = \"${aws_security_group.vault_lb.id}\"",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245msecurity_group_id\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0maws_security_group.vault_lb.id\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 51,
                  "Content": "  type              = \"egress\"",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mtype\u001b[0m              = \u001b[38;5;37m\"egress\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 52,
                  "Content": "  protocol          = \"tcp\"",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mprotocol\u001b[0m          = \u001b[38;5;37m\"tcp\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 53,
                  "Content": "  from_port         = 0",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mfrom_port\u001b[0m         = \u001b[38;5;37m0",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 54,
                  "Content": "  to_port           = 65535",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mto_port\u001b[0m           = \u001b[38;5;37m65535",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 55,
                  "Content": "  cidr_blocks       = [\"0.0.0.0/0\"]",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mcidr_blocks\u001b[0m       = [\u001b[38;5;37m\"0.0.0.0/0\"\u001b[0m]",
                  "FirstCause": true,
                  "LastCause": true
                },
                {
                  "Number": 56,
                  "Content": "}",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "}",
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "aws_security_group_rule.outbound_tcp[0]",
                "Filename": "github.com/hashicorp-modules/hashistack-aws/github.com/hashicorp-modules/vault-lb-aws/main.tf",
                "Location": {
                  "StartLine": 47,
                  "EndLine": 56
                }
              },
              {
                "Resource": "module.vault_lb_aws",
                "Filename": "github.com/hashicorp-modules/hashistack-aws/main.tf",
                "Location": {
                  "StartLine": 121,
                  "EndLine": 140
                }
              },
              {
                "Resource": "module.hashistack_aws[0]",
                "Filename": "infrastructure-as-code/hashistack/dev/terraform-aws/main.tf",
                "Location": {
                  "StartLine": 90,
                  "EndLine": 113
                }
              }
            ],
            "RenderedCause": {}
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "aws-vpc-add-description-to-security-group-rule",
          "AVDID": "AVD-AWS-0124",
          "Title": "Missing description for security group rule.",
          "Description": "Security group rules should include a description for auditing purposes.\n\nSimplifies auditing, debugging, and managing security groups.\n",
          "Message": "Security group rule does not have a description.",
          "Namespace": "builtin.aws.ec2.aws0124",
          "Query": "data.builtin.aws.ec2.aws0124.deny",
          "Resolution": "Add descriptions for all security groups rules",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/aws-vpc-add-description-to-security-group-rule",
          "References": [
            "https://www.cloudconformity.com/knowledge-base/aws/EC2/security-group-rules-description.html",
            "https://avd.aquasec.com/misconfig/aws-vpc-add-description-to-security-group-rule"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "module.hashistack_aws[0]",
            "Provider": "AWS",
            "Service": "ec2",
            "StartLine": 14,
            "EndLine": 23,
            "Code": {
              "Lines": [
                {
                  "Number": 14,
                  "Content": "resource \"aws_security_group_rule\" \"vault_lb_http_80\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_security_group_rule\"\u001b[0m \u001b[38;5;37m\"vault_lb_http_80\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 15,
                  "Content": "  count = \"${var.create ? 1 : 0}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mcount\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.create \u001b[38;5;245m?\u001b[0m \u001b[38;5;37m1\u001b[0m \u001b[38;5;245m:\u001b[0m \u001b[38;5;37m0\u001b[0m\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 16,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 17,
                  "Content": "  security_group_id = \"${aws_security_group.vault_lb.id}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245msecurity_group_id\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0maws_security_group.vault_lb.id\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 18,
                  "Content": "  type              = \"ingress\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mtype\u001b[0m              = \u001b[38;5;37m\"ingress\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "  protocol          = \"tcp\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mprotocol\u001b[0m          = \u001b[38;5;37m\"tcp\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "  from_port         = 80",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mfrom_port\u001b[0m         = \u001b[38;5;37m80",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "  to_port           = 80",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mto_port\u001b[0m           = \u001b[38;5;37m80",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "  cidr_blocks       = [\"${split(\",\", var.is_internal_lb ? join(\",\", var.cidr_blocks) : \"0.0.0.0/0\")}\"]",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mcidr_blocks\u001b[0m       = [\u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33msplit\u001b[0m(\u001b[38;5;37m\",\"\u001b[0m, \u001b[38;5;33mvar\u001b[0m.is_internal_lb \u001b[38;5;245m?\u001b[0m \u001b[38;5;33mjoin\u001b[0m(\u001b[38;5;37m\",\"\u001b[0m, \u001b[38;5;33mvar\u001b[0m.cidr_blocks) \u001b[38;5;245m:\u001b[0m \u001b[38;5;37m\"0.0.0.0/0\"\u001b[0m)\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"\u001b[0m]",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "}",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "}",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "module.vault_lb_aws",
                "Filename": "github.com/hashicorp-modules/hashistack-aws/main.tf",
                "Location": {
                  "StartLine": 121,
                  "EndLine": 140
                }
              },
              {
                "Resource": "module.hashistack_aws[0]",
                "Filename": "infrastructure-as-code/hashistack/dev/terraform-aws/main.tf",
                "Location": {
                  "StartLine": 90,
                  "EndLine": 113
                }
              }
            ],
            "RenderedCause": {}
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "aws-vpc-add-description-to-security-group-rule",
          "AVDID": "AVD-AWS-0124",
          "Title": "Missing description for security group rule.",
          "Description": "Security group rules should include a description for auditing purposes.\n\nSimplifies auditing, debugging, and managing security groups.\n",
          "Message": "Security group rule does not have a description.",
          "Namespace": "builtin.aws.ec2.aws0124",
          "Query": "data.builtin.aws.ec2.aws0124.deny",
          "Resolution": "Add descriptions for all security groups rules",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/aws-vpc-add-description-to-security-group-rule",
          "References": [
            "https://www.cloudconformity.com/knowledge-base/aws/EC2/security-group-rules-description.html",
            "https://avd.aquasec.com/misconfig/aws-vpc-add-description-to-security-group-rule"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "module.hashistack_aws[0]",
            "Provider": "AWS",
            "Service": "ec2",
            "StartLine": 36,
            "EndLine": 45,
            "Code": {
              "Lines": [
                {
                  "Number": 36,
                  "Content": "resource \"aws_security_group_rule\" \"vault_lb_tcp_8200\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_security_group_rule\"\u001b[0m \u001b[38;5;37m\"vault_lb_tcp_8200\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 37,
                  "Content": "  count = \"${var.create ? 1 : 0}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mcount\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.create \u001b[38;5;245m?\u001b[0m \u001b[38;5;37m1\u001b[0m \u001b[38;5;245m:\u001b[0m \u001b[38;5;37m0\u001b[0m\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 38,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 39,
                  "Content": "  security_group_id = \"${aws_security_group.vault_lb.id}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245msecurity_group_id\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0maws_security_group.vault_lb.id\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 40,
                  "Content": "  type              = \"ingress\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mtype\u001b[0m              = \u001b[38;5;37m\"ingress\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 41,
                  "Content": "  protocol          = \"tcp\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mprotocol\u001b[0m          = \u001b[38;5;37m\"tcp\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 42,
                  "Content": "  from_port         = 8200",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mfrom_port\u001b[0m         = \u001b[38;5;37m8200",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 43,
                  "Content": "  to_port           = 8200",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mto_port\u001b[0m           = \u001b[38;5;37m8200",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 44,
                  "Content": "  cidr_blocks       = [\"${split(\",\", var.is_internal_lb ? join(\",\", var.cidr_blocks) : \"0.0.0.0/0\")}\"]",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mcidr_blocks\u001b[0m       = [\u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33msplit\u001b[0m(\u001b[38;5;37m\",\"\u001b[0m, \u001b[38;5;33mvar\u001b[0m.is_internal_lb \u001b[38;5;245m?\u001b[0m \u001b[38;5;33mjoin\u001b[0m(\u001b[38;5;37m\",\"\u001b[0m, \u001b[38;5;33mvar\u001b[0m.cidr_blocks) \u001b[38;5;245m:\u001b[0m \u001b[38;5;37m\"0.0.0.0/0\"\u001b[0m)\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"\u001b[0m]",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 45,
                  "Content": "}",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "}",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "module.vault_lb_aws",
                "Filename": "github.com/hashicorp-modules/hashistack-aws/main.tf",
                "Location": {
                  "StartLine": 121,
                  "EndLine": 140
                }
              },
              {
                "Resource": "module.hashistack_aws[0]",
                "Filename": "infrastructure-as-code/hashistack/dev/terraform-aws/main.tf",
                "Location": {
                  "StartLine": 90,
                  "EndLine": 113
                }
              }
            ],
            "RenderedCause": {}
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "aws-vpc-add-description-to-security-group-rule",
          "AVDID": "AVD-AWS-0124",
          "Title": "Missing description for security group rule.",
          "Description": "Security group rules should include a description for auditing purposes.\n\nSimplifies auditing, debugging, and managing security groups.\n",
          "Message": "Security group rule does not have a description.",
          "Namespace": "builtin.aws.ec2.aws0124",
          "Query": "data.builtin.aws.ec2.aws0124.deny",
          "Resolution": "Add descriptions for all security groups rules",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/aws-vpc-add-description-to-security-group-rule",
          "References": [
            "https://www.cloudconformity.com/knowledge-base/aws/EC2/security-group-rules-description.html",
            "https://avd.aquasec.com/misconfig/aws-vpc-add-description-to-security-group-rule"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "module.hashistack_aws[0]",
            "Provider": "AWS",
            "Service": "ec2",
            "StartLine": 47,
            "EndLine": 56,
            "Code": {
              "Lines": [
                {
                  "Number": 47,
                  "Content": "resource \"aws_security_group_rule\" \"outbound_tcp\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_security_group_rule\"\u001b[0m \u001b[38;5;37m\"outbound_tcp\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 48,
                  "Content": "  count = \"${var.create ? 1 : 0}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mcount\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.create \u001b[38;5;245m?\u001b[0m \u001b[38;5;37m1\u001b[0m \u001b[38;5;245m:\u001b[0m \u001b[38;5;37m0\u001b[0m\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 49,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 50,
                  "Content": "  security_group_id = \"${aws_security_group.vault_lb.id}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245msecurity_group_id\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0maws_security_group.vault_lb.id\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 51,
                  "Content": "  type              = \"egress\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mtype\u001b[0m              = \u001b[38;5;37m\"egress\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 52,
                  "Content": "  protocol          = \"tcp\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mprotocol\u001b[0m          = \u001b[38;5;37m\"tcp\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 53,
                  "Content": "  from_port         = 0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mfrom_port\u001b[0m         = \u001b[38;5;37m0",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 54,
                  "Content": "  to_port           = 65535",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mto_port\u001b[0m           = \u001b[38;5;37m65535",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 55,
                  "Content": "  cidr_blocks       = [\"0.0.0.0/0\"]",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mcidr_blocks\u001b[0m       = [\u001b[38;5;37m\"0.0.0.0/0\"\u001b[0m]",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 56,
                  "Content": "}",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "}",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "module.vault_lb_aws",
                "Filename": "github.com/hashicorp-modules/hashistack-aws/main.tf",
                "Location": {
                  "StartLine": 121,
                  "EndLine": 140
                }
              },
              {
                "Resource": "module.hashistack_aws[0]",
                "Filename": "infrastructure-as-code/hashistack/dev/terraform-aws/main.tf",
                "Location": {
                  "StartLine": 90,
                  "EndLine": 113
                }
              }
            ],
            "RenderedCause": {}
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0132",
          "AVDID": "AVD-AWS-0132",
          "Title": "S3 encryption should use Customer Managed Keys",
          "Description": "Encryption using AWS keys provides protection for your S3 buckets. To increase control of the encryption and manage factors like rotation use customer managed keys.\n",
          "Message": "Bucket does not encrypt data with a customer managed key.",
          "Namespace": "builtin.aws.s3.aws0132",
          "Query": "data.builtin.aws.s3.aws0132.deny",
          "Resolution": "Enable encryption using customer managed keys",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0132",
          "References": [
            "https://docs.aws.amazon.com/AmazonS3/latest/userguide/bucket-encryption.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0132"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "module.hashistack_aws[0]",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 69,
            "EndLine": 99,
            "Code": {
              "Lines": [
                {
                  "Number": 69,
                  "Content": "resource \"aws_s3_bucket\" \"vault_lb_access_logs\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_s3_bucket\"\u001b[0m \u001b[38;5;37m\"vault_lb_access_logs\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 70,
                  "Content": "  count = \"${var.create \u0026\u0026 !var.lb_bucket_override ? 1 : 0}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mcount\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.create \u001b[38;5;245m\u0026\u0026\u001b[0m \u001b[38;5;245m!\u001b[0m\u001b[38;5;33mvar\u001b[0m.lb_bucket_override \u001b[38;5;245m?\u001b[0m \u001b[38;5;37m1\u001b[0m \u001b[38;5;245m:\u001b[0m \u001b[38;5;37m0\u001b[0m\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 71,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 72,
                  "Content": "  bucket = \"${random_id.vault_lb_access_logs.hex}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mbucket\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0mrandom_id.vault_lb_access_logs.hex\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 73,
                  "Content": "  acl    = \"private\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245macl\u001b[0m    = \u001b[38;5;37m\"private\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 74,
                  "Content": "  tags   = \"${merge(var.tags, map(\"Name\", format(\"%s-vault-lb-access-logs\", var.name)))}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mtags\u001b[0m   = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0mmerge(\u001b[38;5;33mvar\u001b[0m.tags,\u001b[38;5;33m map\u001b[0m(\u001b[38;5;37m\"Name\"\u001b[0m, \u001b[38;5;33mformat\u001b[0m(\u001b[38;5;37m\"%s-vault-lb-access-logs\"\u001b[0m, \u001b[38;5;33mvar\u001b[0m.name)))\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 75,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 76,
                  "Content": "  force_destroy = true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mforce_destroy\u001b[0m = \u001b[38;5;166mtrue",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 77,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 78,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "module.vault_lb_aws",
                "Filename": "github.com/hashicorp-modules/hashistack-aws/main.tf",
                "Location": {
                  "StartLine": 121,
                  "EndLine": 140
                }
              },
              {
                "Resource": "module.hashistack_aws[0]",
                "Filename": "infrastructure-as-code/hashistack/dev/terraform-aws/main.tf",
                "Location": {
                  "StartLine": 90,
                  "EndLine": 113
                }
              }
            ],
            "RenderedCause": {}
          }
        }
      ]
    },
    {
      "Target": "github.com/hashicorp-modules/hashistack-aws/github.com/hashicorp-modules/vault-server-ports-aws/main.tf",
      "Class": "config",
      "Type": "terraform",
      "MisconfSummary": {
        "Successes": 0,
        "Failures": 4
      },
      "Misconfigurations": [
        {
          "Type": "Terraform Security Check",
          "ID": "aws-vpc-no-public-egress-sgr",
          "AVDID": "AVD-AWS-0104",
          "Title": "A security group rule should not allow unrestricted egress to any IP address.",
          "Description": "Opening up ports to connect out to the public internet is generally to be avoided. You should restrict access to IP addresses or ranges that are explicitly required where possible.\n",
          "Message": "Security group rule allows unrestricted egress to any IP address.",
          "Namespace": "builtin.aws.ec2.aws0104",
          "Query": "data.builtin.aws.ec2.aws0104.deny",
          "Resolution": "Set a more restrictive cidr range",
          "Severity": "CRITICAL",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/aws-vpc-no-public-egress-sgr",
          "References": [
            "https://docs.aws.amazon.com/whitepapers/latest/building-scalable-secure-multi-vpc-network-infrastructure/centralized-egress-to-internet.html",
            "https://avd.aquasec.com/misconfig/aws-vpc-no-public-egress-sgr"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "module.hashistack_aws[0]",
            "Provider": "AWS",
            "Service": "ec2",
            "StartLine": 47,
            "EndLine": 47,
            "Code": {
              "Lines": [
                {
                  "Number": 39,
                  "Content": "resource \"aws_security_group_rule\" \"outbound_tcp\" {",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_security_group_rule\"\u001b[0m \u001b[38;5;37m\"outbound_tcp\"\u001b[0m {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 40,
                  "Content": "  count = \"${var.create ? 1 : 0}\"",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mcount\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.create \u001b[38;5;245m?\u001b[0m \u001b[38;5;37m1\u001b[0m \u001b[38;5;245m:\u001b[0m \u001b[38;5;37m0\u001b[0m\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 41,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 42,
                  "Content": "  security_group_id = \"${aws_security_group.vault_server.id}\"",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245msecurity_group_id\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0maws_security_group.vault_server.id\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 43,
                  "Content": "  type              = \"egress\"",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mtype\u001b[0m              = \u001b[38;5;37m\"egress\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 44,
                  "Content": "  protocol          = \"tcp\"",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mprotocol\u001b[0m          = \u001b[38;5;37m\"tcp\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 45,
                  "Content": "  from_port         = 0",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mfrom_port\u001b[0m         = \u001b[38;5;37m0",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 46,
                  "Content": "  to_port           = 65535",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mto_port\u001b[0m           = \u001b[38;5;37m65535",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 47,
                  "Content": "  cidr_blocks       = [\"0.0.0.0/0\"]",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mcidr_blocks\u001b[0m       = [\u001b[38;5;37m\"0.0.0.0/0\"\u001b[0m]",
                  "FirstCause": true,
                  "LastCause": true
                },
                {
                  "Number": 48,
                  "Content": "}",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "}",
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "aws_security_group_rule.outbound_tcp[0]",
                "Filename": "github.com/hashicorp-modules/hashistack-aws/github.com/hashicorp-modules/vault-server-ports-aws/main.tf",
                "Location": {
                  "StartLine": 39,
                  "EndLine": 48
                }
              },
              {
                "Resource": "module.vault_server_sg",
                "Filename": "github.com/hashicorp-modules/hashistack-aws/main.tf",
                "Location": {
                  "StartLine": 48,
                  "EndLine": 55
                }
              },
              {
                "Resource": "module.hashistack_aws[0]",
                "Filename": "infrastructure-as-code/hashistack/dev/terraform-aws/main.tf",
                "Location": {
                  "StartLine": 90,
                  "EndLine": 113
                }
              }
            ],
            "RenderedCause": {}
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "aws-vpc-add-description-to-security-group-rule",
          "AVDID": "AVD-AWS-0124",
          "Title": "Missing description for security group rule.",
          "Description": "Security group rules should include a description for auditing purposes.\n\nSimplifies auditing, debugging, and managing security groups.\n",
          "Message": "Security group rule does not have a description.",
          "Namespace": "builtin.aws.ec2.aws0124",
          "Query": "data.builtin.aws.ec2.aws0124.deny",
          "Resolution": "Add descriptions for all security groups rules",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/aws-vpc-add-description-to-security-group-rule",
          "References": [
            "https://www.cloudconformity.com/knowledge-base/aws/EC2/security-group-rules-description.html",
            "https://avd.aquasec.com/misconfig/aws-vpc-add-description-to-security-group-rule"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "module.hashistack_aws[0]",
            "Provider": "AWS",
            "Service": "ec2",
            "StartLine": 39,
            "EndLine": 48,
            "Code": {
              "Lines": [
                {
                  "Number": 39,
                  "Content": "resource \"aws_security_group_rule\" \"outbound_tcp\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_security_group_rule\"\u001b[0m \u001b[38;5;37m\"outbound_tcp\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 40,
                  "Content": "  count = \"${var.create ? 1 : 0}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mcount\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.create \u001b[38;5;245m?\u001b[0m \u001b[38;5;37m1\u001b[0m \u001b[38;5;245m:\u001b[0m \u001b[38;5;37m0\u001b[0m\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 41,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 42,
                  "Content": "  security_group_id = \"${aws_security_group.vault_server.id}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245msecurity_group_id\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0maws_security_group.vault_server.id\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 43,
                  "Content": "  type              = \"egress\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mtype\u001b[0m              = \u001b[38;5;37m\"egress\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 44,
                  "Content": "  protocol          = \"tcp\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mprotocol\u001b[0m          = \u001b[38;5;37m\"tcp\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 45,
                  "Content": "  from_port         = 0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mfrom_port\u001b[0m         = \u001b[38;5;37m0",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 46,
                  "Content": "  to_port           = 65535",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mto_port\u001b[0m           = \u001b[38;5;37m65535",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 47,
                  "Content": "  cidr_blocks       = [\"0.0.0.0/0\"]",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mcidr_blocks\u001b[0m       = [\u001b[38;5;37m\"0.0.0.0/0\"\u001b[0m]",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 48,
                  "Content": "}",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "}",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "module.vault_server_sg",
                "Filename": "github.com/hashicorp-modules/hashistack-aws/main.tf",
                "Location": {
                  "StartLine": 48,
                  "EndLine": 55
                }
              },
              {
                "Resource": "module.hashistack_aws[0]",
                "Filename": "infrastructure-as-code/hashistack/dev/terraform-aws/main.tf",
                "Location": {
                  "StartLine": 90,
                  "EndLine": 113
                }
              }
            ],
            "RenderedCause": {}
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "aws-vpc-add-description-to-security-group-rule",
          "AVDID": "AVD-AWS-0124",
          "Title": "Missing description for security group rule.",
          "Description": "Security group rules should include a description for auditing purposes.\n\nSimplifies auditing, debugging, and managing security groups.\n",
          "Message": "Security group rule does not have a description.",
          "Namespace": "builtin.aws.ec2.aws0124",
          "Query": "data.builtin.aws.ec2.aws0124.deny",
          "Resolution": "Add descriptions for all security groups rules",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/aws-vpc-add-description-to-security-group-rule",
          "References": [
            "https://www.cloudconformity.com/knowledge-base/aws/EC2/security-group-rules-description.html",
            "https://avd.aquasec.com/misconfig/aws-vpc-add-description-to-security-group-rule"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "module.hashistack_aws[0]",
            "Provider": "AWS",
            "Service": "ec2",
            "StartLine": 27,
            "EndLine": 36,
            "Code": {
              "Lines": [
                {
                  "Number": 27,
                  "Content": "resource \"aws_security_group_rule\" \"vault_cluster_traffic\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_security_group_rule\"\u001b[0m \u001b[38;5;37m\"vault_cluster_traffic\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 28,
                  "Content": "  count = \"${var.create ? 1 : 0}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mcount\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.create \u001b[38;5;245m?\u001b[0m \u001b[38;5;37m1\u001b[0m \u001b[38;5;245m:\u001b[0m \u001b[38;5;37m0\u001b[0m\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 29,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 30,
                  "Content": "  security_group_id = \"${aws_security_group.vault_server.id}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245msecurity_group_id\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0maws_security_group.vault_server.id\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 31,
                  "Content": "  type              = \"ingress\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mtype\u001b[0m              = \u001b[38;5;37m\"ingress\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 32,
                  "Content": "  protocol          = \"tcp\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mprotocol\u001b[0m          = \u001b[38;5;37m\"tcp\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 33,
                  "Content": "  from_port         = 8201",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mfrom_port\u001b[0m         = \u001b[38;5;37m8201",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 34,
                  "Content": "  to_port           = 8201",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mto_port\u001b[0m           = \u001b[38;5;37m8201",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 35,
                  "Content": "  cidr_blocks       = [\"${var.cidr_blocks}\"]",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mcidr_blocks\u001b[0m       = [\u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.cidr_blocks\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"\u001b[0m]",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 36,
                  "Content": "}",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "}",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "module.vault_server_sg",
                "Filename": "github.com/hashicorp-modules/hashistack-aws/main.tf",
                "Location": {
                  "StartLine": 48,
                  "EndLine": 55
                }
              },
              {
                "Resource": "module.hashistack_aws[0]",
                "Filename": "infrastructure-as-code/hashistack/dev/terraform-aws/main.tf",
                "Location": {
                  "StartLine": 90,
                  "EndLine": 113
                }
              }
            ],
            "RenderedCause": {}
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "aws-vpc-add-description-to-security-group-rule",
          "AVDID": "AVD-AWS-0124",
          "Title": "Missing description for security group rule.",
          "Description": "Security group rules should include a description for auditing purposes.\n\nSimplifies auditing, debugging, and managing security groups.\n",
          "Message": "Security group rule does not have a description.",
          "Namespace": "builtin.aws.ec2.aws0124",
          "Query": "data.builtin.aws.ec2.aws0124.deny",
          "Resolution": "Add descriptions for all security groups rules",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/aws-vpc-add-description-to-security-group-rule",
          "References": [
            "https://www.cloudconformity.com/knowledge-base/aws/EC2/security-group-rules-description.html",
            "https://avd.aquasec.com/misconfig/aws-vpc-add-description-to-security-group-rule"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "module.hashistack_aws[0]",
            "Provider": "AWS",
            "Service": "ec2",
            "StartLine": 15,
            "EndLine": 24,
            "Code": {
              "Lines": [
                {
                  "Number": 15,
                  "Content": "resource \"aws_security_group_rule\" \"vault_client_traffic\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_security_group_rule\"\u001b[0m \u001b[38;5;37m\"vault_client_traffic\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 16,
                  "Content": "  count = \"${var.create ? 1 : 0}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mcount\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.create \u001b[38;5;245m?\u001b[0m \u001b[38;5;37m1\u001b[0m \u001b[38;5;245m:\u001b[0m \u001b[38;5;37m0\u001b[0m\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 17,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 18,
                  "Content": "  security_group_id = \"${aws_security_group.vault_server.id}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245msecurity_group_id\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0maws_security_group.vault_server.id\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "  type              = \"ingress\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mtype\u001b[0m              = \u001b[38;5;37m\"ingress\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "  protocol          = \"tcp\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mprotocol\u001b[0m          = \u001b[38;5;37m\"tcp\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "  from_port         = 8200",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mfrom_port\u001b[0m         = \u001b[38;5;37m8200",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "  to_port           = 8200",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mto_port\u001b[0m           = \u001b[38;5;37m8200",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "  cidr_blocks       = [\"${var.cidr_blocks}\"]",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mcidr_blocks\u001b[0m       = [\u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.cidr_blocks\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"\u001b[0m]",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 24,
                  "Content": "}",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "}",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "module.vault_server_sg",
                "Filename": "github.com/hashicorp-modules/hashistack-aws/main.tf",
                "Location": {
                  "StartLine": 48,
                  "EndLine": 55
                }
              },
              {
                "Resource": "module.hashistack_aws[0]",
                "Filename": "infrastructure-as-code/hashistack/dev/terraform-aws/main.tf",
                "Location": {
                  "StartLine": 90,
                  "EndLine": 113
                }
              }
            ],
            "RenderedCause": {}
          }
        }
      ]
    },
    {
      "Target": "github.com/hashicorp-modules/hashistack-aws/main.tf",
      "Class": "config",
      "Type": "terraform",
      "MisconfSummary": {
        "Successes": 0,
        "Failures": 5
      },
      "Misconfigurations": [
        {
          "Type": "Terraform Security Check",
          "ID": "aws-autoscaling-enable-at-rest-encryption",
          "AVDID": "AVD-AWS-0008",
          "Title": "Launch configuration with unencrypted block device.",
          "Description": "Block devices should be encrypted to ensure sensitive data is held securely at rest.\n",
          "Message": "Root block device is not encrypted.",
          "Namespace": "builtin.aws.ec2.aws0008",
          "Query": "data.builtin.aws.ec2.aws0008.deny",
          "Resolution": "Turn on encryption for all block devices",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/aws-autoscaling-enable-at-rest-encryption",
          "References": [
            "https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/RootDeviceStorage.html",
            "https://avd.aquasec.com/misconfig/aws-autoscaling-enable-at-rest-encryption"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "module.hashistack_aws[0]",
            "Provider": "AWS",
            "Service": "ec2",
            "StartLine": 77,
            "EndLine": 98,
            "Code": {
              "Lines": [
                {
                  "Number": 77,
                  "Content": "resource \"aws_launch_configuration\" \"hashistack\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_launch_configuration\"\u001b[0m \u001b[38;5;37m\"hashistack\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 78,
                  "Content": "  count = \"${var.create ? 1 : 0}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mcount\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.create \u001b[38;5;245m?\u001b[0m \u001b[38;5;37m1\u001b[0m \u001b[38;5;245m:\u001b[0m \u001b[38;5;37m0\u001b[0m\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 79,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 80,
                  "Content": "  name_prefix                 = \"${format(\"%s-hashistack-\", var.name)}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mname_prefix\u001b[0m                 = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mformat\u001b[0m(\u001b[38;5;37m\"%s-hashistack-\"\u001b[0m, \u001b[38;5;33mvar\u001b[0m.name)\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 81,
                  "Content": "  associate_public_ip_address = \"${var.public}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245massociate_public_ip_address\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.public\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 82,
                  "Content": "  ebs_optimized               = false",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mebs_optimized\u001b[0m               = \u001b[38;5;166mfalse",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 83,
                  "Content": "  instance_type               = \"${var.instance_type}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245minstance_type\u001b[0m               = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.instance_type\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 84,
                  "Content": "  image_id                    = \"${var.image_id != \"\" ? var.image_id : element(concat(data.aws_ami.hashistack.*.id, list(\"\")), 0)}\" # TODO: Workaround for issue #11210",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mimage_id\u001b[0m                    = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.image_id \u001b[38;5;245m!=\u001b[0m \u001b[38;5;37m\"\"\u001b[0m \u001b[38;5;245m?\u001b[0m \u001b[38;5;33mvar\u001b[0m.image_id \u001b[38;5;245m:\u001b[0m\u001b[38;5;33m element\u001b[0m(concat(\u001b[38;5;33mdata\u001b[0m.aws_ami.hashistack.\u001b[38;5;245m*\u001b[0m.id,\u001b[38;5;33m list\u001b[0m(\u001b[38;5;37m\"\"\u001b[0m)), \u001b[38;5;37m0\u001b[0m)\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"\u001b[0m\u001b[38;5;239m # TODO: Workaround for issue #11210",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 85,
                  "Content": "  iam_instance_profile        = \"${var.instance_profile != \"\" ? var.instance_profile : module.consul_auto_join_instance_role.instance_profile_id}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245miam_instance_profile\u001b[0m        = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.instance_profile \u001b[38;5;245m!=\u001b[0m \u001b[38;5;37m\"\"\u001b[0m \u001b[38;5;245m?\u001b[0m \u001b[38;5;33mvar\u001b[0m.instance_profile \u001b[38;5;245m:\u001b[0m \u001b[38;5;33mmodule\u001b[0m.consul_auto_join_instance_role.instance_profile_id\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 86,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "module.hashistack_aws[0]",
                "Filename": "infrastructure-as-code/hashistack/dev/terraform-aws/main.tf",
                "Location": {
                  "StartLine": 90,
                  "EndLine": 113
                }
              }
            ],
            "RenderedCause": {}
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0009",
          "AVDID": "AVD-AWS-0009",
          "Title": "Launch configuration should not have a public IP address.",
          "Description": "You should limit the provision of public IP addresses for resources. Resources should not be exposed on the public internet, but should have access limited to consumers required for the function of your application.\n",
          "Message": "Launch configuration associates public IP address.",
          "Namespace": "builtin.aws.ec2.aws0009",
          "Query": "data.builtin.aws.ec2.aws0009.deny",
          "Resolution": "Set the instance to not be publicly accessible",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0009",
          "References": [
            "https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/using-instance-addressing.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0009"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "module.hashistack_aws[0]",
            "Provider": "AWS",
            "Service": "ec2",
            "StartLine": 81,
            "EndLine": 81,
            "Code": {
              "Lines": [
                {
                  "Number": 77,
                  "Content": "resource \"aws_launch_configuration\" \"hashistack\" {",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_launch_configuration\"\u001b[0m \u001b[38;5;37m\"hashistack\"\u001b[0m {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 78,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 81,
                  "Content": "  associate_public_ip_address = \"${var.public}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245massociate_public_ip_address\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.public\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": true,
                  "LastCause": true
                },
                {
                  "Number": 97,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 98,
                  "Content": "}",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "}",
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "aws_launch_configuration.hashistack[0]",
                "Filename": "github.com/hashicorp-modules/hashistack-aws/main.tf",
                "Location": {
                  "StartLine": 77,
                  "EndLine": 98
                }
              },
              {
                "Resource": "module.hashistack_aws[0]",
                "Filename": "infrastructure-as-code/hashistack/dev/terraform-aws/main.tf",
                "Location": {
                  "StartLine": 90,
                  "EndLine": 113
                }
              }
            ],
            "RenderedCause": {
              "Raw": "resource \"aws_launch_configuration\" \"hashistack\" {\n  associate_public_ip_address = true\n}",
              "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_launch_configuration\"\u001b[0m \u001b[38;5;37m\"hashistack\"\u001b[0m {\n  \u001b[38;5;245massociate_public_ip_address\u001b[0m = \u001b[38;5;166mtrue\n\u001b[0m}"
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0107",
          "AVDID": "AVD-AWS-0107",
          "Title": "Security groups should not allow unrestricted ingress to SSH or RDP from any IP address.",
          "Description": "Security groups provide stateful filtering of ingress and egress network traffic to AWS\nresources. It is recommended that no security group allows unrestricted ingress access to\nremote server administration ports, such as SSH to port 22 and RDP to port 3389.\n",
          "Message": "Security group rule allows unrestricted ingress from any IP address.",
          "Namespace": "builtin.aws.ec2.aws0107",
          "Query": "data.builtin.aws.ec2.aws0107.deny",
          "Resolution": "Set a more restrictive CIDR range",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0107",
          "References": [
            "https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/security-group-rules-reference.html",
            "https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html#ec2-13",
            "https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html#ec2-14",
            "https://avd.aquasec.com/misconfig/avd-aws-0107"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "module.hashistack_aws[0]",
            "Provider": "AWS",
            "Service": "ec2",
            "StartLine": 74,
            "EndLine": 74,
            "Code": {
              "Lines": [
                {
                  "Number": 66,
                  "Content": "resource \"aws_security_group_rule\" \"ssh\" {",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_security_group_rule\"\u001b[0m \u001b[38;5;37m\"ssh\"\u001b[0m {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 67,
                  "Content": "  count = \"${var.create ? 1 : 0}\"",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mcount\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.create \u001b[38;5;245m?\u001b[0m \u001b[38;5;37m1\u001b[0m \u001b[38;5;245m:\u001b[0m \u001b[38;5;37m0\u001b[0m\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 68,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 69,
                  "Content": "  security_group_id = \"${module.vault_server_sg.vault_server_sg_id}\"",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245msecurity_group_id\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mmodule\u001b[0m.vault_server_sg.vault_server_sg_id\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 70,
                  "Content": "  type              = \"ingress\"",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mtype\u001b[0m              = \u001b[38;5;37m\"ingress\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 71,
                  "Content": "  protocol          = \"tcp\"",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mprotocol\u001b[0m          = \u001b[38;5;37m\"tcp\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 72,
                  "Content": "  from_port         = 22",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mfrom_port\u001b[0m         = \u001b[38;5;37m22",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 73,
                  "Content": "  to_port           = 22",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mto_port\u001b[0m           = \u001b[38;5;37m22",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 74,
                  "Content": "  cidr_blocks       = [\"${var.public ? \"0.0.0.0/0\" : var.vpc_cidr}\"] # If there's a public IP, open port 22 for public access - DO NOT DO THIS IN PROD",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mcidr_blocks\u001b[0m       = [\u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.public \u001b[38;5;245m?\u001b[0m \u001b[38;5;37m\"0.0.0.0/0\"\u001b[0m \u001b[38;5;245m:\u001b[0m \u001b[38;5;33mvar\u001b[0m.vpc_cidr\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"\u001b[0m]\u001b[38;5;239m # If there's a public IP, open port 22 for public access - DO NOT DO THIS IN PROD",
                  "FirstCause": true,
                  "LastCause": true
                },
                {
                  "Number": 75,
                  "Content": "}",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m}",
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "aws_security_group_rule.ssh[0]",
                "Filename": "github.com/hashicorp-modules/hashistack-aws/main.tf",
                "Location": {
                  "StartLine": 66,
                  "EndLine": 75
                }
              },
              {
                "Resource": "module.hashistack_aws[0]",
                "Filename": "infrastructure-as-code/hashistack/dev/terraform-aws/main.tf",
                "Location": {
                  "StartLine": 90,
                  "EndLine": 113
                }
              }
            ],
            "RenderedCause": {
              "Raw": "resource \"aws_security_group_rule\" \"ssh\" {\n  cidr_blocks = [\"0.0.0.0/0\"]\n}",
              "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_security_group_rule\"\u001b[0m \u001b[38;5;37m\"ssh\"\u001b[0m {\n  \u001b[38;5;245mcidr_blocks\u001b[0m = [\u001b[38;5;37m\"0.0.0.0/0\"\u001b[0m]\n}"
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "aws-vpc-add-description-to-security-group-rule",
          "AVDID": "AVD-AWS-0124",
          "Title": "Missing description for security group rule.",
          "Description": "Security group rules should include a description for auditing purposes.\n\nSimplifies auditing, debugging, and managing security groups.\n",
          "Message": "Security group rule does not have a description.",
          "Namespace": "builtin.aws.ec2.aws0124",
          "Query": "data.builtin.aws.ec2.aws0124.deny",
          "Resolution": "Add descriptions for all security groups rules",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/aws-vpc-add-description-to-security-group-rule",
          "References": [
            "https://www.cloudconformity.com/knowledge-base/aws/EC2/security-group-rules-description.html",
            "https://avd.aquasec.com/misconfig/aws-vpc-add-description-to-security-group-rule"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "module.hashistack_aws[0]",
            "Provider": "AWS",
            "Service": "ec2",
            "StartLine": 66,
            "EndLine": 75,
            "Code": {
              "Lines": [
                {
                  "Number": 66,
                  "Content": "resource \"aws_security_group_rule\" \"ssh\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_security_group_rule\"\u001b[0m \u001b[38;5;37m\"ssh\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 67,
                  "Content": "  count = \"${var.create ? 1 : 0}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mcount\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.create \u001b[38;5;245m?\u001b[0m \u001b[38;5;37m1\u001b[0m \u001b[38;5;245m:\u001b[0m \u001b[38;5;37m0\u001b[0m\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 68,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 69,
                  "Content": "  security_group_id = \"${module.vault_server_sg.vault_server_sg_id}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245msecurity_group_id\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mmodule\u001b[0m.vault_server_sg.vault_server_sg_id\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 70,
                  "Content": "  type              = \"ingress\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mtype\u001b[0m              = \u001b[38;5;37m\"ingress\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 71,
                  "Content": "  protocol          = \"tcp\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mprotocol\u001b[0m          = \u001b[38;5;37m\"tcp\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 72,
                  "Content": "  from_port         = 22",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mfrom_port\u001b[0m         = \u001b[38;5;37m22",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 73,
                  "Content": "  to_port           = 22",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mto_port\u001b[0m           = \u001b[38;5;37m22",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 74,
                  "Content": "  cidr_blocks       = [\"${var.public ? \"0.0.0.0/0\" : var.vpc_cidr}\"] # If there's a public IP, open port 22 for public access - DO NOT DO THIS IN PROD",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mcidr_blocks\u001b[0m       = [\u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.public \u001b[38;5;245m?\u001b[0m \u001b[38;5;37m\"0.0.0.0/0\"\u001b[0m \u001b[38;5;245m:\u001b[0m \u001b[38;5;33mvar\u001b[0m.vpc_cidr\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"\u001b[0m]\u001b[38;5;239m # If there's a public IP, open port 22 for public access - DO NOT DO THIS IN PROD",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 75,
                  "Content": "}",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m}",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "module.hashistack_aws[0]",
                "Filename": "infrastructure-as-code/hashistack/dev/terraform-aws/main.tf",
                "Location": {
                  "StartLine": 90,
                  "EndLine": 113
                }
              }
            ],
            "RenderedCause": {}
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "aws-autoscaling-enforce-http-token-imds",
          "AVDID": "AVD-AWS-0130",
          "Title": "aws_instance should activate session tokens for Instance Metadata Service.",
          "Description": "IMDS v2 (Instance Metadata Service) introduced session authentication tokens which improve security when talking to IMDS.\n\nBy default \u003ccode\u003eaws_instance\u003c/code\u003e resource sets IMDS session auth tokens to be optional.\n\nTo fully protect IMDS you need to enable session tokens by using \u003ccode\u003emetadata_options\u003c/code\u003e block and its \u003ccode\u003ehttp_tokens\u003c/code\u003e variable set to \u003ccode\u003erequired\u003c/code\u003e.\n",
          "Message": "Launch configuration does not require IMDS access to require a token",
          "Namespace": "builtin.aws.ec2.aws0130",
          "Query": "data.builtin.aws.ec2.aws0130.deny",
          "Resolution": "Enable HTTP token requirement for IMDS",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/aws-autoscaling-enforce-http-token-imds",
          "References": [
            "https://aws.amazon.com/blogs/security/defense-in-depth-open-firewalls-reverse-proxies-ssrf-vulnerabilities-ec2-instance-metadata-service",
            "https://avd.aquasec.com/misconfig/aws-autoscaling-enforce-http-token-imds"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "module.hashistack_aws[0]",
            "Provider": "AWS",
            "Service": "ec2",
            "StartLine": 77,
            "EndLine": 98,
            "Code": {
              "Lines": [
                {
                  "Number": 77,
                  "Content": "resource \"aws_launch_configuration\" \"hashistack\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_launch_configuration\"\u001b[0m \u001b[38;5;37m\"hashistack\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 78,
                  "Content": "  count = \"${var.create ? 1 : 0}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mcount\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.create \u001b[38;5;245m?\u001b[0m \u001b[38;5;37m1\u001b[0m \u001b[38;5;245m:\u001b[0m \u001b[38;5;37m0\u001b[0m\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 79,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 80,
                  "Content": "  name_prefix                 = \"${format(\"%s-hashistack-\", var.name)}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mname_prefix\u001b[0m                 = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mformat\u001b[0m(\u001b[38;5;37m\"%s-hashistack-\"\u001b[0m, \u001b[38;5;33mvar\u001b[0m.name)\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 81,
                  "Content": "  associate_public_ip_address = \"${var.public}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245massociate_public_ip_address\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.public\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 82,
                  "Content": "  ebs_optimized               = false",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mebs_optimized\u001b[0m               = \u001b[38;5;166mfalse",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 83,
                  "Content": "  instance_type               = \"${var.instance_type}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245minstance_type\u001b[0m               = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.instance_type\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 84,
                  "Content": "  image_id                    = \"${var.image_id != \"\" ? var.image_id : element(concat(data.aws_ami.hashistack.*.id, list(\"\")), 0)}\" # TODO: Workaround for issue #11210",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mimage_id\u001b[0m                    = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.image_id \u001b[38;5;245m!=\u001b[0m \u001b[38;5;37m\"\"\u001b[0m \u001b[38;5;245m?\u001b[0m \u001b[38;5;33mvar\u001b[0m.image_id \u001b[38;5;245m:\u001b[0m\u001b[38;5;33m element\u001b[0m(concat(\u001b[38;5;33mdata\u001b[0m.aws_ami.hashistack.\u001b[38;5;245m*\u001b[0m.id,\u001b[38;5;33m list\u001b[0m(\u001b[38;5;37m\"\"\u001b[0m)), \u001b[38;5;37m0\u001b[0m)\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"\u001b[0m\u001b[38;5;239m # TODO: Workaround for issue #11210",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 85,
                  "Content": "  iam_instance_profile        = \"${var.instance_profile != \"\" ? var.instance_profile : module.consul_auto_join_instance_role.instance_profile_id}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245miam_instance_profile\u001b[0m        = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.instance_profile \u001b[38;5;245m!=\u001b[0m \u001b[38;5;37m\"\"\u001b[0m \u001b[38;5;245m?\u001b[0m \u001b[38;5;33mvar\u001b[0m.instance_profile \u001b[38;5;245m:\u001b[0m \u001b[38;5;33mmodule\u001b[0m.consul_auto_join_instance_role.instance_profile_id\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 86,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "module.hashistack_aws[0]",
                "Filename": "infrastructure-as-code/hashistack/dev/terraform-aws/main.tf",
                "Location": {
                  "StartLine": 90,
                  "EndLine": 113
                }
              }
            ],
            "RenderedCause": {}
          }
        }
      ]
    },
    {
      "Target": "governance/first-generation/external",
      "Class": "config",
      "Type": "terraform",
      "MisconfSummary": {
        "Successes": 37,
        "Failures": 0
      }
    },
    {
      "Target": "infrastructure-as-code/aws-ec2-instance",
      "Class": "config",
      "Type": "terraform",
      "MisconfSummary": {
        "Successes": 54,
        "Failures": 0
      }
    },
    {
      "Target": "infrastructure-as-code/aws-ec2-instance/main.tf",
      "Class": "config",
      "Type": "terraform",
      "MisconfSummary": {
        "Successes": 0,
        "Failures": 2
      },
      "Misconfigurations": [
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0028",
          "AVDID": "AVD-AWS-0028",
          "Title": "aws_instance should activate session tokens for Instance Metadata Service.",
          "Description": "IMDS v2 (Instance Metadata Service) introduced session authentication tokens which improve security when talking to IMDS.\n\nBy default \u003ccode\u003eaws_instance\u003c/code\u003e resource sets IMDS session auth tokens to be optional.\n\nTo fully protect IMDS you need to enable session tokens by using \u003ccode\u003emetadata_options\u003c/code\u003e block and its \u003ccode\u003ehttp_tokens\u003c/code\u003e variable set to \u003ccode\u003erequired\u003c/code\u003e.\n",
          "Message": "Instance does not require IMDS access to require a token.",
          "Namespace": "builtin.aws.ec2.aws0028",
          "Query": "data.builtin.aws.ec2.aws0028.deny",
          "Resolution": "Enable HTTP token requirement for IMDS",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0028",
          "References": [
            "https://aws.amazon.com/blogs/security/defense-in-depth-open-firewalls-reverse-proxies-ssrf-vulnerabilities-ec2-instance-metadata-service",
            "https://avd.aquasec.com/misconfig/avd-aws-0028"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "aws_instance.ubuntu",
            "Provider": "AWS",
            "Service": "ec2",
            "StartLine": 9,
            "EndLine": 17,
            "Code": {
              "Lines": [
                {
                  "Number": 9,
                  "Content": "resource \"aws_instance\" \"ubuntu\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_instance\"\u001b[0m \u001b[38;5;37m\"ubuntu\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 10,
                  "Content": "  ami           = \"${var.ami_id}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mami\u001b[0m           = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.ami_id\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 11,
                  "Content": "  instance_type = \"${var.instance_type}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245minstance_type\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.instance_type\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 12,
                  "Content": "  availability_zone = \"${var.aws_region}a\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mavailability_zone\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.aws_region\u001b[38;5;37m}\u001b[0m\u001b[38;5;37ma\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 13,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 14,
                  "Content": "  tags {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  tags {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 15,
                  "Content": "    Name = \"${var.name}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;245mName\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.name\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 16,
                  "Content": "  }",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  }",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 17,
                  "Content": "}",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "}",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0131",
          "AVDID": "AVD-AWS-0131",
          "Title": "Instance with unencrypted block device.",
          "Description": "Block devices should be encrypted to ensure sensitive data is held securely at rest.\n",
          "Message": "Root block device is not encrypted.",
          "Namespace": "builtin.aws.ec2.aws0131",
          "Query": "data.builtin.aws.ec2.aws0131.deny",
          "Resolution": "Turn on encryption for all block devices",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0131",
          "References": [
            "https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/RootDeviceStorage.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0131"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "aws_instance.ubuntu",
            "Provider": "AWS",
            "Service": "ec2",
            "StartLine": 9,
            "EndLine": 17,
            "Code": {
              "Lines": [
                {
                  "Number": 9,
                  "Content": "resource \"aws_instance\" \"ubuntu\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_instance\"\u001b[0m \u001b[38;5;37m\"ubuntu\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 10,
                  "Content": "  ami           = \"${var.ami_id}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mami\u001b[0m           = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.ami_id\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 11,
                  "Content": "  instance_type = \"${var.instance_type}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245minstance_type\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.instance_type\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 12,
                  "Content": "  availability_zone = \"${var.aws_region}a\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mavailability_zone\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.aws_region\u001b[38;5;37m}\u001b[0m\u001b[38;5;37ma\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 13,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 14,
                  "Content": "  tags {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  tags {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 15,
                  "Content": "    Name = \"${var.name}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;245mName\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.name\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 16,
                  "Content": "  }",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  }",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 17,
                  "Content": "}",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "}",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            },
            "RenderedCause": {}
          }
        }
      ]
    },
    {
      "Target": "infrastructure-as-code/aws-lambda-ec2-lifecycles",
      "Class": "config",
      "Type": "terraform",
      "MisconfSummary": {
        "Successes": 38,
        "Failures": 0
      }
    },
    {
      "Target": "infrastructure-as-code/aws-lambda-ec2-lifecycles/asg_data_collectors.tf",
      "Class": "config",
      "Type": "terraform",
      "MisconfSummary": {
        "Successes": 0,
        "Failures": 2
      },
      "Misconfigurations": [
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0066",
          "AVDID": "AVD-AWS-0066",
          "Title": "Lambda functions should have X-Ray tracing enabled",
          "Description": "X-Ray tracing enables end-to-end debugging and analysis of all function activity. This will allow for identifying bottlenecks, slow downs and timeouts.\n",
          "Message": "Function does not have tracing enabled.",
          "Namespace": "builtin.aws.lambda.aws0066",
          "Query": "data.builtin.aws.lambda.aws0066.deny",
          "Resolution": "Enable tracing",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0066",
          "References": [
            "https://docs.aws.amazon.com/lambda/latest/dg/services-xray.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0066"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "aws_lambda_function.getTaggedASGs",
            "Provider": "AWS",
            "Service": "lambda",
            "StartLine": 22,
            "EndLine": 37,
            "Code": {
              "Lines": [
                {
                  "Number": 22,
                  "Content": "resource \"aws_lambda_function\" \"getTaggedASGs\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_lambda_function\"\u001b[0m \u001b[38;5;37m\"getTaggedASGs\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "  filename         = \"./files/getTaggedASGs.zip\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mfilename\u001b[0m         = \u001b[38;5;37m\"./files/getTaggedASGs.zip\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 24,
                  "Content": "  function_name    = \"getTaggedASGs\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mfunction_name\u001b[0m    = \u001b[38;5;37m\"getTaggedASGs\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 25,
                  "Content": "  role             = \"${aws_iam_role.lambda_read_instances.arn}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mrole\u001b[0m             = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0maws_iam_role.lambda_read_instances.arn\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 26,
                  "Content": "  handler          = \"getTaggedASGs.lambda_handler\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mhandler\u001b[0m          = \u001b[38;5;37m\"getTaggedASGs.lambda_handler\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 27,
                  "Content": "  source_code_hash = \"${base64sha256(file(\"./files/getTaggedASGs.zip\"))}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245msource_code_hash\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mbase64sha256\u001b[0m(\u001b[38;5;33mfile\u001b[0m(\u001b[38;5;37m\"./files/getTaggedASGs.zip\"\u001b[0m))\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 28,
                  "Content": "  runtime          = \"python3.6\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mruntime\u001b[0m          = \u001b[38;5;37m\"python3.6\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 29,
                  "Content": "  timeout          = \"120\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mtimeout\u001b[0m          = \u001b[38;5;37m\"120\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 30,
                  "Content": "  description      = \"Gathers a list of correctly tagged instances.\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mdescription\u001b[0m      = \u001b[38;5;37m\"Gathers a list of correctly tagged instances.\"",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 31,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0066",
          "AVDID": "AVD-AWS-0066",
          "Title": "Lambda functions should have X-Ray tracing enabled",
          "Description": "X-Ray tracing enables end-to-end debugging and analysis of all function activity. This will allow for identifying bottlenecks, slow downs and timeouts.\n",
          "Message": "Function does not have tracing enabled.",
          "Namespace": "builtin.aws.lambda.aws0066",
          "Query": "data.builtin.aws.lambda.aws0066.deny",
          "Resolution": "Enable tracing",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0066",
          "References": [
            "https://docs.aws.amazon.com/lambda/latest/dg/services-xray.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0066"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "aws_lambda_function.getUntaggedASGs",
            "Provider": "AWS",
            "Service": "lambda",
            "StartLine": 5,
            "EndLine": 20,
            "Code": {
              "Lines": [
                {
                  "Number": 5,
                  "Content": "resource \"aws_lambda_function\" \"getUntaggedASGs\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_lambda_function\"\u001b[0m \u001b[38;5;37m\"getUntaggedASGs\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 6,
                  "Content": "  filename         = \"./files/getUntaggedASGs.zip\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mfilename\u001b[0m         = \u001b[38;5;37m\"./files/getUntaggedASGs.zip\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 7,
                  "Content": "  function_name    = \"getUntaggedASGs\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mfunction_name\u001b[0m    = \u001b[38;5;37m\"getUntaggedASGs\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 8,
                  "Content": "  role             = \"${aws_iam_role.lambda_read_instances.arn}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mrole\u001b[0m             = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0maws_iam_role.lambda_read_instances.arn\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 9,
                  "Content": "  handler          = \"getUntaggedASGs.lambda_handler\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mhandler\u001b[0m          = \u001b[38;5;37m\"getUntaggedASGs.lambda_handler\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 10,
                  "Content": "  source_code_hash = \"${base64sha256(file(\"./files/getUntaggedASGs.zip\"))}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245msource_code_hash\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mbase64sha256\u001b[0m(\u001b[38;5;33mfile\u001b[0m(\u001b[38;5;37m\"./files/getUntaggedASGs.zip\"\u001b[0m))\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 11,
                  "Content": "  runtime          = \"python3.6\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mruntime\u001b[0m          = \u001b[38;5;37m\"python3.6\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 12,
                  "Content": "  timeout          = \"120\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mtimeout\u001b[0m          = \u001b[38;5;37m\"120\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 13,
                  "Content": "  description      = \"Gathers a list of untagged or improperly tagged instances.\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mdescription\u001b[0m      = \u001b[38;5;37m\"Gathers a list of untagged or improperly tagged instances.\"",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 14,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "RenderedCause": {}
          }
        }
      ]
    },
    {
      "Target": "infrastructure-as-code/aws-lambda-ec2-lifecycles/asg_reaper.tf",
      "Class": "config",
      "Type": "terraform",
      "MisconfSummary": {
        "Successes": 0,
        "Failures": 1
      },
      "Misconfigurations": [
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0066",
          "AVDID": "AVD-AWS-0066",
          "Title": "Lambda functions should have X-Ray tracing enabled",
          "Description": "X-Ray tracing enables end-to-end debugging and analysis of all function activity. This will allow for identifying bottlenecks, slow downs and timeouts.\n",
          "Message": "Function does not have tracing enabled.",
          "Namespace": "builtin.aws.lambda.aws0066",
          "Query": "data.builtin.aws.lambda.aws0066.deny",
          "Resolution": "Enable tracing",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0066",
          "References": [
            "https://docs.aws.amazon.com/lambda/latest/dg/services-xray.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0066"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "aws_lambda_function.ASGReaper",
            "Provider": "AWS",
            "Service": "lambda",
            "StartLine": 2,
            "EndLine": 18,
            "Code": {
              "Lines": [
                {
                  "Number": 2,
                  "Content": "resource \"aws_lambda_function\" \"ASGReaper\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_lambda_function\"\u001b[0m \u001b[38;5;37m\"ASGReaper\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 3,
                  "Content": "  filename         = \"./files/ASGReaper.zip\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mfilename\u001b[0m         = \u001b[38;5;37m\"./files/ASGReaper.zip\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 4,
                  "Content": "  function_name    = \"ASGReaper\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mfunction_name\u001b[0m    = \u001b[38;5;37m\"ASGReaper\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 5,
                  "Content": "  role             = \"${aws_iam_role.lambda_terminate_asgs.arn}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mrole\u001b[0m             = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0maws_iam_role.lambda_terminate_asgs.arn\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 6,
                  "Content": "  handler          = \"ASGReaper.lambda_handler\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mhandler\u001b[0m          = \u001b[38;5;37m\"ASGReaper.lambda_handler\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 7,
                  "Content": "  source_code_hash = \"${base64sha256(file(\"./files/ASGReaper.zip\"))}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245msource_code_hash\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mbase64sha256\u001b[0m(\u001b[38;5;33mfile\u001b[0m(\u001b[38;5;37m\"./files/ASGReaper.zip\"\u001b[0m))\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 8,
                  "Content": "  runtime          = \"python3.6\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mruntime\u001b[0m          = \u001b[38;5;37m\"python3.6\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 9,
                  "Content": "  timeout          = \"120\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mtimeout\u001b[0m          = \u001b[38;5;37m\"120\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 10,
                  "Content": "  description      = \"Checks ASG TTLs for expiration and deals with them accordingly.\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mdescription\u001b[0m      = \u001b[38;5;37m\"Checks ASG TTLs for expiration and deals with them accordingly.\"",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 11,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "RenderedCause": {}
          }
        }
      ]
    },
    {
      "Target": "infrastructure-as-code/aws-lambda-ec2-lifecycles/asg_untagged_janitor.tf",
      "Class": "config",
      "Type": "terraform",
      "MisconfSummary": {
        "Successes": 0,
        "Failures": 1
      },
      "Misconfigurations": [
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0066",
          "AVDID": "AVD-AWS-0066",
          "Title": "Lambda functions should have X-Ray tracing enabled",
          "Description": "X-Ray tracing enables end-to-end debugging and analysis of all function activity. This will allow for identifying bottlenecks, slow downs and timeouts.\n",
          "Message": "Function does not have tracing enabled.",
          "Namespace": "builtin.aws.lambda.aws0066",
          "Query": "data.builtin.aws.lambda.aws0066.deny",
          "Resolution": "Enable tracing",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0066",
          "References": [
            "https://docs.aws.amazon.com/lambda/latest/dg/services-xray.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0066"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "aws_lambda_function.ASGJanitor",
            "Provider": "AWS",
            "Service": "lambda",
            "StartLine": 2,
            "EndLine": 19,
            "Code": {
              "Lines": [
                {
                  "Number": 2,
                  "Content": "resource \"aws_lambda_function\" \"ASGJanitor\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_lambda_function\"\u001b[0m \u001b[38;5;37m\"ASGJanitor\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 3,
                  "Content": "  filename         = \"./files/ASGJanitor.zip\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mfilename\u001b[0m         = \u001b[38;5;37m\"./files/ASGJanitor.zip\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 4,
                  "Content": "  function_name    = \"ASGJanitor\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mfunction_name\u001b[0m    = \u001b[38;5;37m\"ASGJanitor\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 5,
                  "Content": "  role             = \"${aws_iam_role.lambda_terminate_asgs.arn}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mrole\u001b[0m             = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0maws_iam_role.lambda_terminate_asgs.arn\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 6,
                  "Content": "  handler          = \"ASGJanitor.lambda_handler\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mhandler\u001b[0m          = \u001b[38;5;37m\"ASGJanitor.lambda_handler\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 7,
                  "Content": "  source_code_hash = \"${base64sha256(file(\"./files/ASGJanitor.zip\"))}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245msource_code_hash\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mbase64sha256\u001b[0m(\u001b[38;5;33mfile\u001b[0m(\u001b[38;5;37m\"./files/ASGJanitor.zip\"\u001b[0m))\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 8,
                  "Content": "  runtime          = \"python3.6\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mruntime\u001b[0m          = \u001b[38;5;37m\"python3.6\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 9,
                  "Content": "  timeout          = \"120\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mtimeout\u001b[0m          = \u001b[38;5;37m\"120\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 10,
                  "Content": "  description      = \"Terminates untagged ASGs after a pre-set number of days.\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mdescription\u001b[0m      = \u001b[38;5;37m\"Terminates untagged ASGs after a pre-set number of days.\"",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 11,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "RenderedCause": {}
          }
        }
      ]
    },
    {
      "Target": "infrastructure-as-code/aws-lambda-ec2-lifecycles/ec2_data_collectors.tf",
      "Class": "config",
      "Type": "terraform",
      "MisconfSummary": {
        "Successes": 0,
        "Failures": 3
      },
      "Misconfigurations": [
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0066",
          "AVDID": "AVD-AWS-0066",
          "Title": "Lambda functions should have X-Ray tracing enabled",
          "Description": "X-Ray tracing enables end-to-end debugging and analysis of all function activity. This will allow for identifying bottlenecks, slow downs and timeouts.\n",
          "Message": "Function does not have tracing enabled.",
          "Namespace": "builtin.aws.lambda.aws0066",
          "Query": "data.builtin.aws.lambda.aws0066.deny",
          "Resolution": "Enable tracing",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0066",
          "References": [
            "https://docs.aws.amazon.com/lambda/latest/dg/services-xray.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0066"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "aws_lambda_function.getRunningInstances",
            "Provider": "AWS",
            "Service": "lambda",
            "StartLine": 39,
            "EndLine": 48,
            "Code": {
              "Lines": [
                {
                  "Number": 39,
                  "Content": "resource \"aws_lambda_function\" \"getRunningInstances\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_lambda_function\"\u001b[0m \u001b[38;5;37m\"getRunningInstances\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 40,
                  "Content": "  filename         = \"./files/getRunningInstances.zip\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mfilename\u001b[0m         = \u001b[38;5;37m\"./files/getRunningInstances.zip\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 41,
                  "Content": "  function_name    = \"getRunningInstances\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mfunction_name\u001b[0m    = \u001b[38;5;37m\"getRunningInstances\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 42,
                  "Content": "  role             = \"${aws_iam_role.lambda_read_instances.arn}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mrole\u001b[0m             = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0maws_iam_role.lambda_read_instances.arn\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 43,
                  "Content": "  handler          = \"getRunningInstances.lambda_handler\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mhandler\u001b[0m          = \u001b[38;5;37m\"getRunningInstances.lambda_handler\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 44,
                  "Content": "  source_code_hash = \"${base64sha256(file(\"./files/getRunningInstances.zip\"))}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245msource_code_hash\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mbase64sha256\u001b[0m(\u001b[38;5;33mfile\u001b[0m(\u001b[38;5;37m\"./files/getRunningInstances.zip\"\u001b[0m))\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 45,
                  "Content": "  runtime          = \"python3.6\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mruntime\u001b[0m          = \u001b[38;5;37m\"python3.6\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 46,
                  "Content": "  timeout          = \"120\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mtimeout\u001b[0m          = \u001b[38;5;37m\"120\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 47,
                  "Content": "  description      = \"Gathers a list of running instances.\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mdescription\u001b[0m      = \u001b[38;5;37m\"Gathers a list of running instances.\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 48,
                  "Content": "}",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m}",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0066",
          "AVDID": "AVD-AWS-0066",
          "Title": "Lambda functions should have X-Ray tracing enabled",
          "Description": "X-Ray tracing enables end-to-end debugging and analysis of all function activity. This will allow for identifying bottlenecks, slow downs and timeouts.\n",
          "Message": "Function does not have tracing enabled.",
          "Namespace": "builtin.aws.lambda.aws0066",
          "Query": "data.builtin.aws.lambda.aws0066.deny",
          "Resolution": "Enable tracing",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0066",
          "References": [
            "https://docs.aws.amazon.com/lambda/latest/dg/services-xray.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0066"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "aws_lambda_function.getTaggedInstances",
            "Provider": "AWS",
            "Service": "lambda",
            "StartLine": 22,
            "EndLine": 37,
            "Code": {
              "Lines": [
                {
                  "Number": 22,
                  "Content": "resource \"aws_lambda_function\" \"getTaggedInstances\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_lambda_function\"\u001b[0m \u001b[38;5;37m\"getTaggedInstances\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "  filename         = \"./files/getTaggedInstances.zip\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mfilename\u001b[0m         = \u001b[38;5;37m\"./files/getTaggedInstances.zip\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 24,
                  "Content": "  function_name    = \"getTaggedInstances\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mfunction_name\u001b[0m    = \u001b[38;5;37m\"getTaggedInstances\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 25,
                  "Content": "  role             = \"${aws_iam_role.lambda_read_instances.arn}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mrole\u001b[0m             = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0maws_iam_role.lambda_read_instances.arn\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 26,
                  "Content": "  handler          = \"getTaggedInstances.lambda_handler\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mhandler\u001b[0m          = \u001b[38;5;37m\"getTaggedInstances.lambda_handler\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 27,
                  "Content": "  source_code_hash = \"${base64sha256(file(\"./files/getTaggedInstances.zip\"))}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245msource_code_hash\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mbase64sha256\u001b[0m(\u001b[38;5;33mfile\u001b[0m(\u001b[38;5;37m\"./files/getTaggedInstances.zip\"\u001b[0m))\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 28,
                  "Content": "  runtime          = \"python3.6\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mruntime\u001b[0m          = \u001b[38;5;37m\"python3.6\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 29,
                  "Content": "  timeout          = \"120\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mtimeout\u001b[0m          = \u001b[38;5;37m\"120\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 30,
                  "Content": "  description      = \"Gathers a list of correctly tagged instances.\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mdescription\u001b[0m      = \u001b[38;5;37m\"Gathers a list of correctly tagged instances.\"",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 31,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0066",
          "AVDID": "AVD-AWS-0066",
          "Title": "Lambda functions should have X-Ray tracing enabled",
          "Description": "X-Ray tracing enables end-to-end debugging and analysis of all function activity. This will allow for identifying bottlenecks, slow downs and timeouts.\n",
          "Message": "Function does not have tracing enabled.",
          "Namespace": "builtin.aws.lambda.aws0066",
          "Query": "data.builtin.aws.lambda.aws0066.deny",
          "Resolution": "Enable tracing",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0066",
          "References": [
            "https://docs.aws.amazon.com/lambda/latest/dg/services-xray.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0066"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "aws_lambda_function.getUntaggedInstances",
            "Provider": "AWS",
            "Service": "lambda",
            "StartLine": 5,
            "EndLine": 20,
            "Code": {
              "Lines": [
                {
                  "Number": 5,
                  "Content": "resource \"aws_lambda_function\" \"getUntaggedInstances\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_lambda_function\"\u001b[0m \u001b[38;5;37m\"getUntaggedInstances\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 6,
                  "Content": "  filename         = \"./files/getUntaggedInstances.zip\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mfilename\u001b[0m         = \u001b[38;5;37m\"./files/getUntaggedInstances.zip\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 7,
                  "Content": "  function_name    = \"getUntaggedInstances\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mfunction_name\u001b[0m    = \u001b[38;5;37m\"getUntaggedInstances\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 8,
                  "Content": "  role             = \"${aws_iam_role.lambda_read_instances.arn}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mrole\u001b[0m             = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0maws_iam_role.lambda_read_instances.arn\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 9,
                  "Content": "  handler          = \"getUntaggedInstances.lambda_handler\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mhandler\u001b[0m          = \u001b[38;5;37m\"getUntaggedInstances.lambda_handler\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 10,
                  "Content": "  source_code_hash = \"${base64sha256(file(\"./files/getUntaggedInstances.zip\"))}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245msource_code_hash\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mbase64sha256\u001b[0m(\u001b[38;5;33mfile\u001b[0m(\u001b[38;5;37m\"./files/getUntaggedInstances.zip\"\u001b[0m))\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 11,
                  "Content": "  runtime          = \"python3.6\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mruntime\u001b[0m          = \u001b[38;5;37m\"python3.6\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 12,
                  "Content": "  timeout          = \"120\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mtimeout\u001b[0m          = \u001b[38;5;37m\"120\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 13,
                  "Content": "  description      = \"Gathers a list of untagged or improperly tagged instances.\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mdescription\u001b[0m      = \u001b[38;5;37m\"Gathers a list of untagged or improperly tagged instances.\"",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 14,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "RenderedCause": {}
          }
        }
      ]
    },
    {
      "Target": "infrastructure-as-code/aws-lambda-ec2-lifecycles/ec2_reaper.tf",
      "Class": "config",
      "Type": "terraform",
      "MisconfSummary": {
        "Successes": 0,
        "Failures": 1
      },
      "Misconfigurations": [
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0066",
          "AVDID": "AVD-AWS-0066",
          "Title": "Lambda functions should have X-Ray tracing enabled",
          "Description": "X-Ray tracing enables end-to-end debugging and analysis of all function activity. This will allow for identifying bottlenecks, slow downs and timeouts.\n",
          "Message": "Function does not have tracing enabled.",
          "Namespace": "builtin.aws.lambda.aws0066",
          "Query": "data.builtin.aws.lambda.aws0066.deny",
          "Resolution": "Enable tracing",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0066",
          "References": [
            "https://docs.aws.amazon.com/lambda/latest/dg/services-xray.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0066"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "aws_lambda_function.EC2Reaper",
            "Provider": "AWS",
            "Service": "lambda",
            "StartLine": 2,
            "EndLine": 18,
            "Code": {
              "Lines": [
                {
                  "Number": 2,
                  "Content": "resource \"aws_lambda_function\" \"EC2Reaper\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_lambda_function\"\u001b[0m \u001b[38;5;37m\"EC2Reaper\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 3,
                  "Content": "  filename         = \"./files/EC2Reaper.zip\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mfilename\u001b[0m         = \u001b[38;5;37m\"./files/EC2Reaper.zip\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 4,
                  "Content": "  function_name    = \"EC2Reaper\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mfunction_name\u001b[0m    = \u001b[38;5;37m\"EC2Reaper\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 5,
                  "Content": "  role             = \"${aws_iam_role.lambda_stop_and_terminate_instances.arn}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mrole\u001b[0m             = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0maws_iam_role.lambda_stop_and_terminate_instances.arn\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 6,
                  "Content": "  handler          = \"EC2Reaper.lambda_handler\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mhandler\u001b[0m          = \u001b[38;5;37m\"EC2Reaper.lambda_handler\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 7,
                  "Content": "  source_code_hash = \"${base64sha256(file(\"./files/EC2Reaper.zip\"))}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245msource_code_hash\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mbase64sha256\u001b[0m(\u001b[38;5;33mfile\u001b[0m(\u001b[38;5;37m\"./files/EC2Reaper.zip\"\u001b[0m))\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 8,
                  "Content": "  runtime          = \"python3.6\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mruntime\u001b[0m          = \u001b[38;5;37m\"python3.6\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 9,
                  "Content": "  timeout          = \"120\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mtimeout\u001b[0m          = \u001b[38;5;37m\"120\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 10,
                  "Content": "  description      = \"Checks instance TTLs for expiration and deals with them accordingly.\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mdescription\u001b[0m      = \u001b[38;5;37m\"Checks instance TTLs for expiration and deals with them accordingly.\"",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 11,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "RenderedCause": {}
          }
        }
      ]
    },
    {
      "Target": "infrastructure-as-code/aws-lambda-ec2-lifecycles/ec2_untagged_janitor.tf",
      "Class": "config",
      "Type": "terraform",
      "MisconfSummary": {
        "Successes": 0,
        "Failures": 1
      },
      "Misconfigurations": [
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0066",
          "AVDID": "AVD-AWS-0066",
          "Title": "Lambda functions should have X-Ray tracing enabled",
          "Description": "X-Ray tracing enables end-to-end debugging and analysis of all function activity. This will allow for identifying bottlenecks, slow downs and timeouts.\n",
          "Message": "Function does not have tracing enabled.",
          "Namespace": "builtin.aws.lambda.aws0066",
          "Query": "data.builtin.aws.lambda.aws0066.deny",
          "Resolution": "Enable tracing",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0066",
          "References": [
            "https://docs.aws.amazon.com/lambda/latest/dg/services-xray.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0066"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "aws_lambda_function.EC2Janitor",
            "Provider": "AWS",
            "Service": "lambda",
            "StartLine": 3,
            "EndLine": 21,
            "Code": {
              "Lines": [
                {
                  "Number": 3,
                  "Content": "resource \"aws_lambda_function\" \"EC2Janitor\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_lambda_function\"\u001b[0m \u001b[38;5;37m\"EC2Janitor\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 4,
                  "Content": "  filename         = \"./files/EC2Janitor.zip\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mfilename\u001b[0m         = \u001b[38;5;37m\"./files/EC2Janitor.zip\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 5,
                  "Content": "  function_name    = \"EC2Janitor\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mfunction_name\u001b[0m    = \u001b[38;5;37m\"EC2Janitor\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 6,
                  "Content": "  role             = \"${aws_iam_role.lambda_stop_and_terminate_instances.arn}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mrole\u001b[0m             = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0maws_iam_role.lambda_stop_and_terminate_instances.arn\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 7,
                  "Content": "  handler          = \"EC2Janitor.lambda_handler\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mhandler\u001b[0m          = \u001b[38;5;37m\"EC2Janitor.lambda_handler\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 8,
                  "Content": "  source_code_hash = \"${base64sha256(file(\"./files/EC2Janitor.zip\"))}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245msource_code_hash\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mbase64sha256\u001b[0m(\u001b[38;5;33mfile\u001b[0m(\u001b[38;5;37m\"./files/EC2Janitor.zip\"\u001b[0m))\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 9,
                  "Content": "  runtime          = \"python3.6\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mruntime\u001b[0m          = \u001b[38;5;37m\"python3.6\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 10,
                  "Content": "  timeout          = \"120\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mtimeout\u001b[0m          = \u001b[38;5;37m\"120\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 11,
                  "Content": "  description      = \"Stops or terminates untagged instances after a pre-set number of days.\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mdescription\u001b[0m      = \u001b[38;5;37m\"Stops or terminates untagged instances after a pre-set number of days.\"",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 12,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "RenderedCause": {}
          }
        }
      ]
    },
    {
      "Target": "infrastructure-as-code/aws-lambda-ec2-lifecycles/notify_instance_usage.tf",
      "Class": "config",
      "Type": "terraform",
      "MisconfSummary": {
        "Successes": 0,
        "Failures": 1
      },
      "Misconfigurations": [
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0066",
          "AVDID": "AVD-AWS-0066",
          "Title": "Lambda functions should have X-Ray tracing enabled",
          "Description": "X-Ray tracing enables end-to-end debugging and analysis of all function activity. This will allow for identifying bottlenecks, slow downs and timeouts.\n",
          "Message": "Function does not have tracing enabled.",
          "Namespace": "builtin.aws.lambda.aws0066",
          "Query": "data.builtin.aws.lambda.aws0066.deny",
          "Resolution": "Enable tracing",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0066",
          "References": [
            "https://docs.aws.amazon.com/lambda/latest/dg/services-xray.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0066"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "aws_lambda_function.notifyInstanceUsage",
            "Provider": "AWS",
            "Service": "lambda",
            "StartLine": 2,
            "EndLine": 18,
            "Code": {
              "Lines": [
                {
                  "Number": 2,
                  "Content": "resource \"aws_lambda_function\" \"notifyInstanceUsage\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_lambda_function\"\u001b[0m \u001b[38;5;37m\"notifyInstanceUsage\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 3,
                  "Content": "  filename         = \"./files/notifyInstanceUsage.zip\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mfilename\u001b[0m         = \u001b[38;5;37m\"./files/notifyInstanceUsage.zip\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 4,
                  "Content": "  function_name    = \"notifyInstanceUsage\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mfunction_name\u001b[0m    = \u001b[38;5;37m\"notifyInstanceUsage\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 5,
                  "Content": "  role             = \"${aws_iam_role.lambda_notify.arn}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mrole\u001b[0m             = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0maws_iam_role.lambda_notify.arn\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 6,
                  "Content": "  handler          = \"notifyInstanceUsage.lambda_handler\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mhandler\u001b[0m          = \u001b[38;5;37m\"notifyInstanceUsage.lambda_handler\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 7,
                  "Content": "  source_code_hash = \"${base64sha256(file(\"./files/notifyInstanceUsage.zip\"))}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245msource_code_hash\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mbase64sha256\u001b[0m(\u001b[38;5;33mfile\u001b[0m(\u001b[38;5;37m\"./files/notifyInstanceUsage.zip\"\u001b[0m))\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 8,
                  "Content": "  runtime          = \"python3.6\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mruntime\u001b[0m          = \u001b[38;5;37m\"python3.6\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 9,
                  "Content": "  timeout          = \"120\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mtimeout\u001b[0m          = \u001b[38;5;37m\"120\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 10,
                  "Content": "  description      = \"Sends a notification message with info about number of running instances by type.\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mdescription\u001b[0m      = \u001b[38;5;37m\"Sends a notification message with info about number of running instances by type.\"",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 11,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "RenderedCause": {}
          }
        }
      ]
    },
    {
      "Target": "infrastructure-as-code/aws-lambda-ec2-lifecycles/notify_untagged.tf",
      "Class": "config",
      "Type": "terraform",
      "MisconfSummary": {
        "Successes": 0,
        "Failures": 1
      },
      "Misconfigurations": [
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0066",
          "AVDID": "AVD-AWS-0066",
          "Title": "Lambda functions should have X-Ray tracing enabled",
          "Description": "X-Ray tracing enables end-to-end debugging and analysis of all function activity. This will allow for identifying bottlenecks, slow downs and timeouts.\n",
          "Message": "Function does not have tracing enabled.",
          "Namespace": "builtin.aws.lambda.aws0066",
          "Query": "data.builtin.aws.lambda.aws0066.deny",
          "Resolution": "Enable tracing",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0066",
          "References": [
            "https://docs.aws.amazon.com/lambda/latest/dg/services-xray.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0066"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "aws_lambda_function.notifyUntaggedInstances",
            "Provider": "AWS",
            "Service": "lambda",
            "StartLine": 2,
            "EndLine": 18,
            "Code": {
              "Lines": [
                {
                  "Number": 2,
                  "Content": "resource \"aws_lambda_function\" \"notifyUntaggedInstances\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_lambda_function\"\u001b[0m \u001b[38;5;37m\"notifyUntaggedInstances\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 3,
                  "Content": "  filename         = \"./files/notifyUntaggedInstances.zip\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mfilename\u001b[0m         = \u001b[38;5;37m\"./files/notifyUntaggedInstances.zip\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 4,
                  "Content": "  function_name    = \"notifyUntaggedInstances\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mfunction_name\u001b[0m    = \u001b[38;5;37m\"notifyUntaggedInstances\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 5,
                  "Content": "  role             = \"${aws_iam_role.lambda_notify.arn}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mrole\u001b[0m             = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0maws_iam_role.lambda_notify.arn\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 6,
                  "Content": "  handler          = \"notifyUntaggedInstances.lambda_handler\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mhandler\u001b[0m          = \u001b[38;5;37m\"notifyUntaggedInstances.lambda_handler\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 7,
                  "Content": "  source_code_hash = \"${base64sha256(file(\"./files/notifyUntaggedInstances.zip\"))}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245msource_code_hash\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mbase64sha256\u001b[0m(\u001b[38;5;33mfile\u001b[0m(\u001b[38;5;37m\"./files/notifyUntaggedInstances.zip\"\u001b[0m))\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 8,
                  "Content": "  runtime          = \"python3.6\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mruntime\u001b[0m          = \u001b[38;5;37m\"python3.6\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 9,
                  "Content": "  timeout          = \"120\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mtimeout\u001b[0m          = \u001b[38;5;37m\"120\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 10,
                  "Content": "  description      = \"Sends a notification message with info about untagged instances.\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mdescription\u001b[0m      = \u001b[38;5;37m\"Sends a notification message with info about untagged instances.\"",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 11,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "RenderedCause": {}
          }
        }
      ]
    },
    {
      "Target": "infrastructure-as-code/azure-vm",
      "Class": "config",
      "Type": "terraform",
      "MisconfSummary": {
        "Successes": 42,
        "Failures": 0
      }
    },
    {
      "Target": "infrastructure-as-code/dynamic-aws-creds-from-vault",
      "Class": "config",
      "Type": "terraform",
      "MisconfSummary": {
        "Successes": 51,
        "Failures": 0
      }
    },
    {
      "Target": "infrastructure-as-code/dynamic-aws-creds-from-vault/networks-firewalls-ingress.tf",
      "Class": "config",
      "Type": "terraform",
      "MisconfSummary": {
        "Successes": 0,
        "Failures": 2
      },
      "Misconfigurations": [
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0107",
          "AVDID": "AVD-AWS-0107",
          "Title": "Security groups should not allow unrestricted ingress to SSH or RDP from any IP address.",
          "Description": "Security groups provide stateful filtering of ingress and egress network traffic to AWS\nresources. It is recommended that no security group allows unrestricted ingress access to\nremote server administration ports, such as SSH to port 22 and RDP to port 3389.\n",
          "Message": "Security group rule allows unrestricted ingress from any IP address.",
          "Namespace": "builtin.aws.ec2.aws0107",
          "Query": "data.builtin.aws.ec2.aws0107.deny",
          "Resolution": "Set a more restrictive CIDR range",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0107",
          "References": [
            "https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/security-group-rules-reference.html",
            "https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html#ec2-13",
            "https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html#ec2-14",
            "https://avd.aquasec.com/misconfig/avd-aws-0107"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "aws_security_group_rule.ssh",
            "Provider": "AWS",
            "Service": "ec2",
            "StartLine": 7,
            "EndLine": 7,
            "Code": {
              "Lines": [
                {
                  "Number": 1,
                  "Content": "resource \"aws_security_group_rule\" \"ssh\" {",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_security_group_rule\"\u001b[0m \u001b[38;5;37m\"ssh\"\u001b[0m {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 2,
                  "Content": "  security_group_id = \"${aws_security_group.egress_public.id}\"",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245msecurity_group_id\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0maws_security_group.egress_public.id\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 3,
                  "Content": "  type              = \"ingress\"",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mtype\u001b[0m              = \u001b[38;5;37m\"ingress\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 4,
                  "Content": "  protocol          = \"tcp\"",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mprotocol\u001b[0m          = \u001b[38;5;37m\"tcp\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 5,
                  "Content": "  from_port         = 22",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mfrom_port\u001b[0m         = \u001b[38;5;37m22",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 6,
                  "Content": "  to_port           = 22",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mto_port\u001b[0m           = \u001b[38;5;37m22",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 7,
                  "Content": "  cidr_blocks       = [\"0.0.0.0/0\"]",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mcidr_blocks\u001b[0m       = [\u001b[38;5;37m\"0.0.0.0/0\"\u001b[0m]",
                  "FirstCause": true,
                  "LastCause": true
                },
                {
                  "Number": 8,
                  "Content": "}",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "}",
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "aws_security_group_rule.ssh",
                "Filename": "infrastructure-as-code/dynamic-aws-creds-from-vault/networks-firewalls-ingress.tf",
                "Location": {
                  "StartLine": 1,
                  "EndLine": 8
                }
              }
            ],
            "RenderedCause": {}
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "aws-vpc-add-description-to-security-group-rule",
          "AVDID": "AVD-AWS-0124",
          "Title": "Missing description for security group rule.",
          "Description": "Security group rules should include a description for auditing purposes.\n\nSimplifies auditing, debugging, and managing security groups.\n",
          "Message": "Security group rule does not have a description.",
          "Namespace": "builtin.aws.ec2.aws0124",
          "Query": "data.builtin.aws.ec2.aws0124.deny",
          "Resolution": "Add descriptions for all security groups rules",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/aws-vpc-add-description-to-security-group-rule",
          "References": [
            "https://www.cloudconformity.com/knowledge-base/aws/EC2/security-group-rules-description.html",
            "https://avd.aquasec.com/misconfig/aws-vpc-add-description-to-security-group-rule"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "aws_security_group_rule.ssh",
            "Provider": "AWS",
            "Service": "ec2",
            "StartLine": 1,
            "EndLine": 8,
            "Code": {
              "Lines": [
                {
                  "Number": 1,
                  "Content": "resource \"aws_security_group_rule\" \"ssh\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_security_group_rule\"\u001b[0m \u001b[38;5;37m\"ssh\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 2,
                  "Content": "  security_group_id = \"${aws_security_group.egress_public.id}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245msecurity_group_id\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0maws_security_group.egress_public.id\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 3,
                  "Content": "  type              = \"ingress\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mtype\u001b[0m              = \u001b[38;5;37m\"ingress\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 4,
                  "Content": "  protocol          = \"tcp\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mprotocol\u001b[0m          = \u001b[38;5;37m\"tcp\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 5,
                  "Content": "  from_port         = 22",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mfrom_port\u001b[0m         = \u001b[38;5;37m22",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 6,
                  "Content": "  to_port           = 22",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mto_port\u001b[0m           = \u001b[38;5;37m22",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 7,
                  "Content": "  cidr_blocks       = [\"0.0.0.0/0\"]",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mcidr_blocks\u001b[0m       = [\u001b[38;5;37m\"0.0.0.0/0\"\u001b[0m]",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 8,
                  "Content": "}",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "}",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            },
            "RenderedCause": {}
          }
        }
      ]
    },
    {
      "Target": "infrastructure-as-code/dynamic-aws-creds-from-vault/networks-firewalls.tf",
      "Class": "config",
      "Type": "terraform",
      "MisconfSummary": {
        "Successes": 0,
        "Failures": 3
      },
      "Misconfigurations": [
        {
          "Type": "Terraform Security Check",
          "ID": "aws-vpc-no-public-egress-sgr",
          "AVDID": "AVD-AWS-0104",
          "Title": "A security group rule should not allow unrestricted egress to any IP address.",
          "Description": "Opening up ports to connect out to the public internet is generally to be avoided. You should restrict access to IP addresses or ranges that are explicitly required where possible.\n",
          "Message": "Security group rule allows unrestricted egress to any IP address.",
          "Namespace": "builtin.aws.ec2.aws0104",
          "Query": "data.builtin.aws.ec2.aws0104.deny",
          "Resolution": "Set a more restrictive cidr range",
          "Severity": "CRITICAL",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/aws-vpc-no-public-egress-sgr",
          "References": [
            "https://docs.aws.amazon.com/whitepapers/latest/building-scalable-secure-multi-vpc-network-infrastructure/centralized-egress-to-internet.html",
            "https://avd.aquasec.com/misconfig/aws-vpc-no-public-egress-sgr"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "aws_security_group_rule.egress_public",
            "Provider": "AWS",
            "Service": "ec2",
            "StartLine": 13,
            "EndLine": 13,
            "Code": {
              "Lines": [
                {
                  "Number": 7,
                  "Content": "resource \"aws_security_group_rule\" \"egress_public\" {",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_security_group_rule\"\u001b[0m \u001b[38;5;37m\"egress_public\"\u001b[0m {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 8,
                  "Content": "  security_group_id = \"${aws_security_group.egress_public.id}\"",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245msecurity_group_id\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0maws_security_group.egress_public.id\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 9,
                  "Content": "  type              = \"egress\"",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mtype\u001b[0m              = \u001b[38;5;37m\"egress\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 10,
                  "Content": "  protocol          = \"-1\"",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mprotocol\u001b[0m          = \u001b[38;5;37m\"-1\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 11,
                  "Content": "  from_port         = 0",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mfrom_port\u001b[0m         = \u001b[38;5;37m0",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 12,
                  "Content": "  to_port           = 0",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mto_port\u001b[0m           = \u001b[38;5;37m0",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 13,
                  "Content": "  cidr_blocks       = [\"0.0.0.0/0\"]",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mcidr_blocks\u001b[0m       = [\u001b[38;5;37m\"0.0.0.0/0\"\u001b[0m]",
                  "FirstCause": true,
                  "LastCause": true
                },
                {
                  "Number": 14,
                  "Content": "}",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "}",
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "aws_security_group_rule.egress_public",
                "Filename": "infrastructure-as-code/dynamic-aws-creds-from-vault/networks-firewalls.tf",
                "Location": {
                  "StartLine": 7,
                  "EndLine": 14
                }
              }
            ],
            "RenderedCause": {}
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "aws-vpc-add-description-to-security-group-rule",
          "AVDID": "AVD-AWS-0124",
          "Title": "Missing description for security group rule.",
          "Description": "Security group rules should include a description for auditing purposes.\n\nSimplifies auditing, debugging, and managing security groups.\n",
          "Message": "Security group rule does not have a description.",
          "Namespace": "builtin.aws.ec2.aws0124",
          "Query": "data.builtin.aws.ec2.aws0124.deny",
          "Resolution": "Add descriptions for all security groups rules",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/aws-vpc-add-description-to-security-group-rule",
          "References": [
            "https://www.cloudconformity.com/knowledge-base/aws/EC2/security-group-rules-description.html",
            "https://avd.aquasec.com/misconfig/aws-vpc-add-description-to-security-group-rule"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "aws_security_group_rule.egress_public",
            "Provider": "AWS",
            "Service": "ec2",
            "StartLine": 7,
            "EndLine": 14,
            "Code": {
              "Lines": [
                {
                  "Number": 7,
                  "Content": "resource \"aws_security_group_rule\" \"egress_public\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_security_group_rule\"\u001b[0m \u001b[38;5;37m\"egress_public\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 8,
                  "Content": "  security_group_id = \"${aws_security_group.egress_public.id}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245msecurity_group_id\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0maws_security_group.egress_public.id\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 9,
                  "Content": "  type              = \"egress\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mtype\u001b[0m              = \u001b[38;5;37m\"egress\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 10,
                  "Content": "  protocol          = \"-1\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mprotocol\u001b[0m          = \u001b[38;5;37m\"-1\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 11,
                  "Content": "  from_port         = 0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mfrom_port\u001b[0m         = \u001b[38;5;37m0",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 12,
                  "Content": "  to_port           = 0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mto_port\u001b[0m           = \u001b[38;5;37m0",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 13,
                  "Content": "  cidr_blocks       = [\"0.0.0.0/0\"]",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mcidr_blocks\u001b[0m       = [\u001b[38;5;37m\"0.0.0.0/0\"\u001b[0m]",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 14,
                  "Content": "}",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "}",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "aws-vpc-add-description-to-security-group-rule",
          "AVDID": "AVD-AWS-0124",
          "Title": "Missing description for security group rule.",
          "Description": "Security group rules should include a description for auditing purposes.\n\nSimplifies auditing, debugging, and managing security groups.\n",
          "Message": "Security group rule does not have a description.",
          "Namespace": "builtin.aws.ec2.aws0124",
          "Query": "data.builtin.aws.ec2.aws0124.deny",
          "Resolution": "Add descriptions for all security groups rules",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/aws-vpc-add-description-to-security-group-rule",
          "References": [
            "https://www.cloudconformity.com/knowledge-base/aws/EC2/security-group-rules-description.html",
            "https://avd.aquasec.com/misconfig/aws-vpc-add-description-to-security-group-rule"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "aws_security_group_rule.ingress_internal",
            "Provider": "AWS",
            "Service": "ec2",
            "StartLine": 16,
            "EndLine": 23,
            "Code": {
              "Lines": [
                {
                  "Number": 16,
                  "Content": "resource \"aws_security_group_rule\" \"ingress_internal\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_security_group_rule\"\u001b[0m \u001b[38;5;37m\"ingress_internal\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 17,
                  "Content": "  security_group_id = \"${aws_security_group.egress_public.id}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245msecurity_group_id\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0maws_security_group.egress_public.id\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 18,
                  "Content": "  type              = \"ingress\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mtype\u001b[0m              = \u001b[38;5;37m\"ingress\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "  protocol          = \"-1\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mprotocol\u001b[0m          = \u001b[38;5;37m\"-1\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "  from_port         = 0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mfrom_port\u001b[0m         = \u001b[38;5;37m0",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "  to_port           = 0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mto_port\u001b[0m           = \u001b[38;5;37m0",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "  self              = \"true\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mself\u001b[0m              = \u001b[38;5;37m\"true\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "}",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m}",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            },
            "RenderedCause": {}
          }
        }
      ]
    },
    {
      "Target": "infrastructure-as-code/dynamic-aws-creds-from-vault/networks-subnets.tf",
      "Class": "config",
      "Type": "terraform",
      "MisconfSummary": {
        "Successes": 0,
        "Failures": 1
      },
      "Misconfigurations": [
        {
          "Type": "Terraform Security Check",
          "ID": "aws-vpc-no-public-ingress-sgr",
          "AVDID": "AVD-AWS-0164",
          "Title": "Instances in a subnet should not receive a public IP address by default.",
          "Description": "You should limit the provision of public IP addresses for resources. Resources should not be exposed on the public internet, but should have access limited to consumers required for the function of your application.\n",
          "Message": "Subnet associates public IP address.",
          "Namespace": "builtin.aws.ec2.aws0164",
          "Query": "data.builtin.aws.ec2.aws0164.deny",
          "Resolution": "Set the instance to not be publicly accessible",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/aws-vpc-no-public-ingress-sgr",
          "References": [
            "https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/using-instance-addressing.html#concepts-public-addresses",
            "https://avd.aquasec.com/misconfig/aws-vpc-no-public-ingress-sgr"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "aws_subnet.public[0]",
            "Provider": "AWS",
            "Service": "ec2",
            "StartLine": 7,
            "EndLine": 7,
            "Code": {
              "Lines": [
                {
                  "Number": 1,
                  "Content": "resource \"aws_subnet\" \"public\" {",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_subnet\"\u001b[0m \u001b[38;5;37m\"public\"\u001b[0m {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 2,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 7,
                  "Content": "  map_public_ip_on_launch = true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mmap_public_ip_on_launch\u001b[0m = \u001b[38;5;166mtrue",
                  "FirstCause": true,
                  "LastCause": true
                },
                {
                  "Number": 11,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 12,
                  "Content": "}",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "}",
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "aws_subnet.public[0]",
                "Filename": "infrastructure-as-code/dynamic-aws-creds-from-vault/networks-subnets.tf",
                "Location": {
                  "StartLine": 1,
                  "EndLine": 12
                }
              }
            ],
            "RenderedCause": {}
          }
        }
      ]
    },
    {
      "Target": "infrastructure-as-code/dynamic-aws-creds-from-vault/networks.tf",
      "Class": "config",
      "Type": "terraform",
      "MisconfSummary": {
        "Successes": 0,
        "Failures": 1
      },
      "Misconfigurations": [
        {
          "Type": "Terraform Security Check",
          "ID": "aws-autoscaling-enable-at-rest-encryption",
          "AVDID": "AVD-AWS-0178",
          "Title": "VPC Flow Logs is a feature that enables you to capture information about the IP traffic going to and from network interfaces in your VPC. After you've created a flow log, you can view and retrieve its data in Amazon CloudWatch Logs. It is recommended that VPC Flow Logs be enabled for packet \"Rejects\" for VPCs.",
          "Description": "VPC Flow Logs provide visibility into network traffic that traverses the VPC and can be used to detect anomalous traffic or insight during security workflows.\n",
          "Message": "VPC does not have VPC Flow Logs enabled.",
          "Namespace": "builtin.aws.ec2.aws0178",
          "Query": "data.builtin.aws.ec2.aws0178.deny",
          "Resolution": "Enable flow logs for VPC",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/aws-autoscaling-enable-at-rest-encryption",
          "References": [
            "https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/RootDeviceStorage.html",
            "https://avd.aquasec.com/misconfig/aws-autoscaling-enable-at-rest-encryption"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "aws_vpc.main",
            "Provider": "AWS",
            "Service": "ec2",
            "StartLine": 1,
            "EndLine": 8,
            "Code": {
              "Lines": [
                {
                  "Number": 1,
                  "Content": "resource \"aws_vpc\" \"main\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_vpc\"\u001b[0m \u001b[38;5;37m\"main\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 2,
                  "Content": "  cidr_block           = \"${var.vpc_cidr}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mcidr_block\u001b[0m           = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.vpc_cidr\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 3,
                  "Content": "  enable_dns_hostnames = true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245menable_dns_hostnames\u001b[0m = \u001b[38;5;166mtrue",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 4,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 5,
                  "Content": "  tags {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  tags {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 6,
                  "Content": "    Name = \"${var.environment_name}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;245mName\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.environment_name\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 7,
                  "Content": "  }",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  }",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 8,
                  "Content": "}",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "}",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            },
            "RenderedCause": {}
          }
        }
      ]
    },
    {
      "Target": "infrastructure-as-code/dynamic-aws-creds/consumer-workspace",
      "Class": "config",
      "Type": "terraform",
      "MisconfSummary": {
        "Successes": 54,
        "Failures": 0
      }
    },
    {
      "Target": "infrastructure-as-code/dynamic-aws-creds/consumer-workspace/main.tf",
      "Class": "config",
      "Type": "terraform",
      "MisconfSummary": {
        "Successes": 0,
        "Failures": 2
      },
      "Misconfigurations": [
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0028",
          "AVDID": "AVD-AWS-0028",
          "Title": "aws_instance should activate session tokens for Instance Metadata Service.",
          "Description": "IMDS v2 (Instance Metadata Service) introduced session authentication tokens which improve security when talking to IMDS.\n\nBy default \u003ccode\u003eaws_instance\u003c/code\u003e resource sets IMDS session auth tokens to be optional.\n\nTo fully protect IMDS you need to enable session tokens by using \u003ccode\u003emetadata_options\u003c/code\u003e block and its \u003ccode\u003ehttp_tokens\u003c/code\u003e variable set to \u003ccode\u003erequired\u003c/code\u003e.\n",
          "Message": "Instance does not require IMDS access to require a token.",
          "Namespace": "builtin.aws.ec2.aws0028",
          "Query": "data.builtin.aws.ec2.aws0028.deny",
          "Resolution": "Enable HTTP token requirement for IMDS",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0028",
          "References": [
            "https://aws.amazon.com/blogs/security/defense-in-depth-open-firewalls-reverse-proxies-ssrf-vulnerabilities-ec2-instance-metadata-service",
            "https://avd.aquasec.com/misconfig/avd-aws-0028"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "aws_instance.main",
            "Provider": "AWS",
            "Service": "ec2",
            "StartLine": 46,
            "EndLine": 55,
            "Code": {
              "Lines": [
                {
                  "Number": 46,
                  "Content": "resource \"aws_instance\" \"main\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_instance\"\u001b[0m \u001b[38;5;37m\"main\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 47,
                  "Content": "  ami           = \"${data.aws_ami.ubuntu.id}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mami\u001b[0m           = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mdata\u001b[0m.aws_ami.ubuntu.id\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 48,
                  "Content": "  instance_type = \"t2.nano\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245minstance_type\u001b[0m = \u001b[38;5;37m\"t2.nano\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 49,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 50,
                  "Content": "  tags = {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mtags\u001b[0m = {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 51,
                  "Content": "    Name  = \"${var.name}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;245mName\u001b[0m  = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.name\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 52,
                  "Content": "    TTL   = \"${var.ttl}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m    \u001b[38;5;245mTTL\u001b[0m   = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.ttl\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 53,
                  "Content": "    owner = \"${var.name}-guide\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m    \u001b[38;5;245mowner\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.name\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m-guide\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 54,
                  "Content": "  }",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  }",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 55,
                  "Content": "}",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "}",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0131",
          "AVDID": "AVD-AWS-0131",
          "Title": "Instance with unencrypted block device.",
          "Description": "Block devices should be encrypted to ensure sensitive data is held securely at rest.\n",
          "Message": "Root block device is not encrypted.",
          "Namespace": "builtin.aws.ec2.aws0131",
          "Query": "data.builtin.aws.ec2.aws0131.deny",
          "Resolution": "Turn on encryption for all block devices",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0131",
          "References": [
            "https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/RootDeviceStorage.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0131"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "aws_instance.main",
            "Provider": "AWS",
            "Service": "ec2",
            "StartLine": 46,
            "EndLine": 55,
            "Code": {
              "Lines": [
                {
                  "Number": 46,
                  "Content": "resource \"aws_instance\" \"main\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_instance\"\u001b[0m \u001b[38;5;37m\"main\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 47,
                  "Content": "  ami           = \"${data.aws_ami.ubuntu.id}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mami\u001b[0m           = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mdata\u001b[0m.aws_ami.ubuntu.id\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 48,
                  "Content": "  instance_type = \"t2.nano\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245minstance_type\u001b[0m = \u001b[38;5;37m\"t2.nano\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 49,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 50,
                  "Content": "  tags = {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mtags\u001b[0m = {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 51,
                  "Content": "    Name  = \"${var.name}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;245mName\u001b[0m  = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.name\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 52,
                  "Content": "    TTL   = \"${var.ttl}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m    \u001b[38;5;245mTTL\u001b[0m   = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.ttl\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 53,
                  "Content": "    owner = \"${var.name}-guide\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m    \u001b[38;5;245mowner\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.name\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m-guide\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 54,
                  "Content": "  }",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  }",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 55,
                  "Content": "}",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "}",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            },
            "RenderedCause": {}
          }
        }
      ]
    },
    {
      "Target": "infrastructure-as-code/dynamic-aws-creds/producer-workspace",
      "Class": "config",
      "Type": "terraform",
      "MisconfSummary": {
        "Successes": 37,
        "Failures": 0
      }
    },
    {
      "Target": "infrastructure-as-code/gcp-compute-instance",
      "Class": "config",
      "Type": "terraform",
      "MisconfSummary": {
        "Successes": 31,
        "Failures": 0
      }
    },
    {
      "Target": "infrastructure-as-code/gcp-compute-instance/main.tf",
      "Class": "config",
      "Type": "terraform",
      "MisconfSummary": {
        "Successes": 0,
        "Failures": 6
      },
      "Misconfigurations": [
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-GCP-0030",
          "AVDID": "AVD-GCP-0030",
          "Title": "Disable project-wide SSH keys for all instances",
          "Description": "Use of project-wide SSH keys means that a compromise of any one of these key pairs can result in all instances being compromised. It is recommended to use instance-level keys.\n",
          "Message": "Instance allows use of project-level SSH keys.",
          "Namespace": "builtin.google.compute.google0030",
          "Query": "data.builtin.google.compute.google0030.deny",
          "Resolution": "Disable project-wide SSH keys",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-gcp-0030",
          "References": [
            "https://avd.aquasec.com/misconfig/avd-gcp-0030"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "google_compute_instance.demo",
            "Provider": "Google",
            "Service": "compute",
            "StartLine": 44,
            "EndLine": 63,
            "Code": {
              "Lines": [
                {
                  "Number": 44,
                  "Content": "resource \"google_compute_instance\" \"demo\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"google_compute_instance\"\u001b[0m \u001b[38;5;37m\"demo\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 45,
                  "Content": "  name         = \"${var.instance_name}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mname\u001b[0m         = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.instance_name\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 46,
                  "Content": "  machine_type = \"${var.machine_type}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mmachine_type\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.machine_type\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 47,
                  "Content": "  zone         = \"${var.gcp_zone}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mzone\u001b[0m         = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.gcp_zone\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 48,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 49,
                  "Content": "  boot_disk {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  boot_disk {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 50,
                  "Content": "    initialize_params {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    initialize_params {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 51,
                  "Content": "      image = \"${var.image}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;245mimage\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.image\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 52,
                  "Content": "    }",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m    }",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 53,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-GCP-0031",
          "AVDID": "AVD-GCP-0031",
          "Title": "Instances should not have public IP addresses",
          "Description": "Instances should not be publicly exposed to the internet\n",
          "Message": "Instance has a public IP allocated.",
          "Namespace": "builtin.google.compute.google0031",
          "Query": "data.builtin.google.compute.google0031.deny",
          "Resolution": "Remove public IP",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-gcp-0031",
          "References": [
            "https://cloud.google.com/compute/docs/ip-addresses#externaladdresses",
            "https://avd.aquasec.com/misconfig/avd-gcp-0031"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "google_compute_instance.demo",
            "Provider": "Google",
            "Service": "compute",
            "StartLine": 58,
            "EndLine": 60,
            "Code": {
              "Lines": [
                {
                  "Number": 44,
                  "Content": "resource \"google_compute_instance\" \"demo\" {",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"google_compute_instance\"\u001b[0m \u001b[38;5;37m\"demo\"\u001b[0m {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 45,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 58,
                  "Content": "    access_config {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    access_config {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 59,
                  "Content": "      // Ephemeral IP",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;239m      // Ephemeral IP",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 60,
                  "Content": "    }",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m    }",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 62,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 63,
                  "Content": "}",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "}",
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "network_interface",
                "Filename": "infrastructure-as-code/gcp-compute-instance/main.tf",
                "Location": {
                  "StartLine": 55,
                  "EndLine": 61
                }
              },
              {
                "Resource": "google_compute_instance.demo",
                "Filename": "infrastructure-as-code/gcp-compute-instance/main.tf",
                "Location": {
                  "StartLine": 44,
                  "EndLine": 63
                }
              }
            ],
            "RenderedCause": {}
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-GCP-0033",
          "AVDID": "AVD-GCP-0033",
          "Title": "VM disks should be encrypted with Customer Supplied Encryption Keys",
          "Description": "Using unmanaged keys makes rotation and general management difficult.\n",
          "Message": "Instance disk encryption does not use a customer managed key.",
          "Namespace": "builtin.google.compute.google0033",
          "Query": "data.builtin.google.compute.google0033.deny",
          "Resolution": "Use managed keys",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-gcp-0033",
          "References": [
            "https://avd.aquasec.com/misconfig/avd-gcp-0033"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "google_compute_instance.demo",
            "Provider": "Google",
            "Service": "compute",
            "StartLine": 49,
            "EndLine": 53,
            "Code": {
              "Lines": [
                {
                  "Number": 44,
                  "Content": "resource \"google_compute_instance\" \"demo\" {",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"google_compute_instance\"\u001b[0m \u001b[38;5;37m\"demo\"\u001b[0m {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 45,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 49,
                  "Content": "  boot_disk {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  boot_disk {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 50,
                  "Content": "    initialize_params {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    initialize_params {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 51,
                  "Content": "      image = \"${var.image}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;245mimage\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.image\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 52,
                  "Content": "    }",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m    }",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 53,
                  "Content": "  }",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  }",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 62,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 63,
                  "Content": "}",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "}",
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "google_compute_instance.demo",
                "Filename": "infrastructure-as-code/gcp-compute-instance/main.tf",
                "Location": {
                  "StartLine": 44,
                  "EndLine": 63
                }
              }
            ],
            "RenderedCause": {}
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-GCP-0041",
          "AVDID": "AVD-GCP-0041",
          "Title": "Instances should have Shielded VM VTPM enabled",
          "Description": "The virtual TPM provides numerous security measures to your VM.\n",
          "Message": "Instance does not have VTPM for shielded VMs enabled.",
          "Namespace": "builtin.google.compute.google0041",
          "Query": "data.builtin.google.compute.google0041.deny",
          "Resolution": "Enable Shielded VM VTPM",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-gcp-0041",
          "References": [
            "https://cloud.google.com/blog/products/identity-security/virtual-trusted-platform-module-for-shielded-vms-security-in-plaintext",
            "https://avd.aquasec.com/misconfig/avd-gcp-0041"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "google_compute_instance.demo",
            "Provider": "Google",
            "Service": "compute",
            "StartLine": 44,
            "EndLine": 63,
            "Code": {
              "Lines": [
                {
                  "Number": 44,
                  "Content": "resource \"google_compute_instance\" \"demo\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"google_compute_instance\"\u001b[0m \u001b[38;5;37m\"demo\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 45,
                  "Content": "  name         = \"${var.instance_name}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mname\u001b[0m         = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.instance_name\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 46,
                  "Content": "  machine_type = \"${var.machine_type}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mmachine_type\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.machine_type\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 47,
                  "Content": "  zone         = \"${var.gcp_zone}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mzone\u001b[0m         = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.gcp_zone\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 48,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 49,
                  "Content": "  boot_disk {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  boot_disk {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 50,
                  "Content": "    initialize_params {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    initialize_params {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 51,
                  "Content": "      image = \"${var.image}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;245mimage\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.image\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 52,
                  "Content": "    }",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m    }",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 53,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-GCP-0045",
          "AVDID": "AVD-GCP-0045",
          "Title": "Instances should have Shielded VM integrity monitoring enabled",
          "Description": "Integrity monitoring helps you understand and make decisions about the state of your VM instances.\n",
          "Message": "Instance does not have shielded VM integrity monitoring enabled.",
          "Namespace": "builtin.google.compute.google0045",
          "Query": "data.builtin.google.compute.google0045.deny",
          "Resolution": "Enable Shielded VM Integrity Monitoring",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-gcp-0045",
          "References": [
            "https://cloud.google.com/security/shielded-cloud/shielded-vm#integrity-monitoring",
            "https://avd.aquasec.com/misconfig/avd-gcp-0045"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "google_compute_instance.demo",
            "Provider": "Google",
            "Service": "compute",
            "StartLine": 44,
            "EndLine": 63,
            "Code": {
              "Lines": [
                {
                  "Number": 44,
                  "Content": "resource \"google_compute_instance\" \"demo\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"google_compute_instance\"\u001b[0m \u001b[38;5;37m\"demo\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 45,
                  "Content": "  name         = \"${var.instance_name}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mname\u001b[0m         = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.instance_name\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 46,
                  "Content": "  machine_type = \"${var.machine_type}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mmachine_type\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.machine_type\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 47,
                  "Content": "  zone         = \"${var.gcp_zone}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mzone\u001b[0m         = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.gcp_zone\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 48,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 49,
                  "Content": "  boot_disk {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  boot_disk {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 50,
                  "Content": "    initialize_params {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    initialize_params {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 51,
                  "Content": "      image = \"${var.image}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;245mimage\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.image\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 52,
                  "Content": "    }",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m    }",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 53,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-GCP-0067",
          "AVDID": "AVD-GCP-0067",
          "Title": "Instances should have Shielded VM secure boot enabled",
          "Description": "Secure boot helps ensure that the system only runs authentic software.\n",
          "Message": "Instance does not have shielded VM secure boot enabled.",
          "Namespace": "builtin.google.compute.google0067",
          "Query": "data.builtin.google.compute.google0067.deny",
          "Resolution": "Enable Shielded VM secure boot",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-gcp-0067",
          "References": [
            "https://cloud.google.com/security/shielded-cloud/shielded-vm#secure-boot",
            "https://avd.aquasec.com/misconfig/avd-gcp-0067"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "google_compute_instance.demo",
            "Provider": "Google",
            "Service": "compute",
            "StartLine": 44,
            "EndLine": 63,
            "Code": {
              "Lines": [
                {
                  "Number": 44,
                  "Content": "resource \"google_compute_instance\" \"demo\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"google_compute_instance\"\u001b[0m \u001b[38;5;37m\"demo\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 45,
                  "Content": "  name         = \"${var.instance_name}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mname\u001b[0m         = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.instance_name\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 46,
                  "Content": "  machine_type = \"${var.machine_type}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mmachine_type\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.machine_type\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 47,
                  "Content": "  zone         = \"${var.gcp_zone}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mzone\u001b[0m         = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.gcp_zone\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 48,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 49,
                  "Content": "  boot_disk {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  boot_disk {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 50,
                  "Content": "    initialize_params {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    initialize_params {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 51,
                  "Content": "      image = \"${var.image}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;245mimage\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.image\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 52,
                  "Content": "    }",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m    }",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 53,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "RenderedCause": {}
          }
        }
      ]
    },
    {
      "Target": "infrastructure-as-code/hashistack/best-practices/terraform-aws",
      "Class": "config",
      "Type": "terraform",
      "MisconfSummary": {
        "Successes": 37,
        "Failures": 0
      }
    },
    {
      "Target": "infrastructure-as-code/hashistack/dev/terraform-aws",
      "Class": "config",
      "Type": "terraform",
      "MisconfSummary": {
        "Successes": 54,
        "Failures": 0
      }
    },
    {
      "Target": "infrastructure-as-code/hashistack/dev/terraform-azure",
      "Class": "config",
      "Type": "terraform",
      "MisconfSummary": {
        "Successes": 37,
        "Failures": 0
      }
    },
    {
      "Target": "infrastructure-as-code/hashistack/dev/terraform-azure/modules/consul-azure",
      "Class": "config",
      "Type": "terraform",
      "MisconfSummary": {
        "Successes": 40,
        "Failures": 0
      }
    },
    {
      "Target": "infrastructure-as-code/hashistack/dev/terraform-azure/modules/network-azure",
      "Class": "config",
      "Type": "terraform",
      "MisconfSummary": {
        "Successes": 43,
        "Failures": 0
      }
    },
    {
      "Target": "infrastructure-as-code/hashistack/dev/terraform-azure/modules/network-azure/firewalls-jumphost.tf",
      "Class": "config",
      "Type": "terraform",
      "MisconfSummary": {
        "Successes": 0,
        "Failures": 2
      },
      "Misconfigurations": [
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AZU-0047",
          "AVDID": "AVD-AZU-0047",
          "Title": "A security group rule should not allow unrestricted ingress from any IP address.",
          "Description": "Opening up ports to allow connections from the public internet is generally to be avoided. You should restrict access to IP addresses or ranges that are explicitly required where possible.\n",
          "Message": "Security group rule allows unrestricted ingress from any IP address.",
          "Namespace": "builtin.azure.network.azure0047",
          "Query": "data.builtin.azure.network.azure0047.deny",
          "Resolution": "Set a more restrictive cidr range",
          "Severity": "CRITICAL",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-azu-0047",
          "References": [
            "https://docs.microsoft.com/en-us/azure/security/fundamentals/network-best-practices",
            "https://avd.aquasec.com/misconfig/avd-azu-0047"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "azurerm_network_security_rule.jumphost_ssh",
            "Provider": "Azure",
            "Service": "network",
            "StartLine": 17,
            "EndLine": 17,
            "Code": {
              "Lines": [
                {
                  "Number": 7,
                  "Content": "resource \"azurerm_network_security_rule\" \"jumphost_ssh\" {",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"azurerm_network_security_rule\"\u001b[0m \u001b[38;5;37m\"jumphost_ssh\"\u001b[0m {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 8,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 17,
                  "Content": "  source_address_prefix      = \"*\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245msource_address_prefix\u001b[0m      = \u001b[38;5;37m\"*\"",
                  "FirstCause": true,
                  "LastCause": true
                },
                {
                  "Number": 20,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "}",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m}",
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "azurerm_network_security_rule.jumphost_ssh",
                "Filename": "infrastructure-as-code/hashistack/dev/terraform-azure/modules/network-azure/firewalls-jumphost.tf",
                "Location": {
                  "StartLine": 7,
                  "EndLine": 21
                }
              }
            ],
            "RenderedCause": {}
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AZU-0050",
          "AVDID": "AVD-AZU-0050",
          "Title": "Security group should not allow unrestricted ingress to SSH port from any IP address.",
          "Description": "SSH access can be configured on either the network security group or in the network security group rule.\nSSH access should not be permitted from the internet (*, 0.0.0.0, /0, internet, any)\n",
          "Message": "Security group rule allows unrestricted ingress to SSH port from any IP address.",
          "Namespace": "builtin.azure.network.azure0050",
          "Query": "data.builtin.azure.network.azure0050.deny",
          "Resolution": "Block port 22 access from the internet",
          "Severity": "CRITICAL",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-azu-0050",
          "References": [
            "https://avd.aquasec.com/misconfig/avd-azu-0050"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "azurerm_network_security_rule.jumphost_ssh",
            "Provider": "Azure",
            "Service": "network",
            "StartLine": 17,
            "EndLine": 17,
            "Code": {
              "Lines": [
                {
                  "Number": 7,
                  "Content": "resource \"azurerm_network_security_rule\" \"jumphost_ssh\" {",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"azurerm_network_security_rule\"\u001b[0m \u001b[38;5;37m\"jumphost_ssh\"\u001b[0m {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 8,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 17,
                  "Content": "  source_address_prefix      = \"*\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245msource_address_prefix\u001b[0m      = \u001b[38;5;37m\"*\"",
                  "FirstCause": true,
                  "LastCause": true
                },
                {
                  "Number": 20,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "}",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m}",
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "azurerm_network_security_rule.jumphost_ssh",
                "Filename": "infrastructure-as-code/hashistack/dev/terraform-azure/modules/network-azure/firewalls-jumphost.tf",
                "Location": {
                  "StartLine": 7,
                  "EndLine": 21
                }
              }
            ],
            "RenderedCause": {}
          }
        }
      ]
    },
    {
      "Target": "infrastructure-as-code/hashistack/dev/terraform-azure/modules/ssh-keypair-data",
      "Class": "config",
      "Type": "terraform",
      "MisconfSummary": {
        "Successes": 37,
        "Failures": 0
      }
    },
    {
      "Target": "infrastructure-as-code/hashistack/dev/terraform-gcp",
      "Class": "config",
      "Type": "terraform",
      "MisconfSummary": {
        "Successes": 37,
        "Failures": 0
      }
    },
    {
      "Target": "infrastructure-as-code/hashistack/quick-start/terraform-aws",
      "Class": "config",
      "Type": "terraform",
      "MisconfSummary": {
        "Successes": 37,
        "Failures": 0
      }
    },
    {
      "Target": "infrastructure-as-code/k8s-cluster-aks",
      "Class": "config",
      "Type": "terraform",
      "MisconfSummary": {
        "Successes": 37,
        "Failures": 0
      }
    },
    {
      "Target": "infrastructure-as-code/k8s-cluster-aks/main.tf",
      "Class": "config",
      "Type": "terraform",
      "MisconfSummary": {
        "Successes": 0,
        "Failures": 4
      },
      "Misconfigurations": [
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AZU-0040",
          "AVDID": "AVD-AZU-0040",
          "Title": "Ensure AKS logging to Azure Monitoring is Configured",
          "Description": "Ensure AKS logging to Azure Monitoring is configured for containers to monitor the performance of workloads.\n",
          "Message": "Cluster does not have logging enabled via OMS Agent.",
          "Namespace": "builtin.azure.container.azure0040",
          "Query": "data.builtin.azure.container.azure0040.deny",
          "Resolution": "Enable logging for AKS",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-azu-0040",
          "References": [
            "https://docs.microsoft.com/en-us/azure/azure-monitor/insights/container-insights-onboard",
            "https://avd.aquasec.com/misconfig/avd-azu-0040"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "azurerm_kubernetes_cluster.k8sexample",
            "Provider": "Azure",
            "Service": "container",
            "StartLine": 31,
            "EndLine": 61,
            "Code": {
              "Lines": [
                {
                  "Number": 31,
                  "Content": "resource \"azurerm_kubernetes_cluster\" \"k8sexample\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"azurerm_kubernetes_cluster\"\u001b[0m \u001b[38;5;37m\"k8sexample\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 32,
                  "Content": "  name = \"${var.vault_user}-k8sexample-cluster\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mname\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.vault_user\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m-k8sexample-cluster\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 33,
                  "Content": "  location = \"${azurerm_resource_group.k8sexample.location}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mlocation\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0mazurerm_resource_group.k8sexample.location\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 34,
                  "Content": "  resource_group_name = \"${azurerm_resource_group.k8sexample.name}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mresource_group_name\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0mazurerm_resource_group.k8sexample.name\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 35,
                  "Content": "  dns_prefix = \"${var.dns_prefix}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mdns_prefix\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.dns_prefix\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 36,
                  "Content": "  kubernetes_version = \"${var.k8s_version}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mkubernetes_version\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.k8s_version\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 37,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 38,
                  "Content": "  linux_profile {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  linux_profile {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 39,
                  "Content": "    admin_username = \"${var.admin_user}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;245madmin_username\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.admin_user\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 40,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AZU-0041",
          "AVDID": "AVD-AZU-0041",
          "Title": "Ensure AKS has an API Server Authorized IP Ranges enabled",
          "Description": "The API server is the central way to interact with and manage a cluster. To improve cluster security and minimize attacks, the API server should only be accessible from a limited set of IP address ranges.\n",
          "Message": "Cluster does not limit API access to specific IP addresses.",
          "Namespace": "builtin.azure.container.azure0041",
          "Query": "data.builtin.azure.container.azure0041.deny",
          "Resolution": "Limit the access to the API server to a limited IP range",
          "Severity": "CRITICAL",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-azu-0041",
          "References": [
            "https://docs.microsoft.com/en-us/azure/aks/api-server-authorized-ip-ranges",
            "https://avd.aquasec.com/misconfig/avd-azu-0041"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "azurerm_kubernetes_cluster.k8sexample",
            "Provider": "Azure",
            "Service": "container",
            "StartLine": 31,
            "EndLine": 61,
            "Code": {
              "Lines": [
                {
                  "Number": 31,
                  "Content": "resource \"azurerm_kubernetes_cluster\" \"k8sexample\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"azurerm_kubernetes_cluster\"\u001b[0m \u001b[38;5;37m\"k8sexample\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 32,
                  "Content": "  name = \"${var.vault_user}-k8sexample-cluster\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mname\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.vault_user\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m-k8sexample-cluster\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 33,
                  "Content": "  location = \"${azurerm_resource_group.k8sexample.location}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mlocation\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0mazurerm_resource_group.k8sexample.location\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 34,
                  "Content": "  resource_group_name = \"${azurerm_resource_group.k8sexample.name}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mresource_group_name\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0mazurerm_resource_group.k8sexample.name\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 35,
                  "Content": "  dns_prefix = \"${var.dns_prefix}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mdns_prefix\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.dns_prefix\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 36,
                  "Content": "  kubernetes_version = \"${var.k8s_version}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mkubernetes_version\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.k8s_version\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 37,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 38,
                  "Content": "  linux_profile {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  linux_profile {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 39,
                  "Content": "    admin_username = \"${var.admin_user}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;245madmin_username\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.admin_user\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 40,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AZU-0042",
          "AVDID": "AVD-AZU-0042",
          "Title": "Ensure RBAC is enabled on AKS clusters",
          "Description": "Using Kubernetes role-based access control (RBAC), you can grant users, groups, and service accounts access to only the resources they need.\n",
          "Message": "RBAC is not enabled on cluster",
          "Namespace": "builtin.azure.container.azure0042",
          "Query": "data.builtin.azure.container.azure0042.deny",
          "Resolution": "Enable RBAC",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-azu-0042",
          "References": [
            "https://docs.microsoft.com/en-us/azure/aks/concepts-identity",
            "https://avd.aquasec.com/misconfig/avd-azu-0042"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "azurerm_kubernetes_cluster.k8sexample",
            "Provider": "Azure",
            "Service": "container",
            "StartLine": 31,
            "EndLine": 61,
            "Code": {
              "Lines": [
                {
                  "Number": 31,
                  "Content": "resource \"azurerm_kubernetes_cluster\" \"k8sexample\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"azurerm_kubernetes_cluster\"\u001b[0m \u001b[38;5;37m\"k8sexample\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 32,
                  "Content": "  name = \"${var.vault_user}-k8sexample-cluster\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mname\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.vault_user\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m-k8sexample-cluster\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 33,
                  "Content": "  location = \"${azurerm_resource_group.k8sexample.location}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mlocation\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0mazurerm_resource_group.k8sexample.location\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 34,
                  "Content": "  resource_group_name = \"${azurerm_resource_group.k8sexample.name}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mresource_group_name\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0mazurerm_resource_group.k8sexample.name\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 35,
                  "Content": "  dns_prefix = \"${var.dns_prefix}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mdns_prefix\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.dns_prefix\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 36,
                  "Content": "  kubernetes_version = \"${var.k8s_version}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mkubernetes_version\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.k8s_version\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 37,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 38,
                  "Content": "  linux_profile {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  linux_profile {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 39,
                  "Content": "    admin_username = \"${var.admin_user}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;245madmin_username\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.admin_user\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 40,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AZU-0043",
          "AVDID": "AVD-AZU-0043",
          "Title": "Ensure AKS cluster has Network Policy configured",
          "Description": "The Kubernetes object type NetworkPolicy should be defined to have opportunity allow or block traffic to pods, as in a Kubernetes cluster configured with default settings, all pods can discover and communicate with each other without any restrictions.\n",
          "Message": "Kubernetes cluster does not have a network policy set.",
          "Namespace": "builtin.azure.container.azure0043",
          "Query": "data.builtin.azure.container.azure0043.deny",
          "Resolution": "Configure a network policy",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-azu-0043",
          "References": [
            "https://kubernetes.io/docs/concepts/services-networking/network-policies",
            "https://avd.aquasec.com/misconfig/avd-azu-0043"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "azurerm_kubernetes_cluster.k8sexample",
            "Provider": "Azure",
            "Service": "container",
            "StartLine": 31,
            "EndLine": 61,
            "Code": {
              "Lines": [
                {
                  "Number": 31,
                  "Content": "resource \"azurerm_kubernetes_cluster\" \"k8sexample\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"azurerm_kubernetes_cluster\"\u001b[0m \u001b[38;5;37m\"k8sexample\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 32,
                  "Content": "  name = \"${var.vault_user}-k8sexample-cluster\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mname\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.vault_user\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m-k8sexample-cluster\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 33,
                  "Content": "  location = \"${azurerm_resource_group.k8sexample.location}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mlocation\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0mazurerm_resource_group.k8sexample.location\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 34,
                  "Content": "  resource_group_name = \"${azurerm_resource_group.k8sexample.name}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mresource_group_name\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0mazurerm_resource_group.k8sexample.name\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 35,
                  "Content": "  dns_prefix = \"${var.dns_prefix}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mdns_prefix\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.dns_prefix\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 36,
                  "Content": "  kubernetes_version = \"${var.k8s_version}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mkubernetes_version\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.k8s_version\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 37,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 38,
                  "Content": "  linux_profile {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  linux_profile {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 39,
                  "Content": "    admin_username = \"${var.admin_user}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;245madmin_username\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.admin_user\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 40,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "RenderedCause": {}
          }
        }
      ]
    },
    {
      "Target": "infrastructure-as-code/k8s-cluster-gke",
      "Class": "config",
      "Type": "terraform",
      "MisconfSummary": {
        "Successes": 44,
        "Failures": 0
      }
    },
    {
      "Target": "infrastructure-as-code/k8s-cluster-gke/main.tf",
      "Class": "config",
      "Type": "terraform",
      "MisconfSummary": {
        "Successes": 0,
        "Failures": 10
      },
      "Misconfigurations": [
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-GCP-0048",
          "AVDID": "AVD-GCP-0048",
          "Title": "Legacy metadata endpoints enabled.",
          "Description": "The Compute Engine instance metadata server exposes legacy v0.1 and v1beta1 endpoints, which do not enforce metadata query headers.\n\nThis is a feature in the v1 APIs that makes it more difficult for a potential attacker to retrieve instance metadata.\n\nUnless specifically required, we recommend you disable these legacy APIs.\n\nWhen setting the \u003ccode\u003emetadata\u003c/code\u003e block, the default value for \u003ccode\u003edisable-legacy-endpoints\u003c/code\u003e is set to true, they should not be explicitly enabled.\n",
          "Message": "Cluster has legacy metadata endpoints enabled.",
          "Namespace": "builtin.google.gke.google0048",
          "Query": "data.builtin.google.gke.google0048.deny",
          "Resolution": "Disable legacy metadata endpoints",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-gcp-0048",
          "References": [
            "https://cloud.google.com/kubernetes-engine/docs/how-to/hardening-your-cluster#protect_node_metadata_default_for_112",
            "https://avd.aquasec.com/misconfig/avd-gcp-0048"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "google_container_cluster.k8sexample",
            "Provider": "Google",
            "Service": "gke",
            "StartLine": 36,
            "EndLine": 45,
            "Code": {
              "Lines": [
                {
                  "Number": 19,
                  "Content": "resource \"google_container_cluster\" \"k8sexample\" {",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"google_container_cluster\"\u001b[0m \u001b[38;5;37m\"k8sexample\"\u001b[0m {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 36,
                  "Content": "  node_config {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  node_config {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 37,
                  "Content": "    machine_type = \"${var.node_machine_type}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;245mmachine_type\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.node_machine_type\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 38,
                  "Content": "    disk_size_gb = \"${var.node_disk_size}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m    \u001b[38;5;245mdisk_size_gb\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.node_disk_size\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 39,
                  "Content": "    oauth_scopes = [",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m    \u001b[38;5;245moauth_scopes\u001b[0m = [",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 40,
                  "Content": "      \"https://www.googleapis.com/auth/compute\",",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;37m\"https://www.googleapis.com/auth/compute\"\u001b[0m,",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 41,
                  "Content": "      \"https://www.googleapis.com/auth/devstorage.read_only\",",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;37m\"https://www.googleapis.com/auth/devstorage.read_only\"\u001b[0m,",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 42,
                  "Content": "      \"https://www.googleapis.com/auth/logging.write\",",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;37m\"https://www.googleapis.com/auth/logging.write\"\u001b[0m,",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 43,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "google_container_cluster.k8sexample",
                "Filename": "infrastructure-as-code/k8s-cluster-gke/main.tf",
                "Location": {
                  "StartLine": 19,
                  "EndLine": 46
                }
              }
            ],
            "RenderedCause": {}
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-GCP-0049",
          "AVDID": "AVD-GCP-0049",
          "Title": "Clusters should have IP aliasing enabled",
          "Description": "IP aliasing allows the reuse of public IPs internally, removing the need for a NAT gateway.\n",
          "Message": "Cluster has IP aliasing disabled.",
          "Namespace": "builtin.google.gke.google0049",
          "Query": "data.builtin.google.gke.google0049.deny",
          "Resolution": "Enable IP aliasing",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-gcp-0049",
          "References": [
            "https://avd.aquasec.com/misconfig/avd-gcp-0049"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "google_container_cluster.k8sexample",
            "Provider": "Google",
            "Service": "gke",
            "StartLine": 19,
            "EndLine": 46,
            "Code": {
              "Lines": [
                {
                  "Number": 19,
                  "Content": "resource \"google_container_cluster\" \"k8sexample\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"google_container_cluster\"\u001b[0m \u001b[38;5;37m\"k8sexample\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "  name               = \"${var.vault_user}-k8s-cluster\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mname\u001b[0m               = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.vault_user\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m-k8s-cluster\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "  description        = \"example k8s cluster\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mdescription\u001b[0m        = \u001b[38;5;37m\"example k8s cluster\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "  zone               = \"${var.gcp_zone}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mzone\u001b[0m               = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.gcp_zone\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "  initial_node_count = \"${var.initial_node_count}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245minitial_node_count\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.initial_node_count\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 24,
                  "Content": "  enable_kubernetes_alpha = \"true\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245menable_kubernetes_alpha\u001b[0m = \u001b[38;5;37m\"true\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 25,
                  "Content": "  enable_legacy_abac = \"true\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245menable_legacy_abac\u001b[0m = \u001b[38;5;37m\"true\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 26,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 27,
                  "Content": "  master_auth {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  master_auth {",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 28,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-GCP-0050",
          "AVDID": "AVD-GCP-0050",
          "Title": "Checks for service account defined for GKE nodes",
          "Description": "You should create and use a minimally privileged service account to run your GKE cluster instead of using the Compute Engine default service account.\n",
          "Message": "Cluster does not override the default service account.",
          "Namespace": "builtin.google.gke.google0050",
          "Query": "data.builtin.google.gke.google0050.deny",
          "Resolution": "Use limited permissions for service accounts to be effective",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-gcp-0050",
          "References": [
            "https://cloud.google.com/kubernetes-engine/docs/how-to/hardening-your-cluster#use_least_privilege_sa",
            "https://avd.aquasec.com/misconfig/avd-gcp-0050"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "google_container_cluster.k8sexample",
            "Provider": "Google",
            "Service": "gke",
            "StartLine": 36,
            "EndLine": 45,
            "Code": {
              "Lines": [
                {
                  "Number": 19,
                  "Content": "resource \"google_container_cluster\" \"k8sexample\" {",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"google_container_cluster\"\u001b[0m \u001b[38;5;37m\"k8sexample\"\u001b[0m {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 36,
                  "Content": "  node_config {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  node_config {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 37,
                  "Content": "    machine_type = \"${var.node_machine_type}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;245mmachine_type\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.node_machine_type\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 38,
                  "Content": "    disk_size_gb = \"${var.node_disk_size}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m    \u001b[38;5;245mdisk_size_gb\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.node_disk_size\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 39,
                  "Content": "    oauth_scopes = [",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m    \u001b[38;5;245moauth_scopes\u001b[0m = [",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 40,
                  "Content": "      \"https://www.googleapis.com/auth/compute\",",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;37m\"https://www.googleapis.com/auth/compute\"\u001b[0m,",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 41,
                  "Content": "      \"https://www.googleapis.com/auth/devstorage.read_only\",",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;37m\"https://www.googleapis.com/auth/devstorage.read_only\"\u001b[0m,",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 42,
                  "Content": "      \"https://www.googleapis.com/auth/logging.write\",",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;37m\"https://www.googleapis.com/auth/logging.write\"\u001b[0m,",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 43,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "google_container_cluster.k8sexample",
                "Filename": "infrastructure-as-code/k8s-cluster-gke/main.tf",
                "Location": {
                  "StartLine": 19,
                  "EndLine": 46
                }
              }
            ],
            "RenderedCause": {}
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-GCP-0051",
          "AVDID": "AVD-GCP-0051",
          "Title": "Clusters should be configured with Labels",
          "Description": "Labels make it easier to manage assets and differentiate between clusters and environments, allowing the mapping of computational resources to the wider organisational structure.\n",
          "Message": "Cluster does not use GCE resource labels.",
          "Namespace": "builtin.google.gke.google0051",
          "Query": "data.builtin.google.gke.google0051.deny",
          "Resolution": "Set cluster resource labels",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-gcp-0051",
          "References": [
            "https://avd.aquasec.com/misconfig/avd-gcp-0051"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "google_container_cluster.k8sexample",
            "Provider": "Google",
            "Service": "gke",
            "StartLine": 19,
            "EndLine": 46,
            "Code": {
              "Lines": [
                {
                  "Number": 19,
                  "Content": "resource \"google_container_cluster\" \"k8sexample\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"google_container_cluster\"\u001b[0m \u001b[38;5;37m\"k8sexample\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "  name               = \"${var.vault_user}-k8s-cluster\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mname\u001b[0m               = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.vault_user\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m-k8s-cluster\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "  description        = \"example k8s cluster\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mdescription\u001b[0m        = \u001b[38;5;37m\"example k8s cluster\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "  zone               = \"${var.gcp_zone}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mzone\u001b[0m               = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.gcp_zone\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "  initial_node_count = \"${var.initial_node_count}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245minitial_node_count\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.initial_node_count\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 24,
                  "Content": "  enable_kubernetes_alpha = \"true\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245menable_kubernetes_alpha\u001b[0m = \u001b[38;5;37m\"true\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 25,
                  "Content": "  enable_legacy_abac = \"true\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245menable_legacy_abac\u001b[0m = \u001b[38;5;37m\"true\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 26,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 27,
                  "Content": "  master_auth {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  master_auth {",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 28,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-GCP-0056",
          "AVDID": "AVD-GCP-0056",
          "Title": "Network Policy should be enabled on GKE clusters",
          "Description": "Enabling a network policy allows the segregation of network traffic by namespace\n",
          "Message": "Cluster does not have a network policy enabled.",
          "Namespace": "builtin.google.gke.google0056",
          "Query": "data.builtin.google.gke.google0056.deny",
          "Resolution": "Enable network policy",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-gcp-0056",
          "References": [
            "https://avd.aquasec.com/misconfig/avd-gcp-0056"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "google_container_cluster.k8sexample",
            "Provider": "Google",
            "Service": "gke",
            "StartLine": 19,
            "EndLine": 46,
            "Code": {
              "Lines": [
                {
                  "Number": 19,
                  "Content": "resource \"google_container_cluster\" \"k8sexample\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"google_container_cluster\"\u001b[0m \u001b[38;5;37m\"k8sexample\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "  name               = \"${var.vault_user}-k8s-cluster\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mname\u001b[0m               = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.vault_user\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m-k8s-cluster\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "  description        = \"example k8s cluster\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mdescription\u001b[0m        = \u001b[38;5;37m\"example k8s cluster\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "  zone               = \"${var.gcp_zone}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mzone\u001b[0m               = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.gcp_zone\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "  initial_node_count = \"${var.initial_node_count}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245minitial_node_count\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.initial_node_count\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 24,
                  "Content": "  enable_kubernetes_alpha = \"true\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245menable_kubernetes_alpha\u001b[0m = \u001b[38;5;37m\"true\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 25,
                  "Content": "  enable_legacy_abac = \"true\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245menable_legacy_abac\u001b[0m = \u001b[38;5;37m\"true\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 26,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 27,
                  "Content": "  master_auth {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  master_auth {",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 28,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-GCP-0057",
          "AVDID": "AVD-GCP-0057",
          "Title": "Node metadata value disables metadata concealment.",
          "Description": "If the \u003ccode\u003eworkload_metadata_config\u003c/code\u003e block within \u003ccode\u003enode_config\u003c/code\u003e is included, the \u003ccode\u003enode_metadata\u003c/code\u003e attribute should be configured securely.\n\nThe attribute should be set to \u003ccode\u003eSECURE\u003c/code\u003e to use metadata concealment, or \u003ccode\u003eGKE_METADATA_SERVER\u003c/code\u003e if workload identity is enabled. This ensures that the VM metadata is not unnecessarily exposed to pods.\n",
          "Message": "Cluster exposes node metadata of pools by default.",
          "Namespace": "builtin.google.gke.google0057",
          "Query": "data.builtin.google.gke.google0057.deny",
          "Resolution": "Set node metadata to SECURE or GKE_METADATA_SERVER",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-gcp-0057",
          "References": [
            "https://cloud.google.com/kubernetes-engine/docs/how-to/protecting-cluster-metadata#create-concealed",
            "https://avd.aquasec.com/misconfig/avd-gcp-0057"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "google_container_cluster.k8sexample",
            "Provider": "Google",
            "Service": "gke",
            "StartLine": 36,
            "EndLine": 45,
            "Code": {
              "Lines": [
                {
                  "Number": 19,
                  "Content": "resource \"google_container_cluster\" \"k8sexample\" {",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"google_container_cluster\"\u001b[0m \u001b[38;5;37m\"k8sexample\"\u001b[0m {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 36,
                  "Content": "  node_config {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  node_config {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 37,
                  "Content": "    machine_type = \"${var.node_machine_type}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;245mmachine_type\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.node_machine_type\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 38,
                  "Content": "    disk_size_gb = \"${var.node_disk_size}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m    \u001b[38;5;245mdisk_size_gb\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.node_disk_size\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 39,
                  "Content": "    oauth_scopes = [",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m    \u001b[38;5;245moauth_scopes\u001b[0m = [",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 40,
                  "Content": "      \"https://www.googleapis.com/auth/compute\",",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;37m\"https://www.googleapis.com/auth/compute\"\u001b[0m,",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 41,
                  "Content": "      \"https://www.googleapis.com/auth/devstorage.read_only\",",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;37m\"https://www.googleapis.com/auth/devstorage.read_only\"\u001b[0m,",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 42,
                  "Content": "      \"https://www.googleapis.com/auth/logging.write\",",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;37m\"https://www.googleapis.com/auth/logging.write\"\u001b[0m,",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 43,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "google_container_cluster.k8sexample",
                "Filename": "infrastructure-as-code/k8s-cluster-gke/main.tf",
                "Location": {
                  "StartLine": 19,
                  "EndLine": 46
                }
              }
            ],
            "RenderedCause": {}
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-GCP-0059",
          "AVDID": "AVD-GCP-0059",
          "Title": "Clusters should be set to private",
          "Description": "Enabling private nodes on a cluster ensures the nodes are only available internally as they will only be assigned internal addresses.\n",
          "Message": "Cluster does not have private nodes.",
          "Namespace": "builtin.google.gke.google0059",
          "Query": "data.builtin.google.gke.google0059.deny",
          "Resolution": "Enable private cluster",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-gcp-0059",
          "References": [
            "https://avd.aquasec.com/misconfig/avd-gcp-0059"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "google_container_cluster.k8sexample",
            "Provider": "Google",
            "Service": "gke",
            "StartLine": 19,
            "EndLine": 46,
            "Code": {
              "Lines": [
                {
                  "Number": 19,
                  "Content": "resource \"google_container_cluster\" \"k8sexample\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"google_container_cluster\"\u001b[0m \u001b[38;5;37m\"k8sexample\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "  name               = \"${var.vault_user}-k8s-cluster\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mname\u001b[0m               = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.vault_user\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m-k8s-cluster\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "  description        = \"example k8s cluster\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mdescription\u001b[0m        = \u001b[38;5;37m\"example k8s cluster\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "  zone               = \"${var.gcp_zone}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mzone\u001b[0m               = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.gcp_zone\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "  initial_node_count = \"${var.initial_node_count}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245minitial_node_count\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.initial_node_count\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 24,
                  "Content": "  enable_kubernetes_alpha = \"true\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245menable_kubernetes_alpha\u001b[0m = \u001b[38;5;37m\"true\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 25,
                  "Content": "  enable_legacy_abac = \"true\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245menable_legacy_abac\u001b[0m = \u001b[38;5;37m\"true\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 26,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 27,
                  "Content": "  master_auth {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  master_auth {",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 28,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-GCP-0061",
          "AVDID": "AVD-GCP-0061",
          "Title": "Master authorized networks should be configured on GKE clusters",
          "Description": "Enabling authorized networks means you can restrict master access to a fixed set of CIDR ranges\n",
          "Message": "Cluster does not have master authorized networks enabled.",
          "Namespace": "builtin.google.gke.google0061",
          "Query": "data.builtin.google.gke.google0061.deny",
          "Resolution": "Enable master authorized networks",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-gcp-0061",
          "References": [
            "https://avd.aquasec.com/misconfig/avd-gcp-0061"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "google_container_cluster.k8sexample",
            "Provider": "Google",
            "Service": "gke",
            "StartLine": 19,
            "EndLine": 46,
            "Code": {
              "Lines": [
                {
                  "Number": 19,
                  "Content": "resource \"google_container_cluster\" \"k8sexample\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"google_container_cluster\"\u001b[0m \u001b[38;5;37m\"k8sexample\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "  name               = \"${var.vault_user}-k8s-cluster\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mname\u001b[0m               = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.vault_user\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m-k8s-cluster\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "  description        = \"example k8s cluster\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mdescription\u001b[0m        = \u001b[38;5;37m\"example k8s cluster\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "  zone               = \"${var.gcp_zone}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mzone\u001b[0m               = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.gcp_zone\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "  initial_node_count = \"${var.initial_node_count}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245minitial_node_count\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.initial_node_count\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 24,
                  "Content": "  enable_kubernetes_alpha = \"true\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245menable_kubernetes_alpha\u001b[0m = \u001b[38;5;37m\"true\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 25,
                  "Content": "  enable_legacy_abac = \"true\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245menable_legacy_abac\u001b[0m = \u001b[38;5;37m\"true\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 26,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 27,
                  "Content": "  master_auth {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  master_auth {",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 28,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-GCP-0062",
          "AVDID": "AVD-GCP-0062",
          "Title": "Legacy ABAC permissions are enabled.",
          "Description": "You should disable Attribute-Based Access Control (ABAC), and instead use Role-Based Access Control (RBAC) in GKE.\n\nRBAC has significant security advantages and is now stable in Kubernetes, so its time to disable ABAC.\n",
          "Message": "Cluster has legacy ABAC enabled.",
          "Namespace": "builtin.google.gke.google0062",
          "Query": "data.builtin.google.gke.google0062.deny",
          "Resolution": "Switch to using RBAC permissions",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-gcp-0062",
          "References": [
            "https://cloud.google.com/kubernetes-engine/docs/how-to/hardening-your-cluster#leave_abac_disabled_default_for_110",
            "https://avd.aquasec.com/misconfig/avd-gcp-0062"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "google_container_cluster.k8sexample",
            "Provider": "Google",
            "Service": "gke",
            "StartLine": 25,
            "EndLine": 25,
            "Code": {
              "Lines": [
                {
                  "Number": 19,
                  "Content": "resource \"google_container_cluster\" \"k8sexample\" {",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"google_container_cluster\"\u001b[0m \u001b[38;5;37m\"k8sexample\"\u001b[0m {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 25,
                  "Content": "  enable_legacy_abac = \"true\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245menable_legacy_abac\u001b[0m = \u001b[38;5;37m\"true\"",
                  "FirstCause": true,
                  "LastCause": true
                },
                {
                  "Number": 45,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 46,
                  "Content": "}",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "}",
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "google_container_cluster.k8sexample",
                "Filename": "infrastructure-as-code/k8s-cluster-gke/main.tf",
                "Location": {
                  "StartLine": 19,
                  "EndLine": 46
                }
              }
            ],
            "RenderedCause": {}
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-GCP-0064",
          "AVDID": "AVD-GCP-0064",
          "Title": "Legacy client authentication methods utilized.",
          "Description": "It is recommended to use Service Accounts and OAuth as authentication methods for accessing the master in the container cluster.\n\nBasic authentication should be disabled by explicitly unsetting the \u003ccode\u003eusername\u003c/code\u003e and \u003ccode\u003epassword\u003c/code\u003e on the \u003ccode\u003emaster_auth\u003c/code\u003e block.\n",
          "Message": "Cluster allows the use of certificates for master authentication.",
          "Namespace": "builtin.google.gke.google0064",
          "Query": "data.builtin.google.gke.google0064.deny",
          "Resolution": "Use service account or OAuth for authentication",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-gcp-0064",
          "References": [
            "https://cloud.google.com/kubernetes-engine/docs/how-to/hardening-your-cluster#restrict_authn_methods",
            "https://avd.aquasec.com/misconfig/avd-gcp-0064"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "google_container_cluster.k8sexample",
            "Provider": "Google",
            "Service": "gke",
            "StartLine": 32,
            "EndLine": 32,
            "Code": {
              "Lines": [
                {
                  "Number": 19,
                  "Content": "resource \"google_container_cluster\" \"k8sexample\" {",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"google_container_cluster\"\u001b[0m \u001b[38;5;37m\"k8sexample\"\u001b[0m {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 32,
                  "Content": "      issue_client_certificate = true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;245missue_client_certificate\u001b[0m = \u001b[38;5;166mtrue",
                  "FirstCause": true,
                  "LastCause": true
                },
                {
                  "Number": 45,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 46,
                  "Content": "}",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "}",
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "client_certificate_config",
                "Filename": "infrastructure-as-code/k8s-cluster-gke/main.tf",
                "Location": {
                  "StartLine": 31,
                  "EndLine": 33
                }
              },
              {
                "Resource": "master_auth",
                "Filename": "infrastructure-as-code/k8s-cluster-gke/main.tf",
                "Location": {
                  "StartLine": 27,
                  "EndLine": 34
                }
              },
              {
                "Resource": "google_container_cluster.k8sexample",
                "Filename": "infrastructure-as-code/k8s-cluster-gke/main.tf",
                "Location": {
                  "StartLine": 19,
                  "EndLine": 46
                }
              }
            ],
            "RenderedCause": {}
          }
        }
      ]
    },
    {
      "Target": "infrastructure-as-code/k8s-cluster-openshift-aws",
      "Class": "config",
      "Type": "terraform",
      "MisconfSummary": {
        "Successes": 49,
        "Failures": 0
      }
    },
    {
      "Target": "infrastructure-as-code/k8s-cluster-openshift-aws/modules/openshift/02-vpc.tf",
      "Class": "config",
      "Type": "terraform",
      "MisconfSummary": {
        "Successes": 0,
        "Failures": 2
      },
      "Misconfigurations": [
        {
          "Type": "Terraform Security Check",
          "ID": "aws-vpc-no-public-ingress-sgr",
          "AVDID": "AVD-AWS-0164",
          "Title": "Instances in a subnet should not receive a public IP address by default.",
          "Description": "You should limit the provision of public IP addresses for resources. Resources should not be exposed on the public internet, but should have access limited to consumers required for the function of your application.\n",
          "Message": "Subnet associates public IP address.",
          "Namespace": "builtin.aws.ec2.aws0164",
          "Query": "data.builtin.aws.ec2.aws0164.deny",
          "Resolution": "Set the instance to not be publicly accessible",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/aws-vpc-no-public-ingress-sgr",
          "References": [
            "https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/using-instance-addressing.html#concepts-public-addresses",
            "https://avd.aquasec.com/misconfig/aws-vpc-no-public-ingress-sgr"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "module.openshift",
            "Provider": "AWS",
            "Service": "ec2",
            "StartLine": 27,
            "EndLine": 27,
            "Code": {
              "Lines": [
                {
                  "Number": 23,
                  "Content": "resource \"aws_subnet\" \"public-subnet\" {",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_subnet\"\u001b[0m \u001b[38;5;37m\"public-subnet\"\u001b[0m {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 24,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 27,
                  "Content": "  map_public_ip_on_launch = true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mmap_public_ip_on_launch\u001b[0m = \u001b[38;5;166mtrue",
                  "FirstCause": true,
                  "LastCause": true
                },
                {
                  "Number": 33,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 34,
                  "Content": "}",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "}",
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "aws_subnet.public-subnet",
                "Filename": "infrastructure-as-code/k8s-cluster-openshift-aws/modules/openshift/02-vpc.tf",
                "Location": {
                  "StartLine": 23,
                  "EndLine": 34
                }
              },
              {
                "Resource": "module.openshift",
                "Filename": "infrastructure-as-code/k8s-cluster-openshift-aws/main.tf",
                "Location": {
                  "StartLine": 42,
                  "EndLine": 54
                }
              }
            ],
            "RenderedCause": {}
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "aws-autoscaling-enable-at-rest-encryption",
          "AVDID": "AVD-AWS-0178",
          "Title": "VPC Flow Logs is a feature that enables you to capture information about the IP traffic going to and from network interfaces in your VPC. After you've created a flow log, you can view and retrieve its data in Amazon CloudWatch Logs. It is recommended that VPC Flow Logs be enabled for packet \"Rejects\" for VPCs.",
          "Description": "VPC Flow Logs provide visibility into network traffic that traverses the VPC and can be used to detect anomalous traffic or insight during security workflows.\n",
          "Message": "VPC does not have VPC Flow Logs enabled.",
          "Namespace": "builtin.aws.ec2.aws0178",
          "Query": "data.builtin.aws.ec2.aws0178.deny",
          "Resolution": "Enable flow logs for VPC",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/aws-autoscaling-enable-at-rest-encryption",
          "References": [
            "https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/RootDeviceStorage.html",
            "https://avd.aquasec.com/misconfig/aws-autoscaling-enable-at-rest-encryption"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "module.openshift",
            "Provider": "AWS",
            "Service": "ec2",
            "StartLine": 2,
            "EndLine": 10,
            "Code": {
              "Lines": [
                {
                  "Number": 2,
                  "Content": "resource \"aws_vpc\" \"openshift\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_vpc\"\u001b[0m \u001b[38;5;37m\"openshift\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 3,
                  "Content": "  cidr_block           = \"${var.vpc_cidr}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mcidr_block\u001b[0m           = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.vpc_cidr\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 4,
                  "Content": "  enable_dns_hostnames = true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245menable_dns_hostnames\u001b[0m = \u001b[38;5;166mtrue",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 5,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 6,
                  "Content": "  tags {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  tags {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 7,
                  "Content": "    Name    = \"${var.name_tag_prefix}-openshift VPC\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;245mName\u001b[0m    = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.name_tag_prefix\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m-openshift VPC\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 8,
                  "Content": "    Project = \"openshift\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m    \u001b[38;5;245mProject\u001b[0m = \u001b[38;5;37m\"openshift\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 9,
                  "Content": "  }",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  }",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 10,
                  "Content": "}",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "}",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "module.openshift",
                "Filename": "infrastructure-as-code/k8s-cluster-openshift-aws/main.tf",
                "Location": {
                  "StartLine": 42,
                  "EndLine": 54
                }
              }
            ],
            "RenderedCause": {}
          }
        }
      ]
    },
    {
      "Target": "infrastructure-as-code/k8s-cluster-openshift-aws/modules/openshift/03-security-groups.tf",
      "Class": "config",
      "Type": "terraform",
      "MisconfSummary": {
        "Successes": 0,
        "Failures": 14
      },
      "Misconfigurations": [
        {
          "Type": "Terraform Security Check",
          "ID": "aws-vpc-no-public-egress-sgr",
          "AVDID": "AVD-AWS-0104",
          "Title": "A security group rule should not allow unrestricted egress to any IP address.",
          "Description": "Opening up ports to connect out to the public internet is generally to be avoided. You should restrict access to IP addresses or ranges that are explicitly required where possible.\n",
          "Message": "Security group rule allows unrestricted egress to any IP address.",
          "Namespace": "builtin.aws.ec2.aws0104",
          "Query": "data.builtin.aws.ec2.aws0104.deny",
          "Resolution": "Set a more restrictive cidr range",
          "Severity": "CRITICAL",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/aws-vpc-no-public-egress-sgr",
          "References": [
            "https://docs.aws.amazon.com/whitepapers/latest/building-scalable-secure-multi-vpc-network-infrastructure/centralized-egress-to-internet.html",
            "https://avd.aquasec.com/misconfig/aws-vpc-no-public-egress-sgr"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "module.openshift",
            "Provider": "AWS",
            "Service": "ec2",
            "StartLine": 94,
            "EndLine": 94,
            "Code": {
              "Lines": [
                {
                  "Number": 76,
                  "Content": "resource \"aws_security_group\" \"openshift-public-egress\" {",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_security_group\"\u001b[0m \u001b[38;5;37m\"openshift-public-egress\"\u001b[0m {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 77,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 94,
                  "Content": "    cidr_blocks = [\"0.0.0.0/0\"]",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m    \u001b[38;5;245mcidr_blocks\u001b[0m = [\u001b[38;5;37m\"0.0.0.0/0\"\u001b[0m]",
                  "FirstCause": true,
                  "LastCause": true
                },
                {
                  "Number": 108,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 109,
                  "Content": "}",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "}",
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "egress",
                "Filename": "infrastructure-as-code/k8s-cluster-openshift-aws/modules/openshift/03-security-groups.tf",
                "Location": {
                  "StartLine": 90,
                  "EndLine": 95
                }
              },
              {
                "Resource": "aws_security_group.openshift-public-egress",
                "Filename": "infrastructure-as-code/k8s-cluster-openshift-aws/modules/openshift/03-security-groups.tf",
                "Location": {
                  "StartLine": 76,
                  "EndLine": 109
                }
              },
              {
                "Resource": "module.openshift",
                "Filename": "infrastructure-as-code/k8s-cluster-openshift-aws/main.tf",
                "Location": {
                  "StartLine": 42,
                  "EndLine": 54
                }
              }
            ],
            "RenderedCause": {}
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "aws-vpc-no-public-egress-sgr",
          "AVDID": "AVD-AWS-0104",
          "Title": "A security group rule should not allow unrestricted egress to any IP address.",
          "Description": "Opening up ports to connect out to the public internet is generally to be avoided. You should restrict access to IP addresses or ranges that are explicitly required where possible.\n",
          "Message": "Security group rule allows unrestricted egress to any IP address.",
          "Namespace": "builtin.aws.ec2.aws0104",
          "Query": "data.builtin.aws.ec2.aws0104.deny",
          "Resolution": "Set a more restrictive cidr range",
          "Severity": "CRITICAL",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/aws-vpc-no-public-egress-sgr",
          "References": [
            "https://docs.aws.amazon.com/whitepapers/latest/building-scalable-secure-multi-vpc-network-infrastructure/centralized-egress-to-internet.html",
            "https://avd.aquasec.com/misconfig/aws-vpc-no-public-egress-sgr"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "module.openshift",
            "Provider": "AWS",
            "Service": "ec2",
            "StartLine": 102,
            "EndLine": 102,
            "Code": {
              "Lines": [
                {
                  "Number": 76,
                  "Content": "resource \"aws_security_group\" \"openshift-public-egress\" {",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_security_group\"\u001b[0m \u001b[38;5;37m\"openshift-public-egress\"\u001b[0m {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 77,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 102,
                  "Content": "    cidr_blocks = [\"0.0.0.0/0\"]",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m    \u001b[38;5;245mcidr_blocks\u001b[0m = [\u001b[38;5;37m\"0.0.0.0/0\"\u001b[0m]",
                  "FirstCause": true,
                  "LastCause": true
                },
                {
                  "Number": 108,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 109,
                  "Content": "}",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "}",
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "egress",
                "Filename": "infrastructure-as-code/k8s-cluster-openshift-aws/modules/openshift/03-security-groups.tf",
                "Location": {
                  "StartLine": 98,
                  "EndLine": 103
                }
              },
              {
                "Resource": "aws_security_group.openshift-public-egress",
                "Filename": "infrastructure-as-code/k8s-cluster-openshift-aws/modules/openshift/03-security-groups.tf",
                "Location": {
                  "StartLine": 76,
                  "EndLine": 109
                }
              },
              {
                "Resource": "module.openshift",
                "Filename": "infrastructure-as-code/k8s-cluster-openshift-aws/main.tf",
                "Location": {
                  "StartLine": 42,
                  "EndLine": 54
                }
              }
            ],
            "RenderedCause": {}
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "aws-vpc-no-public-egress-sgr",
          "AVDID": "AVD-AWS-0104",
          "Title": "A security group rule should not allow unrestricted egress to any IP address.",
          "Description": "Opening up ports to connect out to the public internet is generally to be avoided. You should restrict access to IP addresses or ranges that are explicitly required where possible.\n",
          "Message": "Security group rule allows unrestricted egress to any IP address.",
          "Namespace": "builtin.aws.ec2.aws0104",
          "Query": "data.builtin.aws.ec2.aws0104.deny",
          "Resolution": "Set a more restrictive cidr range",
          "Severity": "CRITICAL",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/aws-vpc-no-public-egress-sgr",
          "References": [
            "https://docs.aws.amazon.com/whitepapers/latest/building-scalable-secure-multi-vpc-network-infrastructure/centralized-egress-to-internet.html",
            "https://avd.aquasec.com/misconfig/aws-vpc-no-public-egress-sgr"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "module.openshift",
            "Provider": "AWS",
            "Service": "ec2",
            "StartLine": 86,
            "EndLine": 86,
            "Code": {
              "Lines": [
                {
                  "Number": 76,
                  "Content": "resource \"aws_security_group\" \"openshift-public-egress\" {",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_security_group\"\u001b[0m \u001b[38;5;37m\"openshift-public-egress\"\u001b[0m {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 77,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 86,
                  "Content": "    cidr_blocks = [\"0.0.0.0/0\"]",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m    \u001b[38;5;245mcidr_blocks\u001b[0m = [\u001b[38;5;37m\"0.0.0.0/0\"\u001b[0m]",
                  "FirstCause": true,
                  "LastCause": true
                },
                {
                  "Number": 108,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 109,
                  "Content": "}",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "}",
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "egress",
                "Filename": "infrastructure-as-code/k8s-cluster-openshift-aws/modules/openshift/03-security-groups.tf",
                "Location": {
                  "StartLine": 82,
                  "EndLine": 87
                }
              },
              {
                "Resource": "aws_security_group.openshift-public-egress",
                "Filename": "infrastructure-as-code/k8s-cluster-openshift-aws/modules/openshift/03-security-groups.tf",
                "Location": {
                  "StartLine": 76,
                  "EndLine": 109
                }
              },
              {
                "Resource": "module.openshift",
                "Filename": "infrastructure-as-code/k8s-cluster-openshift-aws/main.tf",
                "Location": {
                  "StartLine": 42,
                  "EndLine": 54
                }
              }
            ],
            "RenderedCause": {}
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0107",
          "AVDID": "AVD-AWS-0107",
          "Title": "Security groups should not allow unrestricted ingress to SSH or RDP from any IP address.",
          "Description": "Security groups provide stateful filtering of ingress and egress network traffic to AWS\nresources. It is recommended that no security group allows unrestricted ingress access to\nremote server administration ports, such as SSH to port 22 and RDP to port 3389.\n",
          "Message": "Security group rule allows unrestricted ingress from any IP address.",
          "Namespace": "builtin.aws.ec2.aws0107",
          "Query": "data.builtin.aws.ec2.aws0107.deny",
          "Resolution": "Set a more restrictive CIDR range",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0107",
          "References": [
            "https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/security-group-rules-reference.html",
            "https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html#ec2-13",
            "https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html#ec2-14",
            "https://avd.aquasec.com/misconfig/avd-aws-0107"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "module.openshift",
            "Provider": "AWS",
            "Service": "ec2",
            "StartLine": 122,
            "EndLine": 122,
            "Code": {
              "Lines": [
                {
                  "Number": 112,
                  "Content": "resource \"aws_security_group\" \"openshift-ssh\" {",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_security_group\"\u001b[0m \u001b[38;5;37m\"openshift-ssh\"\u001b[0m {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 113,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 122,
                  "Content": "    cidr_blocks = [\"0.0.0.0/0\"]",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m    \u001b[38;5;245mcidr_blocks\u001b[0m = [\u001b[38;5;37m\"0.0.0.0/0\"\u001b[0m]",
                  "FirstCause": true,
                  "LastCause": true
                },
                {
                  "Number": 128,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 129,
                  "Content": "}",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "}",
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "ingress",
                "Filename": "infrastructure-as-code/k8s-cluster-openshift-aws/modules/openshift/03-security-groups.tf",
                "Location": {
                  "StartLine": 118,
                  "EndLine": 123
                }
              },
              {
                "Resource": "aws_security_group.openshift-ssh",
                "Filename": "infrastructure-as-code/k8s-cluster-openshift-aws/modules/openshift/03-security-groups.tf",
                "Location": {
                  "StartLine": 112,
                  "EndLine": 129
                }
              },
              {
                "Resource": "module.openshift",
                "Filename": "infrastructure-as-code/k8s-cluster-openshift-aws/main.tf",
                "Location": {
                  "StartLine": 42,
                  "EndLine": 54
                }
              }
            ],
            "RenderedCause": {}
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "aws-vpc-add-description-to-security-group-rule",
          "AVDID": "AVD-AWS-0124",
          "Title": "Missing description for security group rule.",
          "Description": "Security group rules should include a description for auditing purposes.\n\nSimplifies auditing, debugging, and managing security groups.\n",
          "Message": "Security group rule does not have a description.",
          "Namespace": "builtin.aws.ec2.aws0124",
          "Query": "data.builtin.aws.ec2.aws0124.deny",
          "Resolution": "Add descriptions for all security groups rules",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/aws-vpc-add-description-to-security-group-rule",
          "References": [
            "https://www.cloudconformity.com/knowledge-base/aws/EC2/security-group-rules-description.html",
            "https://avd.aquasec.com/misconfig/aws-vpc-add-description-to-security-group-rule"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "module.openshift",
            "Provider": "AWS",
            "Service": "ec2",
            "StartLine": 44,
            "EndLine": 49,
            "Code": {
              "Lines": [
                {
                  "Number": 30,
                  "Content": "resource \"aws_security_group\" \"openshift-public-ingress\" {",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_security_group\"\u001b[0m \u001b[38;5;37m\"openshift-public-ingress\"\u001b[0m {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 31,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 44,
                  "Content": "  ingress {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  ingress {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 45,
                  "Content": "    from_port   = 8080",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;245mfrom_port\u001b[0m   = \u001b[38;5;37m8080",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 46,
                  "Content": "    to_port     = 8080",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m    \u001b[38;5;245mto_port\u001b[0m     = \u001b[38;5;37m8080",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 47,
                  "Content": "    protocol    = \"tcp\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m    \u001b[38;5;245mprotocol\u001b[0m    = \u001b[38;5;37m\"tcp\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 48,
                  "Content": "    cidr_blocks = [\"0.0.0.0/0\"]",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m    \u001b[38;5;245mcidr_blocks\u001b[0m = [\u001b[38;5;37m\"0.0.0.0/0\"\u001b[0m]",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 49,
                  "Content": "  }",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  }",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 70,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 71,
                  "Content": "}",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "}",
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "aws_security_group.openshift-public-ingress",
                "Filename": "infrastructure-as-code/k8s-cluster-openshift-aws/modules/openshift/03-security-groups.tf",
                "Location": {
                  "StartLine": 30,
                  "EndLine": 71
                }
              },
              {
                "Resource": "module.openshift",
                "Filename": "infrastructure-as-code/k8s-cluster-openshift-aws/main.tf",
                "Location": {
                  "StartLine": 42,
                  "EndLine": 54
                }
              }
            ],
            "RenderedCause": {}
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "aws-vpc-add-description-to-security-group-rule",
          "AVDID": "AVD-AWS-0124",
          "Title": "Missing description for security group rule.",
          "Description": "Security group rules should include a description for auditing purposes.\n\nSimplifies auditing, debugging, and managing security groups.\n",
          "Message": "Security group rule does not have a description.",
          "Namespace": "builtin.aws.ec2.aws0124",
          "Query": "data.builtin.aws.ec2.aws0124.deny",
          "Resolution": "Add descriptions for all security groups rules",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/aws-vpc-add-description-to-security-group-rule",
          "References": [
            "https://www.cloudconformity.com/knowledge-base/aws/EC2/security-group-rules-description.html",
            "https://avd.aquasec.com/misconfig/aws-vpc-add-description-to-security-group-rule"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "module.openshift",
            "Provider": "AWS",
            "Service": "ec2",
            "StartLine": 52,
            "EndLine": 57,
            "Code": {
              "Lines": [
                {
                  "Number": 30,
                  "Content": "resource \"aws_security_group\" \"openshift-public-ingress\" {",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_security_group\"\u001b[0m \u001b[38;5;37m\"openshift-public-ingress\"\u001b[0m {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 31,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 52,
                  "Content": "  ingress {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  ingress {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 53,
                  "Content": "    from_port   = 443",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;245mfrom_port\u001b[0m   = \u001b[38;5;37m443",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 54,
                  "Content": "    to_port     = 443",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m    \u001b[38;5;245mto_port\u001b[0m     = \u001b[38;5;37m443",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 55,
                  "Content": "    protocol    = \"tcp\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m    \u001b[38;5;245mprotocol\u001b[0m    = \u001b[38;5;37m\"tcp\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 56,
                  "Content": "    cidr_blocks = [\"0.0.0.0/0\"]",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m    \u001b[38;5;245mcidr_blocks\u001b[0m = [\u001b[38;5;37m\"0.0.0.0/0\"\u001b[0m]",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 57,
                  "Content": "  }",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  }",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 70,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 71,
                  "Content": "}",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "}",
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "aws_security_group.openshift-public-ingress",
                "Filename": "infrastructure-as-code/k8s-cluster-openshift-aws/modules/openshift/03-security-groups.tf",
                "Location": {
                  "StartLine": 30,
                  "EndLine": 71
                }
              },
              {
                "Resource": "module.openshift",
                "Filename": "infrastructure-as-code/k8s-cluster-openshift-aws/main.tf",
                "Location": {
                  "StartLine": 42,
                  "EndLine": 54
                }
              }
            ],
            "RenderedCause": {}
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "aws-vpc-add-description-to-security-group-rule",
          "AVDID": "AVD-AWS-0124",
          "Title": "Missing description for security group rule.",
          "Description": "Security group rules should include a description for auditing purposes.\n\nSimplifies auditing, debugging, and managing security groups.\n",
          "Message": "Security group rule does not have a description.",
          "Namespace": "builtin.aws.ec2.aws0124",
          "Query": "data.builtin.aws.ec2.aws0124.deny",
          "Resolution": "Add descriptions for all security groups rules",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/aws-vpc-add-description-to-security-group-rule",
          "References": [
            "https://www.cloudconformity.com/knowledge-base/aws/EC2/security-group-rules-description.html",
            "https://avd.aquasec.com/misconfig/aws-vpc-add-description-to-security-group-rule"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "module.openshift",
            "Provider": "AWS",
            "Service": "ec2",
            "StartLine": 98,
            "EndLine": 103,
            "Code": {
              "Lines": [
                {
                  "Number": 76,
                  "Content": "resource \"aws_security_group\" \"openshift-public-egress\" {",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_security_group\"\u001b[0m \u001b[38;5;37m\"openshift-public-egress\"\u001b[0m {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 77,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 98,
                  "Content": "  egress {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  egress {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 99,
                  "Content": "    from_port   = 8200",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;245mfrom_port\u001b[0m   = \u001b[38;5;37m8200",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 100,
                  "Content": "    to_port     = 8200",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m    \u001b[38;5;245mto_port\u001b[0m     = \u001b[38;5;37m8200",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 101,
                  "Content": "    protocol    = \"tcp\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m    \u001b[38;5;245mprotocol\u001b[0m    = \u001b[38;5;37m\"tcp\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 102,
                  "Content": "    cidr_blocks = [\"0.0.0.0/0\"]",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m    \u001b[38;5;245mcidr_blocks\u001b[0m = [\u001b[38;5;37m\"0.0.0.0/0\"\u001b[0m]",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 103,
                  "Content": "  }",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  }",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 108,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 109,
                  "Content": "}",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "}",
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "aws_security_group.openshift-public-egress",
                "Filename": "infrastructure-as-code/k8s-cluster-openshift-aws/modules/openshift/03-security-groups.tf",
                "Location": {
                  "StartLine": 76,
                  "EndLine": 109
                }
              },
              {
                "Resource": "module.openshift",
                "Filename": "infrastructure-as-code/k8s-cluster-openshift-aws/main.tf",
                "Location": {
                  "StartLine": 42,
                  "EndLine": 54
                }
              }
            ],
            "RenderedCause": {}
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "aws-vpc-add-description-to-security-group-rule",
          "AVDID": "AVD-AWS-0124",
          "Title": "Missing description for security group rule.",
          "Description": "Security group rules should include a description for auditing purposes.\n\nSimplifies auditing, debugging, and managing security groups.\n",
          "Message": "Security group rule does not have a description.",
          "Namespace": "builtin.aws.ec2.aws0124",
          "Query": "data.builtin.aws.ec2.aws0124.deny",
          "Resolution": "Add descriptions for all security groups rules",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/aws-vpc-add-description-to-security-group-rule",
          "References": [
            "https://www.cloudconformity.com/knowledge-base/aws/EC2/security-group-rules-description.html",
            "https://avd.aquasec.com/misconfig/aws-vpc-add-description-to-security-group-rule"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "module.openshift",
            "Provider": "AWS",
            "Service": "ec2",
            "StartLine": 36,
            "EndLine": 41,
            "Code": {
              "Lines": [
                {
                  "Number": 30,
                  "Content": "resource \"aws_security_group\" \"openshift-public-ingress\" {",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_security_group\"\u001b[0m \u001b[38;5;37m\"openshift-public-ingress\"\u001b[0m {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 31,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 36,
                  "Content": "  ingress {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  ingress {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 37,
                  "Content": "    from_port   = 80",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;245mfrom_port\u001b[0m   = \u001b[38;5;37m80",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 38,
                  "Content": "    to_port     = 80",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m    \u001b[38;5;245mto_port\u001b[0m     = \u001b[38;5;37m80",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 39,
                  "Content": "    protocol    = \"tcp\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m    \u001b[38;5;245mprotocol\u001b[0m    = \u001b[38;5;37m\"tcp\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 40,
                  "Content": "    cidr_blocks = [\"0.0.0.0/0\"]",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m    \u001b[38;5;245mcidr_blocks\u001b[0m = [\u001b[38;5;37m\"0.0.0.0/0\"\u001b[0m]",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 41,
                  "Content": "  }",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  }",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 70,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 71,
                  "Content": "}",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "}",
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "aws_security_group.openshift-public-ingress",
                "Filename": "infrastructure-as-code/k8s-cluster-openshift-aws/modules/openshift/03-security-groups.tf",
                "Location": {
                  "StartLine": 30,
                  "EndLine": 71
                }
              },
              {
                "Resource": "module.openshift",
                "Filename": "infrastructure-as-code/k8s-cluster-openshift-aws/main.tf",
                "Location": {
                  "StartLine": 42,
                  "EndLine": 54
                }
              }
            ],
            "RenderedCause": {}
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "aws-vpc-add-description-to-security-group-rule",
          "AVDID": "AVD-AWS-0124",
          "Title": "Missing description for security group rule.",
          "Description": "Security group rules should include a description for auditing purposes.\n\nSimplifies auditing, debugging, and managing security groups.\n",
          "Message": "Security group rule does not have a description.",
          "Namespace": "builtin.aws.ec2.aws0124",
          "Query": "data.builtin.aws.ec2.aws0124.deny",
          "Resolution": "Add descriptions for all security groups rules",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/aws-vpc-add-description-to-security-group-rule",
          "References": [
            "https://www.cloudconformity.com/knowledge-base/aws/EC2/security-group-rules-description.html",
            "https://avd.aquasec.com/misconfig/aws-vpc-add-description-to-security-group-rule"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "module.openshift",
            "Provider": "AWS",
            "Service": "ec2",
            "StartLine": 15,
            "EndLine": 20,
            "Code": {
              "Lines": [
                {
                  "Number": 3,
                  "Content": "resource \"aws_security_group\" \"openshift-vpc\" {",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_security_group\"\u001b[0m \u001b[38;5;37m\"openshift-vpc\"\u001b[0m {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 4,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 15,
                  "Content": "  egress {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  egress {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 16,
                  "Content": "    from_port = \"0\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;245mfrom_port\u001b[0m = \u001b[38;5;37m\"0\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 17,
                  "Content": "    to_port   = \"0\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m    \u001b[38;5;245mto_port\u001b[0m   = \u001b[38;5;37m\"0\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 18,
                  "Content": "    protocol  = \"-1\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m    \u001b[38;5;245mprotocol\u001b[0m  = \u001b[38;5;37m\"-1\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "    self      = true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m    \u001b[38;5;245mself\u001b[0m      = \u001b[38;5;166mtrue",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "  }",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  }",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 25,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 26,
                  "Content": "}",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "}",
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "aws_security_group.openshift-vpc",
                "Filename": "infrastructure-as-code/k8s-cluster-openshift-aws/modules/openshift/03-security-groups.tf",
                "Location": {
                  "StartLine": 3,
                  "EndLine": 26
                }
              },
              {
                "Resource": "module.openshift",
                "Filename": "infrastructure-as-code/k8s-cluster-openshift-aws/main.tf",
                "Location": {
                  "StartLine": 42,
                  "EndLine": 54
                }
              }
            ],
            "RenderedCause": {}
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "aws-vpc-add-description-to-security-group-rule",
          "AVDID": "AVD-AWS-0124",
          "Title": "Missing description for security group rule.",
          "Description": "Security group rules should include a description for auditing purposes.\n\nSimplifies auditing, debugging, and managing security groups.\n",
          "Message": "Security group rule does not have a description.",
          "Namespace": "builtin.aws.ec2.aws0124",
          "Query": "data.builtin.aws.ec2.aws0124.deny",
          "Resolution": "Add descriptions for all security groups rules",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/aws-vpc-add-description-to-security-group-rule",
          "References": [
            "https://www.cloudconformity.com/knowledge-base/aws/EC2/security-group-rules-description.html",
            "https://avd.aquasec.com/misconfig/aws-vpc-add-description-to-security-group-rule"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "module.openshift",
            "Provider": "AWS",
            "Service": "ec2",
            "StartLine": 118,
            "EndLine": 123,
            "Code": {
              "Lines": [
                {
                  "Number": 112,
                  "Content": "resource \"aws_security_group\" \"openshift-ssh\" {",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_security_group\"\u001b[0m \u001b[38;5;37m\"openshift-ssh\"\u001b[0m {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 113,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 118,
                  "Content": "  ingress {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  ingress {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 119,
                  "Content": "    from_port   = 22",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;245mfrom_port\u001b[0m   = \u001b[38;5;37m22",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 120,
                  "Content": "    to_port     = 22",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m    \u001b[38;5;245mto_port\u001b[0m     = \u001b[38;5;37m22",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 121,
                  "Content": "    protocol    = \"tcp\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m    \u001b[38;5;245mprotocol\u001b[0m    = \u001b[38;5;37m\"tcp\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 122,
                  "Content": "    cidr_blocks = [\"0.0.0.0/0\"]",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m    \u001b[38;5;245mcidr_blocks\u001b[0m = [\u001b[38;5;37m\"0.0.0.0/0\"\u001b[0m]",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 123,
                  "Content": "  }",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  }",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 128,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 129,
                  "Content": "}",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "}",
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "aws_security_group.openshift-ssh",
                "Filename": "infrastructure-as-code/k8s-cluster-openshift-aws/modules/openshift/03-security-groups.tf",
                "Location": {
                  "StartLine": 112,
                  "EndLine": 129
                }
              },
              {
                "Resource": "module.openshift",
                "Filename": "infrastructure-as-code/k8s-cluster-openshift-aws/main.tf",
                "Location": {
                  "StartLine": 42,
                  "EndLine": 54
                }
              }
            ],
            "RenderedCause": {}
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "aws-vpc-add-description-to-security-group-rule",
          "AVDID": "AVD-AWS-0124",
          "Title": "Missing description for security group rule.",
          "Description": "Security group rules should include a description for auditing purposes.\n\nSimplifies auditing, debugging, and managing security groups.\n",
          "Message": "Security group rule does not have a description.",
          "Namespace": "builtin.aws.ec2.aws0124",
          "Query": "data.builtin.aws.ec2.aws0124.deny",
          "Resolution": "Add descriptions for all security groups rules",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/aws-vpc-add-description-to-security-group-rule",
          "References": [
            "https://www.cloudconformity.com/knowledge-base/aws/EC2/security-group-rules-description.html",
            "https://avd.aquasec.com/misconfig/aws-vpc-add-description-to-security-group-rule"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "module.openshift",
            "Provider": "AWS",
            "Service": "ec2",
            "StartLine": 60,
            "EndLine": 65,
            "Code": {
              "Lines": [
                {
                  "Number": 30,
                  "Content": "resource \"aws_security_group\" \"openshift-public-ingress\" {",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_security_group\"\u001b[0m \u001b[38;5;37m\"openshift-public-ingress\"\u001b[0m {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 31,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 60,
                  "Content": "  ingress {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  ingress {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 61,
                  "Content": "    from_port   = 8443",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;245mfrom_port\u001b[0m   = \u001b[38;5;37m8443",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 62,
                  "Content": "    to_port     = 8443",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m    \u001b[38;5;245mto_port\u001b[0m     = \u001b[38;5;37m8443",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 63,
                  "Content": "    protocol    = \"tcp\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m    \u001b[38;5;245mprotocol\u001b[0m    = \u001b[38;5;37m\"tcp\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 64,
                  "Content": "    cidr_blocks = [\"0.0.0.0/0\"]",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m    \u001b[38;5;245mcidr_blocks\u001b[0m = [\u001b[38;5;37m\"0.0.0.0/0\"\u001b[0m]",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 65,
                  "Content": "  }",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  }",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 70,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 71,
                  "Content": "}",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "}",
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "aws_security_group.openshift-public-ingress",
                "Filename": "infrastructure-as-code/k8s-cluster-openshift-aws/modules/openshift/03-security-groups.tf",
                "Location": {
                  "StartLine": 30,
                  "EndLine": 71
                }
              },
              {
                "Resource": "module.openshift",
                "Filename": "infrastructure-as-code/k8s-cluster-openshift-aws/main.tf",
                "Location": {
                  "StartLine": 42,
                  "EndLine": 54
                }
              }
            ],
            "RenderedCause": {}
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "aws-vpc-add-description-to-security-group-rule",
          "AVDID": "AVD-AWS-0124",
          "Title": "Missing description for security group rule.",
          "Description": "Security group rules should include a description for auditing purposes.\n\nSimplifies auditing, debugging, and managing security groups.\n",
          "Message": "Security group rule does not have a description.",
          "Namespace": "builtin.aws.ec2.aws0124",
          "Query": "data.builtin.aws.ec2.aws0124.deny",
          "Resolution": "Add descriptions for all security groups rules",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/aws-vpc-add-description-to-security-group-rule",
          "References": [
            "https://www.cloudconformity.com/knowledge-base/aws/EC2/security-group-rules-description.html",
            "https://avd.aquasec.com/misconfig/aws-vpc-add-description-to-security-group-rule"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "module.openshift",
            "Provider": "AWS",
            "Service": "ec2",
            "StartLine": 8,
            "EndLine": 13,
            "Code": {
              "Lines": [
                {
                  "Number": 3,
                  "Content": "resource \"aws_security_group\" \"openshift-vpc\" {",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_security_group\"\u001b[0m \u001b[38;5;37m\"openshift-vpc\"\u001b[0m {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 4,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 8,
                  "Content": "  ingress {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  ingress {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 9,
                  "Content": "    from_port = \"0\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;245mfrom_port\u001b[0m = \u001b[38;5;37m\"0\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 10,
                  "Content": "    to_port   = \"0\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m    \u001b[38;5;245mto_port\u001b[0m   = \u001b[38;5;37m\"0\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 11,
                  "Content": "    protocol  = \"-1\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m    \u001b[38;5;245mprotocol\u001b[0m  = \u001b[38;5;37m\"-1\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 12,
                  "Content": "    self      = true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m    \u001b[38;5;245mself\u001b[0m      = \u001b[38;5;166mtrue",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 13,
                  "Content": "  }",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  }",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 25,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 26,
                  "Content": "}",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "}",
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "aws_security_group.openshift-vpc",
                "Filename": "infrastructure-as-code/k8s-cluster-openshift-aws/modules/openshift/03-security-groups.tf",
                "Location": {
                  "StartLine": 3,
                  "EndLine": 26
                }
              },
              {
                "Resource": "module.openshift",
                "Filename": "infrastructure-as-code/k8s-cluster-openshift-aws/main.tf",
                "Location": {
                  "StartLine": 42,
                  "EndLine": 54
                }
              }
            ],
            "RenderedCause": {}
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "aws-vpc-add-description-to-security-group-rule",
          "AVDID": "AVD-AWS-0124",
          "Title": "Missing description for security group rule.",
          "Description": "Security group rules should include a description for auditing purposes.\n\nSimplifies auditing, debugging, and managing security groups.\n",
          "Message": "Security group rule does not have a description.",
          "Namespace": "builtin.aws.ec2.aws0124",
          "Query": "data.builtin.aws.ec2.aws0124.deny",
          "Resolution": "Add descriptions for all security groups rules",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/aws-vpc-add-description-to-security-group-rule",
          "References": [
            "https://www.cloudconformity.com/knowledge-base/aws/EC2/security-group-rules-description.html",
            "https://avd.aquasec.com/misconfig/aws-vpc-add-description-to-security-group-rule"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "module.openshift",
            "Provider": "AWS",
            "Service": "ec2",
            "StartLine": 82,
            "EndLine": 87,
            "Code": {
              "Lines": [
                {
                  "Number": 76,
                  "Content": "resource \"aws_security_group\" \"openshift-public-egress\" {",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_security_group\"\u001b[0m \u001b[38;5;37m\"openshift-public-egress\"\u001b[0m {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 77,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 82,
                  "Content": "  egress {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  egress {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 83,
                  "Content": "    from_port   = 80",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;245mfrom_port\u001b[0m   = \u001b[38;5;37m80",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 84,
                  "Content": "    to_port     = 80",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m    \u001b[38;5;245mto_port\u001b[0m     = \u001b[38;5;37m80",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 85,
                  "Content": "    protocol    = \"tcp\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m    \u001b[38;5;245mprotocol\u001b[0m    = \u001b[38;5;37m\"tcp\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 86,
                  "Content": "    cidr_blocks = [\"0.0.0.0/0\"]",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m    \u001b[38;5;245mcidr_blocks\u001b[0m = [\u001b[38;5;37m\"0.0.0.0/0\"\u001b[0m]",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 87,
                  "Content": "  }",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  }",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 108,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 109,
                  "Content": "}",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "}",
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "aws_security_group.openshift-public-egress",
                "Filename": "infrastructure-as-code/k8s-cluster-openshift-aws/modules/openshift/03-security-groups.tf",
                "Location": {
                  "StartLine": 76,
                  "EndLine": 109
                }
              },
              {
                "Resource": "module.openshift",
                "Filename": "infrastructure-as-code/k8s-cluster-openshift-aws/main.tf",
                "Location": {
                  "StartLine": 42,
                  "EndLine": 54
                }
              }
            ],
            "RenderedCause": {}
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "aws-vpc-add-description-to-security-group-rule",
          "AVDID": "AVD-AWS-0124",
          "Title": "Missing description for security group rule.",
          "Description": "Security group rules should include a description for auditing purposes.\n\nSimplifies auditing, debugging, and managing security groups.\n",
          "Message": "Security group rule does not have a description.",
          "Namespace": "builtin.aws.ec2.aws0124",
          "Query": "data.builtin.aws.ec2.aws0124.deny",
          "Resolution": "Add descriptions for all security groups rules",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/aws-vpc-add-description-to-security-group-rule",
          "References": [
            "https://www.cloudconformity.com/knowledge-base/aws/EC2/security-group-rules-description.html",
            "https://avd.aquasec.com/misconfig/aws-vpc-add-description-to-security-group-rule"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "module.openshift",
            "Provider": "AWS",
            "Service": "ec2",
            "StartLine": 90,
            "EndLine": 95,
            "Code": {
              "Lines": [
                {
                  "Number": 76,
                  "Content": "resource \"aws_security_group\" \"openshift-public-egress\" {",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_security_group\"\u001b[0m \u001b[38;5;37m\"openshift-public-egress\"\u001b[0m {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 77,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 90,
                  "Content": "  egress {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  egress {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 91,
                  "Content": "    from_port   = 443",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;245mfrom_port\u001b[0m   = \u001b[38;5;37m443",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 92,
                  "Content": "    to_port     = 443",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m    \u001b[38;5;245mto_port\u001b[0m     = \u001b[38;5;37m443",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 93,
                  "Content": "    protocol    = \"tcp\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m    \u001b[38;5;245mprotocol\u001b[0m    = \u001b[38;5;37m\"tcp\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 94,
                  "Content": "    cidr_blocks = [\"0.0.0.0/0\"]",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m    \u001b[38;5;245mcidr_blocks\u001b[0m = [\u001b[38;5;37m\"0.0.0.0/0\"\u001b[0m]",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 95,
                  "Content": "  }",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  }",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 108,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 109,
                  "Content": "}",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "}",
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "aws_security_group.openshift-public-egress",
                "Filename": "infrastructure-as-code/k8s-cluster-openshift-aws/modules/openshift/03-security-groups.tf",
                "Location": {
                  "StartLine": 76,
                  "EndLine": 109
                }
              },
              {
                "Resource": "module.openshift",
                "Filename": "infrastructure-as-code/k8s-cluster-openshift-aws/main.tf",
                "Location": {
                  "StartLine": 42,
                  "EndLine": 54
                }
              }
            ],
            "RenderedCause": {}
          }
        }
      ]
    },
    {
      "Target": "infrastructure-as-code/k8s-cluster-openshift-aws/modules/openshift/05-nodes.tf",
      "Class": "config",
      "Type": "terraform",
      "MisconfSummary": {
        "Successes": 0,
        "Failures": 6
      },
      "Misconfigurations": [
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0028",
          "AVDID": "AVD-AWS-0028",
          "Title": "aws_instance should activate session tokens for Instance Metadata Service.",
          "Description": "IMDS v2 (Instance Metadata Service) introduced session authentication tokens which improve security when talking to IMDS.\n\nBy default \u003ccode\u003eaws_instance\u003c/code\u003e resource sets IMDS session auth tokens to be optional.\n\nTo fully protect IMDS you need to enable session tokens by using \u003ccode\u003emetadata_options\u003c/code\u003e block and its \u003ccode\u003ehttp_tokens\u003c/code\u003e variable set to \u003ccode\u003erequired\u003c/code\u003e.\n",
          "Message": "Instance does not require IMDS access to require a token.",
          "Namespace": "builtin.aws.ec2.aws0028",
          "Query": "data.builtin.aws.ec2.aws0028.deny",
          "Resolution": "Enable HTTP token requirement for IMDS",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0028",
          "References": [
            "https://aws.amazon.com/blogs/security/defense-in-depth-open-firewalls-reverse-proxies-ssrf-vulnerabilities-ec2-instance-metadata-service",
            "https://avd.aquasec.com/misconfig/avd-aws-0028"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "module.openshift",
            "Provider": "AWS",
            "Service": "ec2",
            "StartLine": 9,
            "EndLine": 43,
            "Code": {
              "Lines": [
                {
                  "Number": 9,
                  "Content": "resource \"aws_instance\" \"master\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_instance\"\u001b[0m \u001b[38;5;37m\"master\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 10,
                  "Content": "  ami                  = \"${data.aws_ami.rhel7_5.id}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mami\u001b[0m                  = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mdata\u001b[0m.aws_ami.rhel7_5.id\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"\u001b[0m",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 11,
                  "Content": "  # Master nodes require at least 16GB of memory.",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;239m  # Master nodes require at least 16GB of memory.",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 12,
                  "Content": "  instance_type        = \"m4.xlarge\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245minstance_type\u001b[0m        = \u001b[38;5;37m\"m4.xlarge\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 13,
                  "Content": "  subnet_id            = \"${aws_subnet.public-subnet.id}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245msubnet_id\u001b[0m            = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0maws_subnet.public\u001b[38;5;245m-\u001b[0msubnet.id\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 14,
                  "Content": "  iam_instance_profile = \"${aws_iam_instance_profile.openshift-instance-profile.id}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245miam_instance_profile\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0maws_iam_instance_profile.openshift\u001b[38;5;245m-\u001b[0minstance\u001b[38;5;245m-\u001b[0mprofile.id\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 15,
                  "Content": "  user_data            = \"${data.template_file.setup-master.rendered}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245muser_data\u001b[0m            = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mdata\u001b[0m.template_file.setup\u001b[38;5;245m-\u001b[0mmaster.rendered\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 16,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 17,
                  "Content": "  vpc_security_group_ids = [",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mvpc_security_group_ids\u001b[0m = [",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 18,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "module.openshift",
                "Filename": "infrastructure-as-code/k8s-cluster-openshift-aws/main.tf",
                "Location": {
                  "StartLine": 42,
                  "EndLine": 54
                }
              }
            ],
            "RenderedCause": {}
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0028",
          "AVDID": "AVD-AWS-0028",
          "Title": "aws_instance should activate session tokens for Instance Metadata Service.",
          "Description": "IMDS v2 (Instance Metadata Service) introduced session authentication tokens which improve security when talking to IMDS.\n\nBy default \u003ccode\u003eaws_instance\u003c/code\u003e resource sets IMDS session auth tokens to be optional.\n\nTo fully protect IMDS you need to enable session tokens by using \u003ccode\u003emetadata_options\u003c/code\u003e block and its \u003ccode\u003ehttp_tokens\u003c/code\u003e variable set to \u003ccode\u003erequired\u003c/code\u003e.\n",
          "Message": "Instance does not require IMDS access to require a token.",
          "Namespace": "builtin.aws.ec2.aws0028",
          "Query": "data.builtin.aws.ec2.aws0028.deny",
          "Resolution": "Enable HTTP token requirement for IMDS",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0028",
          "References": [
            "https://aws.amazon.com/blogs/security/defense-in-depth-open-firewalls-reverse-proxies-ssrf-vulnerabilities-ec2-instance-metadata-service",
            "https://avd.aquasec.com/misconfig/avd-aws-0028"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "module.openshift",
            "Provider": "AWS",
            "Service": "ec2",
            "StartLine": 53,
            "EndLine": 86,
            "Code": {
              "Lines": [
                {
                  "Number": 53,
                  "Content": "resource \"aws_instance\" \"node1\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_instance\"\u001b[0m \u001b[38;5;37m\"node1\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 54,
                  "Content": "  ami                  = \"${data.aws_ami.rhel7_5.id}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mami\u001b[0m                  = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mdata\u001b[0m.aws_ami.rhel7_5.id\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 55,
                  "Content": "  instance_type        = \"${var.amisize}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245minstance_type\u001b[0m        = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.amisize\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 56,
                  "Content": "  subnet_id            = \"${aws_subnet.public-subnet.id}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245msubnet_id\u001b[0m            = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0maws_subnet.public\u001b[38;5;245m-\u001b[0msubnet.id\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 57,
                  "Content": "  iam_instance_profile = \"${aws_iam_instance_profile.openshift-instance-profile.id}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245miam_instance_profile\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0maws_iam_instance_profile.openshift\u001b[38;5;245m-\u001b[0minstance\u001b[38;5;245m-\u001b[0mprofile.id\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 58,
                  "Content": "  user_data            = \"${data.template_file.setup-node.rendered}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245muser_data\u001b[0m            = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mdata\u001b[0m.template_file.setup\u001b[38;5;245m-\u001b[0mnode.rendered\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 59,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 60,
                  "Content": "  vpc_security_group_ids = [",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mvpc_security_group_ids\u001b[0m = [",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 61,
                  "Content": "    \"${aws_security_group.openshift-vpc.id}\",",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0maws_security_group.openshift\u001b[38;5;245m-\u001b[0mvpc.id\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"\u001b[0m,",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 62,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "module.openshift",
                "Filename": "infrastructure-as-code/k8s-cluster-openshift-aws/main.tf",
                "Location": {
                  "StartLine": 42,
                  "EndLine": 54
                }
              }
            ],
            "RenderedCause": {}
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0131",
          "AVDID": "AVD-AWS-0131",
          "Title": "Instance with unencrypted block device.",
          "Description": "Block devices should be encrypted to ensure sensitive data is held securely at rest.\n",
          "Message": "EBS block device is not encrypted.",
          "Namespace": "builtin.aws.ec2.aws0131",
          "Query": "data.builtin.aws.ec2.aws0131.deny",
          "Resolution": "Turn on encryption for all block devices",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0131",
          "References": [
            "https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/RootDeviceStorage.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0131"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "module.openshift",
            "Provider": "AWS",
            "Service": "ec2",
            "StartLine": 9,
            "EndLine": 43,
            "Code": {
              "Lines": [
                {
                  "Number": 9,
                  "Content": "resource \"aws_instance\" \"master\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_instance\"\u001b[0m \u001b[38;5;37m\"master\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 10,
                  "Content": "  ami                  = \"${data.aws_ami.rhel7_5.id}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mami\u001b[0m                  = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mdata\u001b[0m.aws_ami.rhel7_5.id\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"\u001b[0m",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 11,
                  "Content": "  # Master nodes require at least 16GB of memory.",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;239m  # Master nodes require at least 16GB of memory.",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 12,
                  "Content": "  instance_type        = \"m4.xlarge\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245minstance_type\u001b[0m        = \u001b[38;5;37m\"m4.xlarge\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 13,
                  "Content": "  subnet_id            = \"${aws_subnet.public-subnet.id}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245msubnet_id\u001b[0m            = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0maws_subnet.public\u001b[38;5;245m-\u001b[0msubnet.id\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 14,
                  "Content": "  iam_instance_profile = \"${aws_iam_instance_profile.openshift-instance-profile.id}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245miam_instance_profile\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0maws_iam_instance_profile.openshift\u001b[38;5;245m-\u001b[0minstance\u001b[38;5;245m-\u001b[0mprofile.id\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 15,
                  "Content": "  user_data            = \"${data.template_file.setup-master.rendered}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245muser_data\u001b[0m            = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mdata\u001b[0m.template_file.setup\u001b[38;5;245m-\u001b[0mmaster.rendered\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 16,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 17,
                  "Content": "  vpc_security_group_ids = [",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mvpc_security_group_ids\u001b[0m = [",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 18,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "module.openshift",
                "Filename": "infrastructure-as-code/k8s-cluster-openshift-aws/main.tf",
                "Location": {
                  "StartLine": 42,
                  "EndLine": 54
                }
              }
            ],
            "RenderedCause": {}
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0131",
          "AVDID": "AVD-AWS-0131",
          "Title": "Instance with unencrypted block device.",
          "Description": "Block devices should be encrypted to ensure sensitive data is held securely at rest.\n",
          "Message": "EBS block device is not encrypted.",
          "Namespace": "builtin.aws.ec2.aws0131",
          "Query": "data.builtin.aws.ec2.aws0131.deny",
          "Resolution": "Turn on encryption for all block devices",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0131",
          "References": [
            "https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/RootDeviceStorage.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0131"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "module.openshift",
            "Provider": "AWS",
            "Service": "ec2",
            "StartLine": 53,
            "EndLine": 86,
            "Code": {
              "Lines": [
                {
                  "Number": 53,
                  "Content": "resource \"aws_instance\" \"node1\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_instance\"\u001b[0m \u001b[38;5;37m\"node1\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 54,
                  "Content": "  ami                  = \"${data.aws_ami.rhel7_5.id}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mami\u001b[0m                  = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mdata\u001b[0m.aws_ami.rhel7_5.id\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 55,
                  "Content": "  instance_type        = \"${var.amisize}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245minstance_type\u001b[0m        = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.amisize\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 56,
                  "Content": "  subnet_id            = \"${aws_subnet.public-subnet.id}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245msubnet_id\u001b[0m            = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0maws_subnet.public\u001b[38;5;245m-\u001b[0msubnet.id\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 57,
                  "Content": "  iam_instance_profile = \"${aws_iam_instance_profile.openshift-instance-profile.id}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245miam_instance_profile\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0maws_iam_instance_profile.openshift\u001b[38;5;245m-\u001b[0minstance\u001b[38;5;245m-\u001b[0mprofile.id\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 58,
                  "Content": "  user_data            = \"${data.template_file.setup-node.rendered}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245muser_data\u001b[0m            = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mdata\u001b[0m.template_file.setup\u001b[38;5;245m-\u001b[0mnode.rendered\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 59,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 60,
                  "Content": "  vpc_security_group_ids = [",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mvpc_security_group_ids\u001b[0m = [",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 61,
                  "Content": "    \"${aws_security_group.openshift-vpc.id}\",",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0maws_security_group.openshift\u001b[38;5;245m-\u001b[0mvpc.id\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"\u001b[0m,",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 62,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "module.openshift",
                "Filename": "infrastructure-as-code/k8s-cluster-openshift-aws/main.tf",
                "Location": {
                  "StartLine": 42,
                  "EndLine": 54
                }
              }
            ],
            "RenderedCause": {}
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0131",
          "AVDID": "AVD-AWS-0131",
          "Title": "Instance with unencrypted block device.",
          "Description": "Block devices should be encrypted to ensure sensitive data is held securely at rest.\n",
          "Message": "Root block device is not encrypted.",
          "Namespace": "builtin.aws.ec2.aws0131",
          "Query": "data.builtin.aws.ec2.aws0131.deny",
          "Resolution": "Turn on encryption for all block devices",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0131",
          "References": [
            "https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/RootDeviceStorage.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0131"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "module.openshift",
            "Provider": "AWS",
            "Service": "ec2",
            "StartLine": 9,
            "EndLine": 43,
            "Code": {
              "Lines": [
                {
                  "Number": 9,
                  "Content": "resource \"aws_instance\" \"master\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_instance\"\u001b[0m \u001b[38;5;37m\"master\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 10,
                  "Content": "  ami                  = \"${data.aws_ami.rhel7_5.id}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mami\u001b[0m                  = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mdata\u001b[0m.aws_ami.rhel7_5.id\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"\u001b[0m",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 11,
                  "Content": "  # Master nodes require at least 16GB of memory.",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;239m  # Master nodes require at least 16GB of memory.",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 12,
                  "Content": "  instance_type        = \"m4.xlarge\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245minstance_type\u001b[0m        = \u001b[38;5;37m\"m4.xlarge\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 13,
                  "Content": "  subnet_id            = \"${aws_subnet.public-subnet.id}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245msubnet_id\u001b[0m            = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0maws_subnet.public\u001b[38;5;245m-\u001b[0msubnet.id\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 14,
                  "Content": "  iam_instance_profile = \"${aws_iam_instance_profile.openshift-instance-profile.id}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245miam_instance_profile\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0maws_iam_instance_profile.openshift\u001b[38;5;245m-\u001b[0minstance\u001b[38;5;245m-\u001b[0mprofile.id\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 15,
                  "Content": "  user_data            = \"${data.template_file.setup-master.rendered}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245muser_data\u001b[0m            = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mdata\u001b[0m.template_file.setup\u001b[38;5;245m-\u001b[0mmaster.rendered\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 16,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 17,
                  "Content": "  vpc_security_group_ids = [",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mvpc_security_group_ids\u001b[0m = [",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 18,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "module.openshift",
                "Filename": "infrastructure-as-code/k8s-cluster-openshift-aws/main.tf",
                "Location": {
                  "StartLine": 42,
                  "EndLine": 54
                }
              }
            ],
            "RenderedCause": {}
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0131",
          "AVDID": "AVD-AWS-0131",
          "Title": "Instance with unencrypted block device.",
          "Description": "Block devices should be encrypted to ensure sensitive data is held securely at rest.\n",
          "Message": "Root block device is not encrypted.",
          "Namespace": "builtin.aws.ec2.aws0131",
          "Query": "data.builtin.aws.ec2.aws0131.deny",
          "Resolution": "Turn on encryption for all block devices",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0131",
          "References": [
            "https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/RootDeviceStorage.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0131"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "module.openshift",
            "Provider": "AWS",
            "Service": "ec2",
            "StartLine": 53,
            "EndLine": 86,
            "Code": {
              "Lines": [
                {
                  "Number": 53,
                  "Content": "resource \"aws_instance\" \"node1\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_instance\"\u001b[0m \u001b[38;5;37m\"node1\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 54,
                  "Content": "  ami                  = \"${data.aws_ami.rhel7_5.id}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mami\u001b[0m                  = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mdata\u001b[0m.aws_ami.rhel7_5.id\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 55,
                  "Content": "  instance_type        = \"${var.amisize}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245minstance_type\u001b[0m        = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.amisize\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 56,
                  "Content": "  subnet_id            = \"${aws_subnet.public-subnet.id}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245msubnet_id\u001b[0m            = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0maws_subnet.public\u001b[38;5;245m-\u001b[0msubnet.id\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 57,
                  "Content": "  iam_instance_profile = \"${aws_iam_instance_profile.openshift-instance-profile.id}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245miam_instance_profile\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0maws_iam_instance_profile.openshift\u001b[38;5;245m-\u001b[0minstance\u001b[38;5;245m-\u001b[0mprofile.id\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 58,
                  "Content": "  user_data            = \"${data.template_file.setup-node.rendered}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245muser_data\u001b[0m            = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mdata\u001b[0m.template_file.setup\u001b[38;5;245m-\u001b[0mnode.rendered\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 59,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 60,
                  "Content": "  vpc_security_group_ids = [",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mvpc_security_group_ids\u001b[0m = [",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 61,
                  "Content": "    \"${aws_security_group.openshift-vpc.id}\",",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0maws_security_group.openshift\u001b[38;5;245m-\u001b[0mvpc.id\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"\u001b[0m,",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 62,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "module.openshift",
                "Filename": "infrastructure-as-code/k8s-cluster-openshift-aws/main.tf",
                "Location": {
                  "StartLine": 42,
                  "EndLine": 54
                }
              }
            ],
            "RenderedCause": {}
          }
        }
      ]
    },
    {
      "Target": "infrastructure-as-code/k8s-cluster-openshift-aws/modules/openshift/07-bastion.tf",
      "Class": "config",
      "Type": "terraform",
      "MisconfSummary": {
        "Successes": 0,
        "Failures": 2
      },
      "Misconfigurations": [
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0028",
          "AVDID": "AVD-AWS-0028",
          "Title": "aws_instance should activate session tokens for Instance Metadata Service.",
          "Description": "IMDS v2 (Instance Metadata Service) introduced session authentication tokens which improve security when talking to IMDS.\n\nBy default \u003ccode\u003eaws_instance\u003c/code\u003e resource sets IMDS session auth tokens to be optional.\n\nTo fully protect IMDS you need to enable session tokens by using \u003ccode\u003emetadata_options\u003c/code\u003e block and its \u003ccode\u003ehttp_tokens\u003c/code\u003e variable set to \u003ccode\u003erequired\u003c/code\u003e.\n",
          "Message": "Instance does not require IMDS access to require a token.",
          "Namespace": "builtin.aws.ec2.aws0028",
          "Query": "data.builtin.aws.ec2.aws0028.deny",
          "Resolution": "Enable HTTP token requirement for IMDS",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0028",
          "References": [
            "https://aws.amazon.com/blogs/security/defense-in-depth-open-firewalls-reverse-proxies-ssrf-vulnerabilities-ec2-instance-metadata-service",
            "https://avd.aquasec.com/misconfig/avd-aws-0028"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "module.openshift",
            "Provider": "AWS",
            "Service": "ec2",
            "StartLine": 25,
            "EndLine": 54,
            "Code": {
              "Lines": [
                {
                  "Number": 25,
                  "Content": "resource \"aws_instance\" \"bastion\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_instance\"\u001b[0m \u001b[38;5;37m\"bastion\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 26,
                  "Content": "  ami                  = \"${data.aws_ami.amazonlinux.id}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mami\u001b[0m                  = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mdata\u001b[0m.aws_ami.amazonlinux.id\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 27,
                  "Content": "  instance_type        = \"t2.micro\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245minstance_type\u001b[0m        = \u001b[38;5;37m\"t2.micro\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 28,
                  "Content": "  subnet_id            = \"${aws_subnet.public-subnet.id}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245msubnet_id\u001b[0m            = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0maws_subnet.public\u001b[38;5;245m-\u001b[0msubnet.id\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 29,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 30,
                  "Content": "  vpc_security_group_ids = [",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mvpc_security_group_ids\u001b[0m = [",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 31,
                  "Content": "    \"${aws_security_group.openshift-vpc.id}\",",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0maws_security_group.openshift\u001b[38;5;245m-\u001b[0mvpc.id\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"\u001b[0m,",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 32,
                  "Content": "    \"${aws_security_group.openshift-ssh.id}\",",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0maws_security_group.openshift\u001b[38;5;245m-\u001b[0mssh.id\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"\u001b[0m,",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 33,
                  "Content": "    \"${aws_security_group.openshift-public-egress.id}\",",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0maws_security_group.openshift\u001b[38;5;245m-\u001b[0mpublic\u001b[38;5;245m-\u001b[0megress.id\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"\u001b[0m,",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 34,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "module.openshift",
                "Filename": "infrastructure-as-code/k8s-cluster-openshift-aws/main.tf",
                "Location": {
                  "StartLine": 42,
                  "EndLine": 54
                }
              }
            ],
            "RenderedCause": {}
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0131",
          "AVDID": "AVD-AWS-0131",
          "Title": "Instance with unencrypted block device.",
          "Description": "Block devices should be encrypted to ensure sensitive data is held securely at rest.\n",
          "Message": "Root block device is not encrypted.",
          "Namespace": "builtin.aws.ec2.aws0131",
          "Query": "data.builtin.aws.ec2.aws0131.deny",
          "Resolution": "Turn on encryption for all block devices",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0131",
          "References": [
            "https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/RootDeviceStorage.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0131"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "module.openshift",
            "Provider": "AWS",
            "Service": "ec2",
            "StartLine": 25,
            "EndLine": 54,
            "Code": {
              "Lines": [
                {
                  "Number": 25,
                  "Content": "resource \"aws_instance\" \"bastion\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_instance\"\u001b[0m \u001b[38;5;37m\"bastion\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 26,
                  "Content": "  ami                  = \"${data.aws_ami.amazonlinux.id}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mami\u001b[0m                  = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mdata\u001b[0m.aws_ami.amazonlinux.id\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 27,
                  "Content": "  instance_type        = \"t2.micro\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245minstance_type\u001b[0m        = \u001b[38;5;37m\"t2.micro\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 28,
                  "Content": "  subnet_id            = \"${aws_subnet.public-subnet.id}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245msubnet_id\u001b[0m            = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0maws_subnet.public\u001b[38;5;245m-\u001b[0msubnet.id\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 29,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 30,
                  "Content": "  vpc_security_group_ids = [",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mvpc_security_group_ids\u001b[0m = [",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 31,
                  "Content": "    \"${aws_security_group.openshift-vpc.id}\",",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0maws_security_group.openshift\u001b[38;5;245m-\u001b[0mvpc.id\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"\u001b[0m,",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 32,
                  "Content": "    \"${aws_security_group.openshift-ssh.id}\",",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0maws_security_group.openshift\u001b[38;5;245m-\u001b[0mssh.id\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"\u001b[0m,",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 33,
                  "Content": "    \"${aws_security_group.openshift-public-egress.id}\",",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0maws_security_group.openshift\u001b[38;5;245m-\u001b[0mpublic\u001b[38;5;245m-\u001b[0megress.id\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"\u001b[0m,",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 34,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "module.openshift",
                "Filename": "infrastructure-as-code/k8s-cluster-openshift-aws/main.tf",
                "Location": {
                  "StartLine": 42,
                  "EndLine": 54
                }
              }
            ],
            "RenderedCause": {}
          }
        }
      ]
    },
    {
      "Target": "infrastructure-as-code/k8s-cluster-openshift-aws/vault-reviewer-rbac.yaml",
      "Class": "config",
      "Type": "kubernetes",
      "MisconfSummary": {
        "Successes": 62,
        "Failures": 0
      }
    },
    {
      "Target": "infrastructure-as-code/k8s-cluster-openshift-aws/vault-reviewer.yaml",
      "Class": "config",
      "Type": "kubernetes",
      "MisconfSummary": {
        "Successes": 62,
        "Failures": 0
      }
    },
    {
      "Target": "infrastructure-as-code/k8s-vault-config",
      "Class": "config",
      "Type": "terraform",
      "MisconfSummary": {
        "Successes": 37,
        "Failures": 0
      }
    },
    {
      "Target": "infrastructure-as-code/s3-buckets-and-policies",
      "Class": "config",
      "Type": "terraform",
      "MisconfSummary": {
        "Successes": 41,
        "Failures": 0
      }
    },
    {
      "Target": "infrastructure-as-code/s3-buckets-and-policies/main.tf",
      "Class": "config",
      "Type": "terraform",
      "MisconfSummary": {
        "Successes": 0,
        "Failures": 22
      },
      "Misconfigurations": [
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0065",
          "AVDID": "AVD-AWS-0065",
          "Title": "A KMS key is not configured to auto-rotate.",
          "Description": "You should configure your KMS keys to auto rotate to maintain security and defend against compromise.\n",
          "Message": "Key does not have rotation enabled.",
          "Namespace": "builtin.aws.kms.aws0065",
          "Query": "data.builtin.aws.kms.aws0065.deny",
          "Resolution": "Configure KMS key to auto rotate",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0065",
          "References": [
            "https://docs.aws.amazon.com/kms/latest/developerguide/rotate-keys.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0065"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "aws_kms_key.my_key",
            "Provider": "AWS",
            "Service": "kms",
            "StartLine": 39,
            "EndLine": 42,
            "Code": {
              "Lines": [
                {
                  "Number": 39,
                  "Content": "resource \"aws_kms_key\" \"my_key\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_kms_key\"\u001b[0m \u001b[38;5;37m\"my_key\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 40,
                  "Content": "  description             = \"This key is used to encrypt bucket objects\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mdescription\u001b[0m             = \u001b[38;5;37m\"This key is used to encrypt bucket objects\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 41,
                  "Content": "  deletion_window_in_days = 10",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mdeletion_window_in_days\u001b[0m = \u001b[38;5;37m10",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 42,
                  "Content": "}",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m}",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0086",
          "AVDID": "AVD-AWS-0086",
          "Title": "S3 Access block should block public ACL",
          "Description": "S3 buckets should block public ACLs on buckets and any objects they contain. By blocking, PUTs with fail if the object has any public ACL a.\n",
          "Message": "No public access block so not blocking public acls",
          "Namespace": "builtin.aws.s3.aws0086",
          "Query": "data.builtin.aws.s3.aws0086.deny",
          "Resolution": "Enable blocking any PUT calls with a public ACL specified",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0086",
          "References": [
            "https://docs.aws.amazon.com/AmazonS3/latest/userguide/access-control-block-public-access.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0086"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "aws_s3_bucket.bucket_0",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 44,
            "EndLine": 72,
            "Code": {
              "Lines": [
                {
                  "Number": 44,
                  "Content": "resource \"aws_s3_bucket\" \"bucket_0\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_s3_bucket\"\u001b[0m \u001b[38;5;37m\"bucket_0\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 45,
                  "Content": "  bucket = var.bucket_name",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mbucket\u001b[0m = \u001b[38;5;33mvar\u001b[0m.bucket_name",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 46,
                  "Content": "  acl    = var.bucket_acl",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245macl\u001b[0m    = \u001b[38;5;33mvar\u001b[0m.bucket_acl",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 47,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 48,
                  "Content": "  policy = \u003c\u003cPOLICY",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mpolicy\u001b[0m = \u001b[38;5;245m\u003c\u003cPOLICY\u001b[0m",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 49,
                  "Content": "{",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;37m{",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 50,
                  "Content": "  \"Version\":\"2012-10-17\",",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \"Version\":\"2012-10-17\",",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 51,
                  "Content": "  \"Statement\":[",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \"Statement\":[",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 52,
                  "Content": "    {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    {",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 53,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0086",
          "AVDID": "AVD-AWS-0086",
          "Title": "S3 Access block should block public ACL",
          "Description": "S3 buckets should block public ACLs on buckets and any objects they contain. By blocking, PUTs with fail if the object has any public ACL a.\n",
          "Message": "No public access block so not blocking public acls",
          "Namespace": "builtin.aws.s3.aws0086",
          "Query": "data.builtin.aws.s3.aws0086.deny",
          "Resolution": "Enable blocking any PUT calls with a public ACL specified",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0086",
          "References": [
            "https://docs.aws.amazon.com/AmazonS3/latest/userguide/access-control-block-public-access.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0086"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "aws_s3_bucket.bucket_1",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 74,
            "EndLine": 87,
            "Code": {
              "Lines": [
                {
                  "Number": 74,
                  "Content": "resource \"aws_s3_bucket\" \"bucket_1\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_s3_bucket\"\u001b[0m \u001b[38;5;37m\"bucket_1\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 75,
                  "Content": "  bucket = \"roger-bucket-1\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mbucket\u001b[0m = \u001b[38;5;37m\"roger-bucket-1\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 76,
                  "Content": "  acl    = var.bucket_acl",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245macl\u001b[0m    = \u001b[38;5;33mvar\u001b[0m.bucket_acl",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 77,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 78,
                  "Content": "  server_side_encryption_configuration {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  server_side_encryption_configuration {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 79,
                  "Content": "    rule {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    rule {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 80,
                  "Content": "      apply_server_side_encryption_by_default {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      apply_server_side_encryption_by_default {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 81,
                  "Content": "        kms_master_key_id = aws_kms_key.my_key.arn",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;245mkms_master_key_id\u001b[0m = aws_kms_key.my_key.arn",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 82,
                  "Content": "        sse_algorithm     = \"aws:kms\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;245msse_algorithm\u001b[0m     = \u001b[38;5;37m\"aws:kms\"",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 83,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0086",
          "AVDID": "AVD-AWS-0086",
          "Title": "S3 Access block should block public ACL",
          "Description": "S3 buckets should block public ACLs on buckets and any objects they contain. By blocking, PUTs with fail if the object has any public ACL a.\n",
          "Message": "No public access block so not blocking public acls",
          "Namespace": "builtin.aws.s3.aws0086",
          "Query": "data.builtin.aws.s3.aws0086.deny",
          "Resolution": "Enable blocking any PUT calls with a public ACL specified",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0086",
          "References": [
            "https://docs.aws.amazon.com/AmazonS3/latest/userguide/access-control-block-public-access.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0086"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "aws_s3_bucket.bucket_2",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 89,
            "EndLine": 102,
            "Code": {
              "Lines": [
                {
                  "Number": 89,
                  "Content": "resource \"aws_s3_bucket\" \"bucket_2\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_s3_bucket\"\u001b[0m \u001b[38;5;37m\"bucket_2\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 90,
                  "Content": "  bucket = \"roger-bucket-2\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mbucket\u001b[0m = \u001b[38;5;37m\"roger-bucket-2\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 91,
                  "Content": "  acl    = var.bucket_acl",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245macl\u001b[0m    = \u001b[38;5;33mvar\u001b[0m.bucket_acl",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 92,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 93,
                  "Content": "  server_side_encryption_configuration {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  server_side_encryption_configuration {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 94,
                  "Content": "    rule {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    rule {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 95,
                  "Content": "      apply_server_side_encryption_by_default {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      apply_server_side_encryption_by_default {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 96,
                  "Content": "        kms_master_key_id = aws_kms_key.my_key.arn",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;245mkms_master_key_id\u001b[0m = aws_kms_key.my_key.arn",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 97,
                  "Content": "        sse_algorithm     = \"aws:kms\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;245msse_algorithm\u001b[0m     = \u001b[38;5;37m\"aws:kms\"",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 98,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0087",
          "AVDID": "AVD-AWS-0087",
          "Title": "S3 Access block should block public policy",
          "Description": "S3 bucket policy should have block public policy to prevent users from putting a policy that enable public access.\n",
          "Message": "No public access block so not blocking public policies",
          "Namespace": "builtin.aws.s3.aws0087",
          "Query": "data.builtin.aws.s3.aws0087.deny",
          "Resolution": "Prevent policies that allow public access being PUT",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0087",
          "References": [
            "https://docs.aws.amazon.com/AmazonS3/latest/dev-retired/access-control-block-public-access.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0087"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "aws_s3_bucket.bucket_0",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 44,
            "EndLine": 72,
            "Code": {
              "Lines": [
                {
                  "Number": 44,
                  "Content": "resource \"aws_s3_bucket\" \"bucket_0\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_s3_bucket\"\u001b[0m \u001b[38;5;37m\"bucket_0\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 45,
                  "Content": "  bucket = var.bucket_name",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mbucket\u001b[0m = \u001b[38;5;33mvar\u001b[0m.bucket_name",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 46,
                  "Content": "  acl    = var.bucket_acl",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245macl\u001b[0m    = \u001b[38;5;33mvar\u001b[0m.bucket_acl",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 47,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 48,
                  "Content": "  policy = \u003c\u003cPOLICY",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mpolicy\u001b[0m = \u001b[38;5;245m\u003c\u003cPOLICY\u001b[0m",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 49,
                  "Content": "{",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;37m{",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 50,
                  "Content": "  \"Version\":\"2012-10-17\",",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \"Version\":\"2012-10-17\",",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 51,
                  "Content": "  \"Statement\":[",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \"Statement\":[",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 52,
                  "Content": "    {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    {",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 53,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0087",
          "AVDID": "AVD-AWS-0087",
          "Title": "S3 Access block should block public policy",
          "Description": "S3 bucket policy should have block public policy to prevent users from putting a policy that enable public access.\n",
          "Message": "No public access block so not blocking public policies",
          "Namespace": "builtin.aws.s3.aws0087",
          "Query": "data.builtin.aws.s3.aws0087.deny",
          "Resolution": "Prevent policies that allow public access being PUT",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0087",
          "References": [
            "https://docs.aws.amazon.com/AmazonS3/latest/dev-retired/access-control-block-public-access.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0087"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "aws_s3_bucket.bucket_1",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 74,
            "EndLine": 87,
            "Code": {
              "Lines": [
                {
                  "Number": 74,
                  "Content": "resource \"aws_s3_bucket\" \"bucket_1\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_s3_bucket\"\u001b[0m \u001b[38;5;37m\"bucket_1\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 75,
                  "Content": "  bucket = \"roger-bucket-1\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mbucket\u001b[0m = \u001b[38;5;37m\"roger-bucket-1\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 76,
                  "Content": "  acl    = var.bucket_acl",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245macl\u001b[0m    = \u001b[38;5;33mvar\u001b[0m.bucket_acl",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 77,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 78,
                  "Content": "  server_side_encryption_configuration {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  server_side_encryption_configuration {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 79,
                  "Content": "    rule {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    rule {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 80,
                  "Content": "      apply_server_side_encryption_by_default {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      apply_server_side_encryption_by_default {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 81,
                  "Content": "        kms_master_key_id = aws_kms_key.my_key.arn",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;245mkms_master_key_id\u001b[0m = aws_kms_key.my_key.arn",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 82,
                  "Content": "        sse_algorithm     = \"aws:kms\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;245msse_algorithm\u001b[0m     = \u001b[38;5;37m\"aws:kms\"",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 83,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0087",
          "AVDID": "AVD-AWS-0087",
          "Title": "S3 Access block should block public policy",
          "Description": "S3 bucket policy should have block public policy to prevent users from putting a policy that enable public access.\n",
          "Message": "No public access block so not blocking public policies",
          "Namespace": "builtin.aws.s3.aws0087",
          "Query": "data.builtin.aws.s3.aws0087.deny",
          "Resolution": "Prevent policies that allow public access being PUT",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0087",
          "References": [
            "https://docs.aws.amazon.com/AmazonS3/latest/dev-retired/access-control-block-public-access.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0087"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "aws_s3_bucket.bucket_2",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 89,
            "EndLine": 102,
            "Code": {
              "Lines": [
                {
                  "Number": 89,
                  "Content": "resource \"aws_s3_bucket\" \"bucket_2\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_s3_bucket\"\u001b[0m \u001b[38;5;37m\"bucket_2\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 90,
                  "Content": "  bucket = \"roger-bucket-2\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mbucket\u001b[0m = \u001b[38;5;37m\"roger-bucket-2\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 91,
                  "Content": "  acl    = var.bucket_acl",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245macl\u001b[0m    = \u001b[38;5;33mvar\u001b[0m.bucket_acl",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 92,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 93,
                  "Content": "  server_side_encryption_configuration {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  server_side_encryption_configuration {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 94,
                  "Content": "    rule {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    rule {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 95,
                  "Content": "      apply_server_side_encryption_by_default {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      apply_server_side_encryption_by_default {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 96,
                  "Content": "        kms_master_key_id = aws_kms_key.my_key.arn",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;245mkms_master_key_id\u001b[0m = aws_kms_key.my_key.arn",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 97,
                  "Content": "        sse_algorithm     = \"aws:kms\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;245msse_algorithm\u001b[0m     = \u001b[38;5;37m\"aws:kms\"",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 98,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "s3-bucket-logging",
          "AVDID": "AVD-AWS-0089",
          "Title": "S3 Bucket Logging",
          "Description": "Ensures S3 bucket logging is enabled for S3 buckets",
          "Message": "Bucket has logging disabled",
          "Namespace": "builtin.aws.s3.aws0089",
          "Query": "data.builtin.aws.s3.aws0089.deny",
          "Resolution": "Add a logging block to the resource to enable access logging",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/s3-bucket-logging",
          "References": [
            "https://docs.aws.amazon.com/AmazonS3/latest/userguide/ServerLogs.html",
            "https://docs.aws.amazon.com/AmazonS3/latest/userguide/enable-server-access-logging.html",
            "https://avd.aquasec.com/misconfig/s3-bucket-logging"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "aws_s3_bucket.bucket_0",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 44,
            "EndLine": 72,
            "Code": {
              "Lines": [
                {
                  "Number": 44,
                  "Content": "resource \"aws_s3_bucket\" \"bucket_0\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_s3_bucket\"\u001b[0m \u001b[38;5;37m\"bucket_0\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 45,
                  "Content": "  bucket = var.bucket_name",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mbucket\u001b[0m = \u001b[38;5;33mvar\u001b[0m.bucket_name",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 46,
                  "Content": "  acl    = var.bucket_acl",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245macl\u001b[0m    = \u001b[38;5;33mvar\u001b[0m.bucket_acl",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 47,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 48,
                  "Content": "  policy = \u003c\u003cPOLICY",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mpolicy\u001b[0m = \u001b[38;5;245m\u003c\u003cPOLICY\u001b[0m",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 49,
                  "Content": "{",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;37m{",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 50,
                  "Content": "  \"Version\":\"2012-10-17\",",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \"Version\":\"2012-10-17\",",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 51,
                  "Content": "  \"Statement\":[",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \"Statement\":[",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 52,
                  "Content": "    {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    {",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 53,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "s3-bucket-logging",
          "AVDID": "AVD-AWS-0089",
          "Title": "S3 Bucket Logging",
          "Description": "Ensures S3 bucket logging is enabled for S3 buckets",
          "Message": "Bucket has logging disabled",
          "Namespace": "builtin.aws.s3.aws0089",
          "Query": "data.builtin.aws.s3.aws0089.deny",
          "Resolution": "Add a logging block to the resource to enable access logging",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/s3-bucket-logging",
          "References": [
            "https://docs.aws.amazon.com/AmazonS3/latest/userguide/ServerLogs.html",
            "https://docs.aws.amazon.com/AmazonS3/latest/userguide/enable-server-access-logging.html",
            "https://avd.aquasec.com/misconfig/s3-bucket-logging"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "aws_s3_bucket.bucket_1",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 74,
            "EndLine": 87,
            "Code": {
              "Lines": [
                {
                  "Number": 74,
                  "Content": "resource \"aws_s3_bucket\" \"bucket_1\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_s3_bucket\"\u001b[0m \u001b[38;5;37m\"bucket_1\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 75,
                  "Content": "  bucket = \"roger-bucket-1\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mbucket\u001b[0m = \u001b[38;5;37m\"roger-bucket-1\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 76,
                  "Content": "  acl    = var.bucket_acl",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245macl\u001b[0m    = \u001b[38;5;33mvar\u001b[0m.bucket_acl",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 77,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 78,
                  "Content": "  server_side_encryption_configuration {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  server_side_encryption_configuration {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 79,
                  "Content": "    rule {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    rule {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 80,
                  "Content": "      apply_server_side_encryption_by_default {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      apply_server_side_encryption_by_default {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 81,
                  "Content": "        kms_master_key_id = aws_kms_key.my_key.arn",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;245mkms_master_key_id\u001b[0m = aws_kms_key.my_key.arn",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 82,
                  "Content": "        sse_algorithm     = \"aws:kms\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;245msse_algorithm\u001b[0m     = \u001b[38;5;37m\"aws:kms\"",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 83,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "s3-bucket-logging",
          "AVDID": "AVD-AWS-0089",
          "Title": "S3 Bucket Logging",
          "Description": "Ensures S3 bucket logging is enabled for S3 buckets",
          "Message": "Bucket has logging disabled",
          "Namespace": "builtin.aws.s3.aws0089",
          "Query": "data.builtin.aws.s3.aws0089.deny",
          "Resolution": "Add a logging block to the resource to enable access logging",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/s3-bucket-logging",
          "References": [
            "https://docs.aws.amazon.com/AmazonS3/latest/userguide/ServerLogs.html",
            "https://docs.aws.amazon.com/AmazonS3/latest/userguide/enable-server-access-logging.html",
            "https://avd.aquasec.com/misconfig/s3-bucket-logging"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "aws_s3_bucket.bucket_2",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 89,
            "EndLine": 102,
            "Code": {
              "Lines": [
                {
                  "Number": 89,
                  "Content": "resource \"aws_s3_bucket\" \"bucket_2\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_s3_bucket\"\u001b[0m \u001b[38;5;37m\"bucket_2\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 90,
                  "Content": "  bucket = \"roger-bucket-2\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mbucket\u001b[0m = \u001b[38;5;37m\"roger-bucket-2\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 91,
                  "Content": "  acl    = var.bucket_acl",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245macl\u001b[0m    = \u001b[38;5;33mvar\u001b[0m.bucket_acl",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 92,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 93,
                  "Content": "  server_side_encryption_configuration {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  server_side_encryption_configuration {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 94,
                  "Content": "    rule {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    rule {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 95,
                  "Content": "      apply_server_side_encryption_by_default {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      apply_server_side_encryption_by_default {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 96,
                  "Content": "        kms_master_key_id = aws_kms_key.my_key.arn",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;245mkms_master_key_id\u001b[0m = aws_kms_key.my_key.arn",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 97,
                  "Content": "        sse_algorithm     = \"aws:kms\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;245msse_algorithm\u001b[0m     = \u001b[38;5;37m\"aws:kms\"",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 98,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0090",
          "AVDID": "AVD-AWS-0090",
          "Title": "S3 Data should be versioned",
          "Description": "Versioning in Amazon S3 is a means of keeping multiple variants of an object in the same bucket.\n\nYou can use the S3 Versioning feature to preserve, retrieve, and restore every version of every object stored in your buckets.\n\nWith versioning you can recover more easily from both unintended user actions and application failures.\n",
          "Message": "Bucket does not have versioning enabled",
          "Namespace": "builtin.aws.s3.aws0090",
          "Query": "data.builtin.aws.s3.aws0090.deny",
          "Resolution": "Enable versioning to protect against accidental/malicious removal or modification",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0090",
          "References": [
            "https://docs.aws.amazon.com/AmazonS3/latest/userguide/Versioning.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0090"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "aws_s3_bucket.bucket_0",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 44,
            "EndLine": 72,
            "Code": {
              "Lines": [
                {
                  "Number": 44,
                  "Content": "resource \"aws_s3_bucket\" \"bucket_0\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_s3_bucket\"\u001b[0m \u001b[38;5;37m\"bucket_0\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 45,
                  "Content": "  bucket = var.bucket_name",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mbucket\u001b[0m = \u001b[38;5;33mvar\u001b[0m.bucket_name",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 46,
                  "Content": "  acl    = var.bucket_acl",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245macl\u001b[0m    = \u001b[38;5;33mvar\u001b[0m.bucket_acl",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 47,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 48,
                  "Content": "  policy = \u003c\u003cPOLICY",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mpolicy\u001b[0m = \u001b[38;5;245m\u003c\u003cPOLICY\u001b[0m",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 49,
                  "Content": "{",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;37m{",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 50,
                  "Content": "  \"Version\":\"2012-10-17\",",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \"Version\":\"2012-10-17\",",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 51,
                  "Content": "  \"Statement\":[",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \"Statement\":[",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 52,
                  "Content": "    {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    {",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 53,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0090",
          "AVDID": "AVD-AWS-0090",
          "Title": "S3 Data should be versioned",
          "Description": "Versioning in Amazon S3 is a means of keeping multiple variants of an object in the same bucket.\n\nYou can use the S3 Versioning feature to preserve, retrieve, and restore every version of every object stored in your buckets.\n\nWith versioning you can recover more easily from both unintended user actions and application failures.\n",
          "Message": "Bucket does not have versioning enabled",
          "Namespace": "builtin.aws.s3.aws0090",
          "Query": "data.builtin.aws.s3.aws0090.deny",
          "Resolution": "Enable versioning to protect against accidental/malicious removal or modification",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0090",
          "References": [
            "https://docs.aws.amazon.com/AmazonS3/latest/userguide/Versioning.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0090"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "aws_s3_bucket.bucket_1",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 74,
            "EndLine": 87,
            "Code": {
              "Lines": [
                {
                  "Number": 74,
                  "Content": "resource \"aws_s3_bucket\" \"bucket_1\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_s3_bucket\"\u001b[0m \u001b[38;5;37m\"bucket_1\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 75,
                  "Content": "  bucket = \"roger-bucket-1\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mbucket\u001b[0m = \u001b[38;5;37m\"roger-bucket-1\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 76,
                  "Content": "  acl    = var.bucket_acl",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245macl\u001b[0m    = \u001b[38;5;33mvar\u001b[0m.bucket_acl",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 77,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 78,
                  "Content": "  server_side_encryption_configuration {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  server_side_encryption_configuration {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 79,
                  "Content": "    rule {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    rule {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 80,
                  "Content": "      apply_server_side_encryption_by_default {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      apply_server_side_encryption_by_default {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 81,
                  "Content": "        kms_master_key_id = aws_kms_key.my_key.arn",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;245mkms_master_key_id\u001b[0m = aws_kms_key.my_key.arn",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 82,
                  "Content": "        sse_algorithm     = \"aws:kms\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;245msse_algorithm\u001b[0m     = \u001b[38;5;37m\"aws:kms\"",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 83,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0090",
          "AVDID": "AVD-AWS-0090",
          "Title": "S3 Data should be versioned",
          "Description": "Versioning in Amazon S3 is a means of keeping multiple variants of an object in the same bucket.\n\nYou can use the S3 Versioning feature to preserve, retrieve, and restore every version of every object stored in your buckets.\n\nWith versioning you can recover more easily from both unintended user actions and application failures.\n",
          "Message": "Bucket does not have versioning enabled",
          "Namespace": "builtin.aws.s3.aws0090",
          "Query": "data.builtin.aws.s3.aws0090.deny",
          "Resolution": "Enable versioning to protect against accidental/malicious removal or modification",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0090",
          "References": [
            "https://docs.aws.amazon.com/AmazonS3/latest/userguide/Versioning.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0090"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "aws_s3_bucket.bucket_2",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 89,
            "EndLine": 102,
            "Code": {
              "Lines": [
                {
                  "Number": 89,
                  "Content": "resource \"aws_s3_bucket\" \"bucket_2\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_s3_bucket\"\u001b[0m \u001b[38;5;37m\"bucket_2\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 90,
                  "Content": "  bucket = \"roger-bucket-2\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mbucket\u001b[0m = \u001b[38;5;37m\"roger-bucket-2\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 91,
                  "Content": "  acl    = var.bucket_acl",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245macl\u001b[0m    = \u001b[38;5;33mvar\u001b[0m.bucket_acl",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 92,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 93,
                  "Content": "  server_side_encryption_configuration {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  server_side_encryption_configuration {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 94,
                  "Content": "    rule {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    rule {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 95,
                  "Content": "      apply_server_side_encryption_by_default {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      apply_server_side_encryption_by_default {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 96,
                  "Content": "        kms_master_key_id = aws_kms_key.my_key.arn",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;245mkms_master_key_id\u001b[0m = aws_kms_key.my_key.arn",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 97,
                  "Content": "        sse_algorithm     = \"aws:kms\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;245msse_algorithm\u001b[0m     = \u001b[38;5;37m\"aws:kms\"",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 98,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0091",
          "AVDID": "AVD-AWS-0091",
          "Title": "S3 Access Block should Ignore Public ACL",
          "Description": "S3 buckets should ignore public ACLs on buckets and any objects they contain. By ignoring rather than blocking, PUT calls with public ACLs will still be applied but the ACL will be ignored.\n",
          "Message": "No public access block so not blocking public acls",
          "Namespace": "builtin.aws.s3.aws0091",
          "Query": "data.builtin.aws.s3.aws0091.deny",
          "Resolution": "Enable ignoring the application of public ACLs in PUT calls",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0091",
          "References": [
            "https://docs.aws.amazon.com/AmazonS3/latest/userguide/access-control-block-public-access.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0091"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "aws_s3_bucket.bucket_0",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 44,
            "EndLine": 72,
            "Code": {
              "Lines": [
                {
                  "Number": 44,
                  "Content": "resource \"aws_s3_bucket\" \"bucket_0\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_s3_bucket\"\u001b[0m \u001b[38;5;37m\"bucket_0\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 45,
                  "Content": "  bucket = var.bucket_name",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mbucket\u001b[0m = \u001b[38;5;33mvar\u001b[0m.bucket_name",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 46,
                  "Content": "  acl    = var.bucket_acl",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245macl\u001b[0m    = \u001b[38;5;33mvar\u001b[0m.bucket_acl",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 47,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 48,
                  "Content": "  policy = \u003c\u003cPOLICY",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mpolicy\u001b[0m = \u001b[38;5;245m\u003c\u003cPOLICY\u001b[0m",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 49,
                  "Content": "{",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;37m{",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 50,
                  "Content": "  \"Version\":\"2012-10-17\",",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \"Version\":\"2012-10-17\",",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 51,
                  "Content": "  \"Statement\":[",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \"Statement\":[",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 52,
                  "Content": "    {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    {",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 53,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0091",
          "AVDID": "AVD-AWS-0091",
          "Title": "S3 Access Block should Ignore Public ACL",
          "Description": "S3 buckets should ignore public ACLs on buckets and any objects they contain. By ignoring rather than blocking, PUT calls with public ACLs will still be applied but the ACL will be ignored.\n",
          "Message": "No public access block so not blocking public acls",
          "Namespace": "builtin.aws.s3.aws0091",
          "Query": "data.builtin.aws.s3.aws0091.deny",
          "Resolution": "Enable ignoring the application of public ACLs in PUT calls",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0091",
          "References": [
            "https://docs.aws.amazon.com/AmazonS3/latest/userguide/access-control-block-public-access.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0091"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "aws_s3_bucket.bucket_1",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 74,
            "EndLine": 87,
            "Code": {
              "Lines": [
                {
                  "Number": 74,
                  "Content": "resource \"aws_s3_bucket\" \"bucket_1\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_s3_bucket\"\u001b[0m \u001b[38;5;37m\"bucket_1\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 75,
                  "Content": "  bucket = \"roger-bucket-1\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mbucket\u001b[0m = \u001b[38;5;37m\"roger-bucket-1\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 76,
                  "Content": "  acl    = var.bucket_acl",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245macl\u001b[0m    = \u001b[38;5;33mvar\u001b[0m.bucket_acl",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 77,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 78,
                  "Content": "  server_side_encryption_configuration {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  server_side_encryption_configuration {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 79,
                  "Content": "    rule {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    rule {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 80,
                  "Content": "      apply_server_side_encryption_by_default {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      apply_server_side_encryption_by_default {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 81,
                  "Content": "        kms_master_key_id = aws_kms_key.my_key.arn",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;245mkms_master_key_id\u001b[0m = aws_kms_key.my_key.arn",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 82,
                  "Content": "        sse_algorithm     = \"aws:kms\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;245msse_algorithm\u001b[0m     = \u001b[38;5;37m\"aws:kms\"",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 83,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0091",
          "AVDID": "AVD-AWS-0091",
          "Title": "S3 Access Block should Ignore Public ACL",
          "Description": "S3 buckets should ignore public ACLs on buckets and any objects they contain. By ignoring rather than blocking, PUT calls with public ACLs will still be applied but the ACL will be ignored.\n",
          "Message": "No public access block so not blocking public acls",
          "Namespace": "builtin.aws.s3.aws0091",
          "Query": "data.builtin.aws.s3.aws0091.deny",
          "Resolution": "Enable ignoring the application of public ACLs in PUT calls",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0091",
          "References": [
            "https://docs.aws.amazon.com/AmazonS3/latest/userguide/access-control-block-public-access.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0091"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "aws_s3_bucket.bucket_2",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 89,
            "EndLine": 102,
            "Code": {
              "Lines": [
                {
                  "Number": 89,
                  "Content": "resource \"aws_s3_bucket\" \"bucket_2\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_s3_bucket\"\u001b[0m \u001b[38;5;37m\"bucket_2\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 90,
                  "Content": "  bucket = \"roger-bucket-2\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mbucket\u001b[0m = \u001b[38;5;37m\"roger-bucket-2\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 91,
                  "Content": "  acl    = var.bucket_acl",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245macl\u001b[0m    = \u001b[38;5;33mvar\u001b[0m.bucket_acl",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 92,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 93,
                  "Content": "  server_side_encryption_configuration {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  server_side_encryption_configuration {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 94,
                  "Content": "    rule {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    rule {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 95,
                  "Content": "      apply_server_side_encryption_by_default {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      apply_server_side_encryption_by_default {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 96,
                  "Content": "        kms_master_key_id = aws_kms_key.my_key.arn",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;245mkms_master_key_id\u001b[0m = aws_kms_key.my_key.arn",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 97,
                  "Content": "        sse_algorithm     = \"aws:kms\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;245msse_algorithm\u001b[0m     = \u001b[38;5;37m\"aws:kms\"",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 98,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0093",
          "AVDID": "AVD-AWS-0093",
          "Title": "S3 Access block should restrict public bucket to limit access",
          "Description": "S3 buckets should restrict public policies for the bucket. By enabling, the restrict_public_buckets, only the bucket owner and AWS Services can access if it has a public policy.\n",
          "Message": "No public access block so not restricting public buckets",
          "Namespace": "builtin.aws.s3.aws0093",
          "Query": "data.builtin.aws.s3.aws0093.deny",
          "Resolution": "Limit the access to public buckets to only the owner or AWS Services (eg; CloudFront)",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0093",
          "References": [
            "https://docs.aws.amazon.com/AmazonS3/latest/dev-retired/access-control-block-public-access.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0093"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "aws_s3_bucket.bucket_0",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 44,
            "EndLine": 72,
            "Code": {
              "Lines": [
                {
                  "Number": 44,
                  "Content": "resource \"aws_s3_bucket\" \"bucket_0\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_s3_bucket\"\u001b[0m \u001b[38;5;37m\"bucket_0\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 45,
                  "Content": "  bucket = var.bucket_name",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mbucket\u001b[0m = \u001b[38;5;33mvar\u001b[0m.bucket_name",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 46,
                  "Content": "  acl    = var.bucket_acl",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245macl\u001b[0m    = \u001b[38;5;33mvar\u001b[0m.bucket_acl",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 47,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 48,
                  "Content": "  policy = \u003c\u003cPOLICY",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mpolicy\u001b[0m = \u001b[38;5;245m\u003c\u003cPOLICY\u001b[0m",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 49,
                  "Content": "{",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;37m{",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 50,
                  "Content": "  \"Version\":\"2012-10-17\",",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \"Version\":\"2012-10-17\",",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 51,
                  "Content": "  \"Statement\":[",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \"Statement\":[",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 52,
                  "Content": "    {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    {",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 53,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0093",
          "AVDID": "AVD-AWS-0093",
          "Title": "S3 Access block should restrict public bucket to limit access",
          "Description": "S3 buckets should restrict public policies for the bucket. By enabling, the restrict_public_buckets, only the bucket owner and AWS Services can access if it has a public policy.\n",
          "Message": "No public access block so not restricting public buckets",
          "Namespace": "builtin.aws.s3.aws0093",
          "Query": "data.builtin.aws.s3.aws0093.deny",
          "Resolution": "Limit the access to public buckets to only the owner or AWS Services (eg; CloudFront)",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0093",
          "References": [
            "https://docs.aws.amazon.com/AmazonS3/latest/dev-retired/access-control-block-public-access.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0093"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "aws_s3_bucket.bucket_1",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 74,
            "EndLine": 87,
            "Code": {
              "Lines": [
                {
                  "Number": 74,
                  "Content": "resource \"aws_s3_bucket\" \"bucket_1\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_s3_bucket\"\u001b[0m \u001b[38;5;37m\"bucket_1\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 75,
                  "Content": "  bucket = \"roger-bucket-1\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mbucket\u001b[0m = \u001b[38;5;37m\"roger-bucket-1\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 76,
                  "Content": "  acl    = var.bucket_acl",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245macl\u001b[0m    = \u001b[38;5;33mvar\u001b[0m.bucket_acl",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 77,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 78,
                  "Content": "  server_side_encryption_configuration {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  server_side_encryption_configuration {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 79,
                  "Content": "    rule {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    rule {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 80,
                  "Content": "      apply_server_side_encryption_by_default {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      apply_server_side_encryption_by_default {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 81,
                  "Content": "        kms_master_key_id = aws_kms_key.my_key.arn",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;245mkms_master_key_id\u001b[0m = aws_kms_key.my_key.arn",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 82,
                  "Content": "        sse_algorithm     = \"aws:kms\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;245msse_algorithm\u001b[0m     = \u001b[38;5;37m\"aws:kms\"",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 83,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0093",
          "AVDID": "AVD-AWS-0093",
          "Title": "S3 Access block should restrict public bucket to limit access",
          "Description": "S3 buckets should restrict public policies for the bucket. By enabling, the restrict_public_buckets, only the bucket owner and AWS Services can access if it has a public policy.\n",
          "Message": "No public access block so not restricting public buckets",
          "Namespace": "builtin.aws.s3.aws0093",
          "Query": "data.builtin.aws.s3.aws0093.deny",
          "Resolution": "Limit the access to public buckets to only the owner or AWS Services (eg; CloudFront)",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0093",
          "References": [
            "https://docs.aws.amazon.com/AmazonS3/latest/dev-retired/access-control-block-public-access.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0093"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "aws_s3_bucket.bucket_2",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 89,
            "EndLine": 102,
            "Code": {
              "Lines": [
                {
                  "Number": 89,
                  "Content": "resource \"aws_s3_bucket\" \"bucket_2\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_s3_bucket\"\u001b[0m \u001b[38;5;37m\"bucket_2\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 90,
                  "Content": "  bucket = \"roger-bucket-2\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mbucket\u001b[0m = \u001b[38;5;37m\"roger-bucket-2\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 91,
                  "Content": "  acl    = var.bucket_acl",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245macl\u001b[0m    = \u001b[38;5;33mvar\u001b[0m.bucket_acl",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 92,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 93,
                  "Content": "  server_side_encryption_configuration {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  server_side_encryption_configuration {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 94,
                  "Content": "    rule {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    rule {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 95,
                  "Content": "      apply_server_side_encryption_by_default {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      apply_server_side_encryption_by_default {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 96,
                  "Content": "        kms_master_key_id = aws_kms_key.my_key.arn",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;245mkms_master_key_id\u001b[0m = aws_kms_key.my_key.arn",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 97,
                  "Content": "        sse_algorithm     = \"aws:kms\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;245msse_algorithm\u001b[0m     = \u001b[38;5;37m\"aws:kms\"",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 98,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0094",
          "AVDID": "AVD-AWS-0094",
          "Title": "S3 buckets should each define an aws_s3_bucket_public_access_block",
          "Description": "The \"block public access\" settings in S3 override individual policies that apply to a given bucket, meaning that all public access can be controlled in one central types for that bucket. It is therefore good practice to define these settings for each bucket in order to clearly define the public access that can be allowed for it.\n",
          "Message": "Bucket does not have a corresponding public access block.",
          "Namespace": "builtin.aws.s3.aws0094",
          "Query": "data.builtin.aws.s3.aws0094.deny",
          "Resolution": "Define a aws_s3_bucket_public_access_block for the given bucket to control public access policies",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0094",
          "References": [
            "https://docs.aws.amazon.com/AmazonS3/latest/userguide/access-control-block-public-access.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0094"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "aws_s3_bucket.bucket_0",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 44,
            "EndLine": 72,
            "Code": {
              "Lines": [
                {
                  "Number": 44,
                  "Content": "resource \"aws_s3_bucket\" \"bucket_0\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_s3_bucket\"\u001b[0m \u001b[38;5;37m\"bucket_0\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 45,
                  "Content": "  bucket = var.bucket_name",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mbucket\u001b[0m = \u001b[38;5;33mvar\u001b[0m.bucket_name",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 46,
                  "Content": "  acl    = var.bucket_acl",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245macl\u001b[0m    = \u001b[38;5;33mvar\u001b[0m.bucket_acl",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 47,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 48,
                  "Content": "  policy = \u003c\u003cPOLICY",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mpolicy\u001b[0m = \u001b[38;5;245m\u003c\u003cPOLICY\u001b[0m",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 49,
                  "Content": "{",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;37m{",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 50,
                  "Content": "  \"Version\":\"2012-10-17\",",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \"Version\":\"2012-10-17\",",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 51,
                  "Content": "  \"Statement\":[",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \"Statement\":[",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 52,
                  "Content": "    {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    {",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 53,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0094",
          "AVDID": "AVD-AWS-0094",
          "Title": "S3 buckets should each define an aws_s3_bucket_public_access_block",
          "Description": "The \"block public access\" settings in S3 override individual policies that apply to a given bucket, meaning that all public access can be controlled in one central types for that bucket. It is therefore good practice to define these settings for each bucket in order to clearly define the public access that can be allowed for it.\n",
          "Message": "Bucket does not have a corresponding public access block.",
          "Namespace": "builtin.aws.s3.aws0094",
          "Query": "data.builtin.aws.s3.aws0094.deny",
          "Resolution": "Define a aws_s3_bucket_public_access_block for the given bucket to control public access policies",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0094",
          "References": [
            "https://docs.aws.amazon.com/AmazonS3/latest/userguide/access-control-block-public-access.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0094"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "aws_s3_bucket.bucket_1",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 74,
            "EndLine": 87,
            "Code": {
              "Lines": [
                {
                  "Number": 74,
                  "Content": "resource \"aws_s3_bucket\" \"bucket_1\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_s3_bucket\"\u001b[0m \u001b[38;5;37m\"bucket_1\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 75,
                  "Content": "  bucket = \"roger-bucket-1\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mbucket\u001b[0m = \u001b[38;5;37m\"roger-bucket-1\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 76,
                  "Content": "  acl    = var.bucket_acl",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245macl\u001b[0m    = \u001b[38;5;33mvar\u001b[0m.bucket_acl",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 77,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 78,
                  "Content": "  server_side_encryption_configuration {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  server_side_encryption_configuration {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 79,
                  "Content": "    rule {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    rule {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 80,
                  "Content": "      apply_server_side_encryption_by_default {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      apply_server_side_encryption_by_default {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 81,
                  "Content": "        kms_master_key_id = aws_kms_key.my_key.arn",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;245mkms_master_key_id\u001b[0m = aws_kms_key.my_key.arn",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 82,
                  "Content": "        sse_algorithm     = \"aws:kms\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;245msse_algorithm\u001b[0m     = \u001b[38;5;37m\"aws:kms\"",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 83,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0094",
          "AVDID": "AVD-AWS-0094",
          "Title": "S3 buckets should each define an aws_s3_bucket_public_access_block",
          "Description": "The \"block public access\" settings in S3 override individual policies that apply to a given bucket, meaning that all public access can be controlled in one central types for that bucket. It is therefore good practice to define these settings for each bucket in order to clearly define the public access that can be allowed for it.\n",
          "Message": "Bucket does not have a corresponding public access block.",
          "Namespace": "builtin.aws.s3.aws0094",
          "Query": "data.builtin.aws.s3.aws0094.deny",
          "Resolution": "Define a aws_s3_bucket_public_access_block for the given bucket to control public access policies",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0094",
          "References": [
            "https://docs.aws.amazon.com/AmazonS3/latest/userguide/access-control-block-public-access.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0094"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "aws_s3_bucket.bucket_2",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 89,
            "EndLine": 102,
            "Code": {
              "Lines": [
                {
                  "Number": 89,
                  "Content": "resource \"aws_s3_bucket\" \"bucket_2\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_s3_bucket\"\u001b[0m \u001b[38;5;37m\"bucket_2\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 90,
                  "Content": "  bucket = \"roger-bucket-2\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mbucket\u001b[0m = \u001b[38;5;37m\"roger-bucket-2\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 91,
                  "Content": "  acl    = var.bucket_acl",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245macl\u001b[0m    = \u001b[38;5;33mvar\u001b[0m.bucket_acl",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 92,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 93,
                  "Content": "  server_side_encryption_configuration {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  server_side_encryption_configuration {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 94,
                  "Content": "    rule {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    rule {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 95,
                  "Content": "      apply_server_side_encryption_by_default {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      apply_server_side_encryption_by_default {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 96,
                  "Content": "        kms_master_key_id = aws_kms_key.my_key.arn",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;245mkms_master_key_id\u001b[0m = aws_kms_key.my_key.arn",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 97,
                  "Content": "        sse_algorithm     = \"aws:kms\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;245msse_algorithm\u001b[0m     = \u001b[38;5;37m\"aws:kms\"",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 98,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "RenderedCause": {}
          }
        }
      ]
    },
    {
      "Target": "infrastructure-as-code/sagemaker-notebook",
      "Class": "config",
      "Type": "terraform",
      "MisconfSummary": {
        "Successes": 55,
        "Failures": 0
      }
    },
    {
      "Target": "infrastructure-as-code/sagemaker-notebook/main.tf",
      "Class": "config",
      "Type": "terraform",
      "MisconfSummary": {
        "Successes": 0,
        "Failures": 1
      },
      "Misconfigurations": [
        {
          "Type": "Terraform Security Check",
          "ID": "aws-autoscaling-enable-at-rest-encryption",
          "AVDID": "AVD-AWS-0178",
          "Title": "VPC Flow Logs is a feature that enables you to capture information about the IP traffic going to and from network interfaces in your VPC. After you've created a flow log, you can view and retrieve its data in Amazon CloudWatch Logs. It is recommended that VPC Flow Logs be enabled for packet \"Rejects\" for VPCs.",
          "Description": "VPC Flow Logs provide visibility into network traffic that traverses the VPC and can be used to detect anomalous traffic or insight during security workflows.\n",
          "Message": "VPC does not have VPC Flow Logs enabled.",
          "Namespace": "builtin.aws.ec2.aws0178",
          "Query": "data.builtin.aws.ec2.aws0178.deny",
          "Resolution": "Enable flow logs for VPC",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/aws-autoscaling-enable-at-rest-encryption",
          "References": [
            "https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/RootDeviceStorage.html",
            "https://avd.aquasec.com/misconfig/aws-autoscaling-enable-at-rest-encryption"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "aws_vpc.sagemaker",
            "Provider": "AWS",
            "Service": "ec2",
            "StartLine": 14,
            "EndLine": 16,
            "Code": {
              "Lines": [
                {
                  "Number": 14,
                  "Content": "resource \"aws_vpc\" \"sagemaker\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_vpc\"\u001b[0m \u001b[38;5;37m\"sagemaker\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 15,
                  "Content": "  cidr_block = \"10.0.0.0/16\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mcidr_block\u001b[0m = \u001b[38;5;37m\"10.0.0.0/16\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 16,
                  "Content": "}",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m}",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            },
            "RenderedCause": {}
          }
        }
      ]
    },
    {
      "Target": "infrastructure-as-code/terraform-0.12-examples/advanced-dynamic-blocks",
      "Class": "config",
      "Type": "terraform",
      "MisconfSummary": {
        "Successes": 37,
        "Failures": 0
      }
    },
    {
      "Target": "infrastructure-as-code/terraform-0.12-examples/dynamic-blocks-and-splat-expressions",
      "Class": "config",
      "Type": "terraform",
      "MisconfSummary": {
        "Successes": 54,
        "Failures": 0
      }
    },
    {
      "Target": "infrastructure-as-code/terraform-0.12-examples/dynamic-blocks-and-splat-expressions/main.tf",
      "Class": "config",
      "Type": "terraform",
      "MisconfSummary": {
        "Successes": 0,
        "Failures": 2
      },
      "Misconfigurations": [
        {
          "Type": "Terraform Security Check",
          "ID": "aws-vpc-add-description-to-security-group-rule",
          "AVDID": "AVD-AWS-0124",
          "Title": "Missing description for security group rule.",
          "Description": "Security group rules should include a description for auditing purposes.\n\nSimplifies auditing, debugging, and managing security groups.\n",
          "Message": "Security group rule does not have a description.",
          "Namespace": "builtin.aws.ec2.aws0124",
          "Query": "data.builtin.aws.ec2.aws0124.deny",
          "Resolution": "Add descriptions for all security groups rules",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/aws-vpc-add-description-to-security-group-rule",
          "References": [
            "https://www.cloudconformity.com/knowledge-base/aws/EC2/security-group-rules-description.html",
            "https://avd.aquasec.com/misconfig/aws-vpc-add-description-to-security-group-rule"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "aws_security_group.vault",
            "Provider": "AWS",
            "Service": "ec2",
            "StartLine": 35,
            "EndLine": 40,
            "Code": {
              "Lines": [
                {
                  "Number": 27,
                  "Content": "resource \"aws_security_group\" \"vault\" {",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_security_group\"\u001b[0m \u001b[38;5;37m\"vault\"\u001b[0m {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 28,
                  "Content": "  name        = \"vault\"",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mname\u001b[0m        = \u001b[38;5;37m\"vault\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 29,
                  "Content": "  description = \"Ingress for Vault\"",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mdescription\u001b[0m = \u001b[38;5;37m\"Ingress for Vault\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 30,
                  "Content": "  vpc_id      = aws_vpc.my_vpc.id",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mvpc_id\u001b[0m      = aws_vpc.my_vpc.id",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 31,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 32,
                  "Content": "  dynamic \"ingress\" {",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  dynamic \u001b[38;5;37m\"ingress\"\u001b[0m {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 33,
                  "Content": "    iterator = port",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;245miterator\u001b[0m = port",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 34,
                  "Content": "    for_each = var.ingress_ports",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;245mfor_each\u001b[0m = \u001b[38;5;33mvar\u001b[0m.ingress_ports",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 35,
                  "Content": "    content {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    content {",
                  "FirstCause": true,
                  "LastCause": true
                },
                {
                  "Number": 36,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "dynamic.ingress",
                "Filename": "infrastructure-as-code/terraform-0.12-examples/dynamic-blocks-and-splat-expressions/main.tf",
                "Location": {
                  "StartLine": 32,
                  "EndLine": 41
                }
              },
              {
                "Resource": "aws_security_group.vault",
                "Filename": "infrastructure-as-code/terraform-0.12-examples/dynamic-blocks-and-splat-expressions/main.tf",
                "Location": {
                  "StartLine": 27,
                  "EndLine": 42
                }
              }
            ],
            "RenderedCause": {}
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "aws-autoscaling-enable-at-rest-encryption",
          "AVDID": "AVD-AWS-0178",
          "Title": "VPC Flow Logs is a feature that enables you to capture information about the IP traffic going to and from network interfaces in your VPC. After you've created a flow log, you can view and retrieve its data in Amazon CloudWatch Logs. It is recommended that VPC Flow Logs be enabled for packet \"Rejects\" for VPCs.",
          "Description": "VPC Flow Logs provide visibility into network traffic that traverses the VPC and can be used to detect anomalous traffic or insight during security workflows.\n",
          "Message": "VPC does not have VPC Flow Logs enabled.",
          "Namespace": "builtin.aws.ec2.aws0178",
          "Query": "data.builtin.aws.ec2.aws0178.deny",
          "Resolution": "Enable flow logs for VPC",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/aws-autoscaling-enable-at-rest-encryption",
          "References": [
            "https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/RootDeviceStorage.html",
            "https://avd.aquasec.com/misconfig/aws-autoscaling-enable-at-rest-encryption"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "aws_vpc.my_vpc",
            "Provider": "AWS",
            "Service": "ec2",
            "StartLine": 20,
            "EndLine": 25,
            "Code": {
              "Lines": [
                {
                  "Number": 20,
                  "Content": "resource \"aws_vpc\" \"my_vpc\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_vpc\"\u001b[0m \u001b[38;5;37m\"my_vpc\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "  cidr_block = \"172.16.0.0/16\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mcidr_block\u001b[0m = \u001b[38;5;37m\"172.16.0.0/16\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "  tags = {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mtags\u001b[0m = {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "    Name = \"tf-0.12-dynamic-block-example\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;245mName\u001b[0m = \u001b[38;5;37m\"tf-0.12-dynamic-block-example\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 24,
                  "Content": "  }",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  }",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 25,
                  "Content": "}",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "}",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            },
            "RenderedCause": {}
          }
        }
      ]
    },
    {
      "Target": "infrastructure-as-code/terraform-0.12-examples/first-class-expressions",
      "Class": "config",
      "Type": "terraform",
      "MisconfSummary": {
        "Successes": 53,
        "Failures": 0
      }
    },
    {
      "Target": "infrastructure-as-code/terraform-0.12-examples/first-class-expressions/main.tf",
      "Class": "config",
      "Type": "terraform",
      "MisconfSummary": {
        "Successes": 0,
        "Failures": 3
      },
      "Misconfigurations": [
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0028",
          "AVDID": "AVD-AWS-0028",
          "Title": "aws_instance should activate session tokens for Instance Metadata Service.",
          "Description": "IMDS v2 (Instance Metadata Service) introduced session authentication tokens which improve security when talking to IMDS.\n\nBy default \u003ccode\u003eaws_instance\u003c/code\u003e resource sets IMDS session auth tokens to be optional.\n\nTo fully protect IMDS you need to enable session tokens by using \u003ccode\u003emetadata_options\u003c/code\u003e block and its \u003ccode\u003ehttp_tokens\u003c/code\u003e variable set to \u003ccode\u003erequired\u003c/code\u003e.\n",
          "Message": "Instance does not require IMDS access to require a token.",
          "Namespace": "builtin.aws.ec2.aws0028",
          "Query": "data.builtin.aws.ec2.aws0028.deny",
          "Resolution": "Enable HTTP token requirement for IMDS",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0028",
          "References": [
            "https://aws.amazon.com/blogs/security/defense-in-depth-open-firewalls-reverse-proxies-ssrf-vulnerabilities-ec2-instance-metadata-service",
            "https://avd.aquasec.com/misconfig/avd-aws-0028"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "aws_instance.foo",
            "Provider": "AWS",
            "Service": "ec2",
            "StartLine": 51,
            "EndLine": 63,
            "Code": {
              "Lines": [
                {
                  "Number": 51,
                  "Content": "resource \"aws_instance\" \"foo\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_instance\"\u001b[0m \u001b[38;5;37m\"foo\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 52,
                  "Content": "  ami = data.aws_ami.ubuntu_14_04.image_id",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mami\u001b[0m = \u001b[38;5;33mdata\u001b[0m.aws_ami.ubuntu_14_04.image_id",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 53,
                  "Content": "  instance_type = \"t2.micro\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245minstance_type\u001b[0m = \u001b[38;5;37m\"t2.micro\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 54,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 55,
                  "Content": "  tags = {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mtags\u001b[0m = {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 56,
                  "Content": "    Name = \"tf-0.12-fce-ec2-instance\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;245mName\u001b[0m = \u001b[38;5;37m\"tf-0.12-fce-ec2-instance\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 57,
                  "Content": "  }",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  }",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 58,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 59,
                  "Content": "  network_interface {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  network_interface {",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 60,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0131",
          "AVDID": "AVD-AWS-0131",
          "Title": "Instance with unencrypted block device.",
          "Description": "Block devices should be encrypted to ensure sensitive data is held securely at rest.\n",
          "Message": "Root block device is not encrypted.",
          "Namespace": "builtin.aws.ec2.aws0131",
          "Query": "data.builtin.aws.ec2.aws0131.deny",
          "Resolution": "Turn on encryption for all block devices",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0131",
          "References": [
            "https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/RootDeviceStorage.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0131"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "aws_instance.foo",
            "Provider": "AWS",
            "Service": "ec2",
            "StartLine": 51,
            "EndLine": 63,
            "Code": {
              "Lines": [
                {
                  "Number": 51,
                  "Content": "resource \"aws_instance\" \"foo\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_instance\"\u001b[0m \u001b[38;5;37m\"foo\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 52,
                  "Content": "  ami = data.aws_ami.ubuntu_14_04.image_id",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mami\u001b[0m = \u001b[38;5;33mdata\u001b[0m.aws_ami.ubuntu_14_04.image_id",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 53,
                  "Content": "  instance_type = \"t2.micro\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245minstance_type\u001b[0m = \u001b[38;5;37m\"t2.micro\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 54,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 55,
                  "Content": "  tags = {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mtags\u001b[0m = {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 56,
                  "Content": "    Name = \"tf-0.12-fce-ec2-instance\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;245mName\u001b[0m = \u001b[38;5;37m\"tf-0.12-fce-ec2-instance\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 57,
                  "Content": "  }",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  }",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 58,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 59,
                  "Content": "  network_interface {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  network_interface {",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 60,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "aws-autoscaling-enable-at-rest-encryption",
          "AVDID": "AVD-AWS-0178",
          "Title": "VPC Flow Logs is a feature that enables you to capture information about the IP traffic going to and from network interfaces in your VPC. After you've created a flow log, you can view and retrieve its data in Amazon CloudWatch Logs. It is recommended that VPC Flow Logs be enabled for packet \"Rejects\" for VPCs.",
          "Description": "VPC Flow Logs provide visibility into network traffic that traverses the VPC and can be used to detect anomalous traffic or insight during security workflows.\n",
          "Message": "VPC does not have VPC Flow Logs enabled.",
          "Namespace": "builtin.aws.ec2.aws0178",
          "Query": "data.builtin.aws.ec2.aws0178.deny",
          "Resolution": "Enable flow logs for VPC",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/aws-autoscaling-enable-at-rest-encryption",
          "References": [
            "https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/RootDeviceStorage.html",
            "https://avd.aquasec.com/misconfig/aws-autoscaling-enable-at-rest-encryption"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "aws_vpc.my_vpc",
            "Provider": "AWS",
            "Service": "ec2",
            "StartLine": 14,
            "EndLine": 20,
            "Code": {
              "Lines": [
                {
                  "Number": 14,
                  "Content": "resource \"aws_vpc\" \"my_vpc\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_vpc\"\u001b[0m \u001b[38;5;37m\"my_vpc\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 15,
                  "Content": "  cidr_block = \"172.16.0.0/16\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mcidr_block\u001b[0m = \u001b[38;5;37m\"172.16.0.0/16\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 16,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 17,
                  "Content": "  tags = {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mtags\u001b[0m = {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 18,
                  "Content": "    Name = var.vpc_name",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;245mName\u001b[0m = \u001b[38;5;33mvar\u001b[0m.vpc_name",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "  }",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  }",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "}",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "}",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            },
            "RenderedCause": {}
          }
        }
      ]
    },
    {
      "Target": "infrastructure-as-code/terraform-0.12-examples/for-each-for-resources",
      "Class": "config",
      "Type": "terraform",
      "MisconfSummary": {
        "Successes": 54,
        "Failures": 0
      }
    },
    {
      "Target": "infrastructure-as-code/terraform-0.12-examples/for-each-for-resources/main.tf",
      "Class": "config",
      "Type": "terraform",
      "MisconfSummary": {
        "Successes": 0,
        "Failures": 12
      },
      "Misconfigurations": [
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0028",
          "AVDID": "AVD-AWS-0028",
          "Title": "aws_instance should activate session tokens for Instance Metadata Service.",
          "Description": "IMDS v2 (Instance Metadata Service) introduced session authentication tokens which improve security when talking to IMDS.\n\nBy default \u003ccode\u003eaws_instance\u003c/code\u003e resource sets IMDS session auth tokens to be optional.\n\nTo fully protect IMDS you need to enable session tokens by using \u003ccode\u003emetadata_options\u003c/code\u003e block and its \u003ccode\u003ehttp_tokens\u003c/code\u003e variable set to \u003ccode\u003erequired\u003c/code\u003e.\n",
          "Message": "Instance does not require IMDS access to require a token.",
          "Namespace": "builtin.aws.ec2.aws0028",
          "Query": "data.builtin.aws.ec2.aws0028.deny",
          "Resolution": "Enable HTTP token requirement for IMDS",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0028",
          "References": [
            "https://aws.amazon.com/blogs/security/defense-in-depth-open-firewalls-reverse-proxies-ssrf-vulnerabilities-ec2-instance-metadata-service",
            "https://avd.aquasec.com/misconfig/avd-aws-0028"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "aws_instance.ubuntu[\"a\"]",
            "Provider": "AWS",
            "Service": "ec2",
            "StartLine": 38,
            "EndLine": 49,
            "Code": {
              "Lines": [
                {
                  "Number": 38,
                  "Content": "resource \"aws_instance\" \"ubuntu\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_instance\"\u001b[0m \u001b[38;5;37m\"ubuntu\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 39,
                  "Content": "  for_each = var.zones",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mfor_each\u001b[0m = \u001b[38;5;33mvar\u001b[0m.zones",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 40,
                  "Content": "  ami = data.aws_ami.ubuntu.id",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mami\u001b[0m = \u001b[38;5;33mdata\u001b[0m.aws_ami.ubuntu.id",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 41,
                  "Content": "  instance_type = \"t2.micro\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245minstance_type\u001b[0m = \u001b[38;5;37m\"t2.micro\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 42,
                  "Content": "  associate_public_ip_address = true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245massociate_public_ip_address\u001b[0m = \u001b[38;5;166mtrue",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 43,
                  "Content": "  availability_zone = each.value",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mavailability_zone\u001b[0m = \u001b[38;5;33meach\u001b[0m.value",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 44,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 45,
                  "Content": "  tags = {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mtags\u001b[0m = {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 46,
                  "Content": "    Name = format(\"for-each-demo-zone-%s\", each.key)",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;245mName\u001b[0m = \u001b[38;5;33mformat\u001b[0m(\u001b[38;5;37m\"for-each-demo-zone-%s\"\u001b[0m, \u001b[38;5;33meach\u001b[0m.key)",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 47,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0028",
          "AVDID": "AVD-AWS-0028",
          "Title": "aws_instance should activate session tokens for Instance Metadata Service.",
          "Description": "IMDS v2 (Instance Metadata Service) introduced session authentication tokens which improve security when talking to IMDS.\n\nBy default \u003ccode\u003eaws_instance\u003c/code\u003e resource sets IMDS session auth tokens to be optional.\n\nTo fully protect IMDS you need to enable session tokens by using \u003ccode\u003emetadata_options\u003c/code\u003e block and its \u003ccode\u003ehttp_tokens\u003c/code\u003e variable set to \u003ccode\u003erequired\u003c/code\u003e.\n",
          "Message": "Instance does not require IMDS access to require a token.",
          "Namespace": "builtin.aws.ec2.aws0028",
          "Query": "data.builtin.aws.ec2.aws0028.deny",
          "Resolution": "Enable HTTP token requirement for IMDS",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0028",
          "References": [
            "https://aws.amazon.com/blogs/security/defense-in-depth-open-firewalls-reverse-proxies-ssrf-vulnerabilities-ec2-instance-metadata-service",
            "https://avd.aquasec.com/misconfig/avd-aws-0028"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "aws_instance.ubuntu[\"b\"]",
            "Provider": "AWS",
            "Service": "ec2",
            "StartLine": 38,
            "EndLine": 49,
            "Code": {
              "Lines": [
                {
                  "Number": 38,
                  "Content": "resource \"aws_instance\" \"ubuntu\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_instance\"\u001b[0m \u001b[38;5;37m\"ubuntu\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 39,
                  "Content": "  for_each = var.zones",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mfor_each\u001b[0m = \u001b[38;5;33mvar\u001b[0m.zones",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 40,
                  "Content": "  ami = data.aws_ami.ubuntu.id",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mami\u001b[0m = \u001b[38;5;33mdata\u001b[0m.aws_ami.ubuntu.id",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 41,
                  "Content": "  instance_type = \"t2.micro\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245minstance_type\u001b[0m = \u001b[38;5;37m\"t2.micro\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 42,
                  "Content": "  associate_public_ip_address = true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245massociate_public_ip_address\u001b[0m = \u001b[38;5;166mtrue",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 43,
                  "Content": "  availability_zone = each.value",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mavailability_zone\u001b[0m = \u001b[38;5;33meach\u001b[0m.value",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 44,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 45,
                  "Content": "  tags = {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mtags\u001b[0m = {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 46,
                  "Content": "    Name = format(\"for-each-demo-zone-%s\", each.key)",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;245mName\u001b[0m = \u001b[38;5;33mformat\u001b[0m(\u001b[38;5;37m\"for-each-demo-zone-%s\"\u001b[0m, \u001b[38;5;33meach\u001b[0m.key)",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 47,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0028",
          "AVDID": "AVD-AWS-0028",
          "Title": "aws_instance should activate session tokens for Instance Metadata Service.",
          "Description": "IMDS v2 (Instance Metadata Service) introduced session authentication tokens which improve security when talking to IMDS.\n\nBy default \u003ccode\u003eaws_instance\u003c/code\u003e resource sets IMDS session auth tokens to be optional.\n\nTo fully protect IMDS you need to enable session tokens by using \u003ccode\u003emetadata_options\u003c/code\u003e block and its \u003ccode\u003ehttp_tokens\u003c/code\u003e variable set to \u003ccode\u003erequired\u003c/code\u003e.\n",
          "Message": "Instance does not require IMDS access to require a token.",
          "Namespace": "builtin.aws.ec2.aws0028",
          "Query": "data.builtin.aws.ec2.aws0028.deny",
          "Resolution": "Enable HTTP token requirement for IMDS",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0028",
          "References": [
            "https://aws.amazon.com/blogs/security/defense-in-depth-open-firewalls-reverse-proxies-ssrf-vulnerabilities-ec2-instance-metadata-service",
            "https://avd.aquasec.com/misconfig/avd-aws-0028"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "aws_instance.ubuntu[\"c\"]",
            "Provider": "AWS",
            "Service": "ec2",
            "StartLine": 38,
            "EndLine": 49,
            "Code": {
              "Lines": [
                {
                  "Number": 38,
                  "Content": "resource \"aws_instance\" \"ubuntu\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_instance\"\u001b[0m \u001b[38;5;37m\"ubuntu\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 39,
                  "Content": "  for_each = var.zones",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mfor_each\u001b[0m = \u001b[38;5;33mvar\u001b[0m.zones",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 40,
                  "Content": "  ami = data.aws_ami.ubuntu.id",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mami\u001b[0m = \u001b[38;5;33mdata\u001b[0m.aws_ami.ubuntu.id",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 41,
                  "Content": "  instance_type = \"t2.micro\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245minstance_type\u001b[0m = \u001b[38;5;37m\"t2.micro\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 42,
                  "Content": "  associate_public_ip_address = true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245massociate_public_ip_address\u001b[0m = \u001b[38;5;166mtrue",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 43,
                  "Content": "  availability_zone = each.value",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mavailability_zone\u001b[0m = \u001b[38;5;33meach\u001b[0m.value",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 44,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 45,
                  "Content": "  tags = {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mtags\u001b[0m = {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 46,
                  "Content": "    Name = format(\"for-each-demo-zone-%s\", each.key)",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;245mName\u001b[0m = \u001b[38;5;33mformat\u001b[0m(\u001b[38;5;37m\"for-each-demo-zone-%s\"\u001b[0m, \u001b[38;5;33meach\u001b[0m.key)",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 47,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0028",
          "AVDID": "AVD-AWS-0028",
          "Title": "aws_instance should activate session tokens for Instance Metadata Service.",
          "Description": "IMDS v2 (Instance Metadata Service) introduced session authentication tokens which improve security when talking to IMDS.\n\nBy default \u003ccode\u003eaws_instance\u003c/code\u003e resource sets IMDS session auth tokens to be optional.\n\nTo fully protect IMDS you need to enable session tokens by using \u003ccode\u003emetadata_options\u003c/code\u003e block and its \u003ccode\u003ehttp_tokens\u003c/code\u003e variable set to \u003ccode\u003erequired\u003c/code\u003e.\n",
          "Message": "Instance does not require IMDS access to require a token.",
          "Namespace": "builtin.aws.ec2.aws0028",
          "Query": "data.builtin.aws.ec2.aws0028.deny",
          "Resolution": "Enable HTTP token requirement for IMDS",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0028",
          "References": [
            "https://aws.amazon.com/blogs/security/defense-in-depth-open-firewalls-reverse-proxies-ssrf-vulnerabilities-ec2-instance-metadata-service",
            "https://avd.aquasec.com/misconfig/avd-aws-0028"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "aws_instance.ubuntu[\"d\"]",
            "Provider": "AWS",
            "Service": "ec2",
            "StartLine": 38,
            "EndLine": 49,
            "Code": {
              "Lines": [
                {
                  "Number": 38,
                  "Content": "resource \"aws_instance\" \"ubuntu\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_instance\"\u001b[0m \u001b[38;5;37m\"ubuntu\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 39,
                  "Content": "  for_each = var.zones",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mfor_each\u001b[0m = \u001b[38;5;33mvar\u001b[0m.zones",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 40,
                  "Content": "  ami = data.aws_ami.ubuntu.id",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mami\u001b[0m = \u001b[38;5;33mdata\u001b[0m.aws_ami.ubuntu.id",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 41,
                  "Content": "  instance_type = \"t2.micro\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245minstance_type\u001b[0m = \u001b[38;5;37m\"t2.micro\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 42,
                  "Content": "  associate_public_ip_address = true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245massociate_public_ip_address\u001b[0m = \u001b[38;5;166mtrue",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 43,
                  "Content": "  availability_zone = each.value",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mavailability_zone\u001b[0m = \u001b[38;5;33meach\u001b[0m.value",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 44,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 45,
                  "Content": "  tags = {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mtags\u001b[0m = {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 46,
                  "Content": "    Name = format(\"for-each-demo-zone-%s\", each.key)",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;245mName\u001b[0m = \u001b[38;5;33mformat\u001b[0m(\u001b[38;5;37m\"for-each-demo-zone-%s\"\u001b[0m, \u001b[38;5;33meach\u001b[0m.key)",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 47,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0028",
          "AVDID": "AVD-AWS-0028",
          "Title": "aws_instance should activate session tokens for Instance Metadata Service.",
          "Description": "IMDS v2 (Instance Metadata Service) introduced session authentication tokens which improve security when talking to IMDS.\n\nBy default \u003ccode\u003eaws_instance\u003c/code\u003e resource sets IMDS session auth tokens to be optional.\n\nTo fully protect IMDS you need to enable session tokens by using \u003ccode\u003emetadata_options\u003c/code\u003e block and its \u003ccode\u003ehttp_tokens\u003c/code\u003e variable set to \u003ccode\u003erequired\u003c/code\u003e.\n",
          "Message": "Instance does not require IMDS access to require a token.",
          "Namespace": "builtin.aws.ec2.aws0028",
          "Query": "data.builtin.aws.ec2.aws0028.deny",
          "Resolution": "Enable HTTP token requirement for IMDS",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0028",
          "References": [
            "https://aws.amazon.com/blogs/security/defense-in-depth-open-firewalls-reverse-proxies-ssrf-vulnerabilities-ec2-instance-metadata-service",
            "https://avd.aquasec.com/misconfig/avd-aws-0028"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "aws_instance.ubuntu[\"e\"]",
            "Provider": "AWS",
            "Service": "ec2",
            "StartLine": 38,
            "EndLine": 49,
            "Code": {
              "Lines": [
                {
                  "Number": 38,
                  "Content": "resource \"aws_instance\" \"ubuntu\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_instance\"\u001b[0m \u001b[38;5;37m\"ubuntu\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 39,
                  "Content": "  for_each = var.zones",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mfor_each\u001b[0m = \u001b[38;5;33mvar\u001b[0m.zones",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 40,
                  "Content": "  ami = data.aws_ami.ubuntu.id",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mami\u001b[0m = \u001b[38;5;33mdata\u001b[0m.aws_ami.ubuntu.id",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 41,
                  "Content": "  instance_type = \"t2.micro\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245minstance_type\u001b[0m = \u001b[38;5;37m\"t2.micro\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 42,
                  "Content": "  associate_public_ip_address = true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245massociate_public_ip_address\u001b[0m = \u001b[38;5;166mtrue",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 43,
                  "Content": "  availability_zone = each.value",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mavailability_zone\u001b[0m = \u001b[38;5;33meach\u001b[0m.value",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 44,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 45,
                  "Content": "  tags = {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mtags\u001b[0m = {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 46,
                  "Content": "    Name = format(\"for-each-demo-zone-%s\", each.key)",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;245mName\u001b[0m = \u001b[38;5;33mformat\u001b[0m(\u001b[38;5;37m\"for-each-demo-zone-%s\"\u001b[0m, \u001b[38;5;33meach\u001b[0m.key)",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 47,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0028",
          "AVDID": "AVD-AWS-0028",
          "Title": "aws_instance should activate session tokens for Instance Metadata Service.",
          "Description": "IMDS v2 (Instance Metadata Service) introduced session authentication tokens which improve security when talking to IMDS.\n\nBy default \u003ccode\u003eaws_instance\u003c/code\u003e resource sets IMDS session auth tokens to be optional.\n\nTo fully protect IMDS you need to enable session tokens by using \u003ccode\u003emetadata_options\u003c/code\u003e block and its \u003ccode\u003ehttp_tokens\u003c/code\u003e variable set to \u003ccode\u003erequired\u003c/code\u003e.\n",
          "Message": "Instance does not require IMDS access to require a token.",
          "Namespace": "builtin.aws.ec2.aws0028",
          "Query": "data.builtin.aws.ec2.aws0028.deny",
          "Resolution": "Enable HTTP token requirement for IMDS",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0028",
          "References": [
            "https://aws.amazon.com/blogs/security/defense-in-depth-open-firewalls-reverse-proxies-ssrf-vulnerabilities-ec2-instance-metadata-service",
            "https://avd.aquasec.com/misconfig/avd-aws-0028"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "aws_instance.ubuntu[\"f\"]",
            "Provider": "AWS",
            "Service": "ec2",
            "StartLine": 38,
            "EndLine": 49,
            "Code": {
              "Lines": [
                {
                  "Number": 38,
                  "Content": "resource \"aws_instance\" \"ubuntu\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_instance\"\u001b[0m \u001b[38;5;37m\"ubuntu\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 39,
                  "Content": "  for_each = var.zones",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mfor_each\u001b[0m = \u001b[38;5;33mvar\u001b[0m.zones",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 40,
                  "Content": "  ami = data.aws_ami.ubuntu.id",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mami\u001b[0m = \u001b[38;5;33mdata\u001b[0m.aws_ami.ubuntu.id",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 41,
                  "Content": "  instance_type = \"t2.micro\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245minstance_type\u001b[0m = \u001b[38;5;37m\"t2.micro\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 42,
                  "Content": "  associate_public_ip_address = true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245massociate_public_ip_address\u001b[0m = \u001b[38;5;166mtrue",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 43,
                  "Content": "  availability_zone = each.value",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mavailability_zone\u001b[0m = \u001b[38;5;33meach\u001b[0m.value",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 44,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 45,
                  "Content": "  tags = {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mtags\u001b[0m = {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 46,
                  "Content": "    Name = format(\"for-each-demo-zone-%s\", each.key)",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;245mName\u001b[0m = \u001b[38;5;33mformat\u001b[0m(\u001b[38;5;37m\"for-each-demo-zone-%s\"\u001b[0m, \u001b[38;5;33meach\u001b[0m.key)",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 47,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0131",
          "AVDID": "AVD-AWS-0131",
          "Title": "Instance with unencrypted block device.",
          "Description": "Block devices should be encrypted to ensure sensitive data is held securely at rest.\n",
          "Message": "Root block device is not encrypted.",
          "Namespace": "builtin.aws.ec2.aws0131",
          "Query": "data.builtin.aws.ec2.aws0131.deny",
          "Resolution": "Turn on encryption for all block devices",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0131",
          "References": [
            "https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/RootDeviceStorage.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0131"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "aws_instance.ubuntu[\"a\"]",
            "Provider": "AWS",
            "Service": "ec2",
            "StartLine": 38,
            "EndLine": 49,
            "Code": {
              "Lines": [
                {
                  "Number": 38,
                  "Content": "resource \"aws_instance\" \"ubuntu\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_instance\"\u001b[0m \u001b[38;5;37m\"ubuntu\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 39,
                  "Content": "  for_each = var.zones",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mfor_each\u001b[0m = \u001b[38;5;33mvar\u001b[0m.zones",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 40,
                  "Content": "  ami = data.aws_ami.ubuntu.id",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mami\u001b[0m = \u001b[38;5;33mdata\u001b[0m.aws_ami.ubuntu.id",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 41,
                  "Content": "  instance_type = \"t2.micro\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245minstance_type\u001b[0m = \u001b[38;5;37m\"t2.micro\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 42,
                  "Content": "  associate_public_ip_address = true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245massociate_public_ip_address\u001b[0m = \u001b[38;5;166mtrue",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 43,
                  "Content": "  availability_zone = each.value",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mavailability_zone\u001b[0m = \u001b[38;5;33meach\u001b[0m.value",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 44,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 45,
                  "Content": "  tags = {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mtags\u001b[0m = {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 46,
                  "Content": "    Name = format(\"for-each-demo-zone-%s\", each.key)",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;245mName\u001b[0m = \u001b[38;5;33mformat\u001b[0m(\u001b[38;5;37m\"for-each-demo-zone-%s\"\u001b[0m, \u001b[38;5;33meach\u001b[0m.key)",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 47,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0131",
          "AVDID": "AVD-AWS-0131",
          "Title": "Instance with unencrypted block device.",
          "Description": "Block devices should be encrypted to ensure sensitive data is held securely at rest.\n",
          "Message": "Root block device is not encrypted.",
          "Namespace": "builtin.aws.ec2.aws0131",
          "Query": "data.builtin.aws.ec2.aws0131.deny",
          "Resolution": "Turn on encryption for all block devices",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0131",
          "References": [
            "https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/RootDeviceStorage.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0131"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "aws_instance.ubuntu[\"b\"]",
            "Provider": "AWS",
            "Service": "ec2",
            "StartLine": 38,
            "EndLine": 49,
            "Code": {
              "Lines": [
                {
                  "Number": 38,
                  "Content": "resource \"aws_instance\" \"ubuntu\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_instance\"\u001b[0m \u001b[38;5;37m\"ubuntu\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 39,
                  "Content": "  for_each = var.zones",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mfor_each\u001b[0m = \u001b[38;5;33mvar\u001b[0m.zones",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 40,
                  "Content": "  ami = data.aws_ami.ubuntu.id",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mami\u001b[0m = \u001b[38;5;33mdata\u001b[0m.aws_ami.ubuntu.id",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 41,
                  "Content": "  instance_type = \"t2.micro\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245minstance_type\u001b[0m = \u001b[38;5;37m\"t2.micro\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 42,
                  "Content": "  associate_public_ip_address = true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245massociate_public_ip_address\u001b[0m = \u001b[38;5;166mtrue",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 43,
                  "Content": "  availability_zone = each.value",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mavailability_zone\u001b[0m = \u001b[38;5;33meach\u001b[0m.value",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 44,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 45,
                  "Content": "  tags = {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mtags\u001b[0m = {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 46,
                  "Content": "    Name = format(\"for-each-demo-zone-%s\", each.key)",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;245mName\u001b[0m = \u001b[38;5;33mformat\u001b[0m(\u001b[38;5;37m\"for-each-demo-zone-%s\"\u001b[0m, \u001b[38;5;33meach\u001b[0m.key)",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 47,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0131",
          "AVDID": "AVD-AWS-0131",
          "Title": "Instance with unencrypted block device.",
          "Description": "Block devices should be encrypted to ensure sensitive data is held securely at rest.\n",
          "Message": "Root block device is not encrypted.",
          "Namespace": "builtin.aws.ec2.aws0131",
          "Query": "data.builtin.aws.ec2.aws0131.deny",
          "Resolution": "Turn on encryption for all block devices",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0131",
          "References": [
            "https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/RootDeviceStorage.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0131"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "aws_instance.ubuntu[\"c\"]",
            "Provider": "AWS",
            "Service": "ec2",
            "StartLine": 38,
            "EndLine": 49,
            "Code": {
              "Lines": [
                {
                  "Number": 38,
                  "Content": "resource \"aws_instance\" \"ubuntu\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_instance\"\u001b[0m \u001b[38;5;37m\"ubuntu\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 39,
                  "Content": "  for_each = var.zones",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mfor_each\u001b[0m = \u001b[38;5;33mvar\u001b[0m.zones",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 40,
                  "Content": "  ami = data.aws_ami.ubuntu.id",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mami\u001b[0m = \u001b[38;5;33mdata\u001b[0m.aws_ami.ubuntu.id",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 41,
                  "Content": "  instance_type = \"t2.micro\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245minstance_type\u001b[0m = \u001b[38;5;37m\"t2.micro\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 42,
                  "Content": "  associate_public_ip_address = true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245massociate_public_ip_address\u001b[0m = \u001b[38;5;166mtrue",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 43,
                  "Content": "  availability_zone = each.value",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mavailability_zone\u001b[0m = \u001b[38;5;33meach\u001b[0m.value",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 44,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 45,
                  "Content": "  tags = {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mtags\u001b[0m = {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 46,
                  "Content": "    Name = format(\"for-each-demo-zone-%s\", each.key)",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;245mName\u001b[0m = \u001b[38;5;33mformat\u001b[0m(\u001b[38;5;37m\"for-each-demo-zone-%s\"\u001b[0m, \u001b[38;5;33meach\u001b[0m.key)",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 47,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0131",
          "AVDID": "AVD-AWS-0131",
          "Title": "Instance with unencrypted block device.",
          "Description": "Block devices should be encrypted to ensure sensitive data is held securely at rest.\n",
          "Message": "Root block device is not encrypted.",
          "Namespace": "builtin.aws.ec2.aws0131",
          "Query": "data.builtin.aws.ec2.aws0131.deny",
          "Resolution": "Turn on encryption for all block devices",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0131",
          "References": [
            "https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/RootDeviceStorage.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0131"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "aws_instance.ubuntu[\"d\"]",
            "Provider": "AWS",
            "Service": "ec2",
            "StartLine": 38,
            "EndLine": 49,
            "Code": {
              "Lines": [
                {
                  "Number": 38,
                  "Content": "resource \"aws_instance\" \"ubuntu\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_instance\"\u001b[0m \u001b[38;5;37m\"ubuntu\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 39,
                  "Content": "  for_each = var.zones",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mfor_each\u001b[0m = \u001b[38;5;33mvar\u001b[0m.zones",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 40,
                  "Content": "  ami = data.aws_ami.ubuntu.id",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mami\u001b[0m = \u001b[38;5;33mdata\u001b[0m.aws_ami.ubuntu.id",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 41,
                  "Content": "  instance_type = \"t2.micro\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245minstance_type\u001b[0m = \u001b[38;5;37m\"t2.micro\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 42,
                  "Content": "  associate_public_ip_address = true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245massociate_public_ip_address\u001b[0m = \u001b[38;5;166mtrue",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 43,
                  "Content": "  availability_zone = each.value",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mavailability_zone\u001b[0m = \u001b[38;5;33meach\u001b[0m.value",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 44,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 45,
                  "Content": "  tags = {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mtags\u001b[0m = {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 46,
                  "Content": "    Name = format(\"for-each-demo-zone-%s\", each.key)",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;245mName\u001b[0m = \u001b[38;5;33mformat\u001b[0m(\u001b[38;5;37m\"for-each-demo-zone-%s\"\u001b[0m, \u001b[38;5;33meach\u001b[0m.key)",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 47,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0131",
          "AVDID": "AVD-AWS-0131",
          "Title": "Instance with unencrypted block device.",
          "Description": "Block devices should be encrypted to ensure sensitive data is held securely at rest.\n",
          "Message": "Root block device is not encrypted.",
          "Namespace": "builtin.aws.ec2.aws0131",
          "Query": "data.builtin.aws.ec2.aws0131.deny",
          "Resolution": "Turn on encryption for all block devices",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0131",
          "References": [
            "https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/RootDeviceStorage.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0131"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "aws_instance.ubuntu[\"e\"]",
            "Provider": "AWS",
            "Service": "ec2",
            "StartLine": 38,
            "EndLine": 49,
            "Code": {
              "Lines": [
                {
                  "Number": 38,
                  "Content": "resource \"aws_instance\" \"ubuntu\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_instance\"\u001b[0m \u001b[38;5;37m\"ubuntu\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 39,
                  "Content": "  for_each = var.zones",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mfor_each\u001b[0m = \u001b[38;5;33mvar\u001b[0m.zones",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 40,
                  "Content": "  ami = data.aws_ami.ubuntu.id",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mami\u001b[0m = \u001b[38;5;33mdata\u001b[0m.aws_ami.ubuntu.id",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 41,
                  "Content": "  instance_type = \"t2.micro\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245minstance_type\u001b[0m = \u001b[38;5;37m\"t2.micro\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 42,
                  "Content": "  associate_public_ip_address = true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245massociate_public_ip_address\u001b[0m = \u001b[38;5;166mtrue",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 43,
                  "Content": "  availability_zone = each.value",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mavailability_zone\u001b[0m = \u001b[38;5;33meach\u001b[0m.value",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 44,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 45,
                  "Content": "  tags = {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mtags\u001b[0m = {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 46,
                  "Content": "    Name = format(\"for-each-demo-zone-%s\", each.key)",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;245mName\u001b[0m = \u001b[38;5;33mformat\u001b[0m(\u001b[38;5;37m\"for-each-demo-zone-%s\"\u001b[0m, \u001b[38;5;33meach\u001b[0m.key)",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 47,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0131",
          "AVDID": "AVD-AWS-0131",
          "Title": "Instance with unencrypted block device.",
          "Description": "Block devices should be encrypted to ensure sensitive data is held securely at rest.\n",
          "Message": "Root block device is not encrypted.",
          "Namespace": "builtin.aws.ec2.aws0131",
          "Query": "data.builtin.aws.ec2.aws0131.deny",
          "Resolution": "Turn on encryption for all block devices",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0131",
          "References": [
            "https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/RootDeviceStorage.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0131"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "aws_instance.ubuntu[\"f\"]",
            "Provider": "AWS",
            "Service": "ec2",
            "StartLine": 38,
            "EndLine": 49,
            "Code": {
              "Lines": [
                {
                  "Number": 38,
                  "Content": "resource \"aws_instance\" \"ubuntu\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_instance\"\u001b[0m \u001b[38;5;37m\"ubuntu\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 39,
                  "Content": "  for_each = var.zones",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mfor_each\u001b[0m = \u001b[38;5;33mvar\u001b[0m.zones",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 40,
                  "Content": "  ami = data.aws_ami.ubuntu.id",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mami\u001b[0m = \u001b[38;5;33mdata\u001b[0m.aws_ami.ubuntu.id",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 41,
                  "Content": "  instance_type = \"t2.micro\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245minstance_type\u001b[0m = \u001b[38;5;37m\"t2.micro\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 42,
                  "Content": "  associate_public_ip_address = true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245massociate_public_ip_address\u001b[0m = \u001b[38;5;166mtrue",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 43,
                  "Content": "  availability_zone = each.value",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mavailability_zone\u001b[0m = \u001b[38;5;33meach\u001b[0m.value",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 44,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 45,
                  "Content": "  tags = {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mtags\u001b[0m = {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 46,
                  "Content": "    Name = format(\"for-each-demo-zone-%s\", each.key)",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;245mName\u001b[0m = \u001b[38;5;33mformat\u001b[0m(\u001b[38;5;37m\"for-each-demo-zone-%s\"\u001b[0m, \u001b[38;5;33meach\u001b[0m.key)",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 47,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "RenderedCause": {}
          }
        }
      ]
    },
    {
      "Target": "infrastructure-as-code/terraform-0.12-examples/for-expressions",
      "Class": "config",
      "Type": "terraform",
      "MisconfSummary": {
        "Successes": 53,
        "Failures": 0
      }
    },
    {
      "Target": "infrastructure-as-code/terraform-0.12-examples/for-expressions/main.tf",
      "Class": "config",
      "Type": "terraform",
      "MisconfSummary": {
        "Successes": 0,
        "Failures": 7
      },
      "Misconfigurations": [
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0028",
          "AVDID": "AVD-AWS-0028",
          "Title": "aws_instance should activate session tokens for Instance Metadata Service.",
          "Description": "IMDS v2 (Instance Metadata Service) introduced session authentication tokens which improve security when talking to IMDS.\n\nBy default \u003ccode\u003eaws_instance\u003c/code\u003e resource sets IMDS session auth tokens to be optional.\n\nTo fully protect IMDS you need to enable session tokens by using \u003ccode\u003emetadata_options\u003c/code\u003e block and its \u003ccode\u003ehttp_tokens\u003c/code\u003e variable set to \u003ccode\u003erequired\u003c/code\u003e.\n",
          "Message": "Instance does not require IMDS access to require a token.",
          "Namespace": "builtin.aws.ec2.aws0028",
          "Query": "data.builtin.aws.ec2.aws0028.deny",
          "Resolution": "Enable HTTP token requirement for IMDS",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0028",
          "References": [
            "https://aws.amazon.com/blogs/security/defense-in-depth-open-firewalls-reverse-proxies-ssrf-vulnerabilities-ec2-instance-metadata-service",
            "https://avd.aquasec.com/misconfig/avd-aws-0028"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "aws_instance.ubuntu[0]",
            "Provider": "AWS",
            "Service": "ec2",
            "StartLine": 37,
            "EndLine": 47,
            "Code": {
              "Lines": [
                {
                  "Number": 37,
                  "Content": "resource \"aws_instance\" \"ubuntu\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_instance\"\u001b[0m \u001b[38;5;37m\"ubuntu\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 38,
                  "Content": "  count = 3",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mcount\u001b[0m = \u001b[38;5;37m3",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 39,
                  "Content": "  ami = data.aws_ami.ubuntu_14_04.image_id",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mami\u001b[0m = \u001b[38;5;33mdata\u001b[0m.aws_ami.ubuntu_14_04.image_id",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 40,
                  "Content": "  instance_type = \"t2.micro\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245minstance_type\u001b[0m = \u001b[38;5;37m\"t2.micro\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 41,
                  "Content": "  associate_public_ip_address = ( count.index == 1 ? true : false)",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245massociate_public_ip_address\u001b[0m = ( \u001b[38;5;33mcount\u001b[0m.\u001b[38;5;245mindex\u001b[0m =\u001b[38;5;245m=\u001b[0m \u001b[38;5;37m1\u001b[0m \u001b[38;5;245m?\u001b[0m \u001b[38;5;166mtrue\u001b[0m \u001b[38;5;245m:\u001b[0m \u001b[38;5;166mfalse\u001b[0m)",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 42,
                  "Content": "  subnet_id = aws_subnet.my_subnet.id",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245msubnet_id\u001b[0m = aws_subnet.my_subnet.id",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 43,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 44,
                  "Content": "  tags = {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mtags\u001b[0m = {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 45,
                  "Content": "    Name  = format(\"terraform-0.12-for-demo-%d\", count.index)",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;245mName\u001b[0m  = \u001b[38;5;33mformat\u001b[0m(\u001b[38;5;37m\"terraform-0.12-for-demo-%d\"\u001b[0m, \u001b[38;5;33mcount\u001b[0m.index)",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 46,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0028",
          "AVDID": "AVD-AWS-0028",
          "Title": "aws_instance should activate session tokens for Instance Metadata Service.",
          "Description": "IMDS v2 (Instance Metadata Service) introduced session authentication tokens which improve security when talking to IMDS.\n\nBy default \u003ccode\u003eaws_instance\u003c/code\u003e resource sets IMDS session auth tokens to be optional.\n\nTo fully protect IMDS you need to enable session tokens by using \u003ccode\u003emetadata_options\u003c/code\u003e block and its \u003ccode\u003ehttp_tokens\u003c/code\u003e variable set to \u003ccode\u003erequired\u003c/code\u003e.\n",
          "Message": "Instance does not require IMDS access to require a token.",
          "Namespace": "builtin.aws.ec2.aws0028",
          "Query": "data.builtin.aws.ec2.aws0028.deny",
          "Resolution": "Enable HTTP token requirement for IMDS",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0028",
          "References": [
            "https://aws.amazon.com/blogs/security/defense-in-depth-open-firewalls-reverse-proxies-ssrf-vulnerabilities-ec2-instance-metadata-service",
            "https://avd.aquasec.com/misconfig/avd-aws-0028"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "aws_instance.ubuntu[1]",
            "Provider": "AWS",
            "Service": "ec2",
            "StartLine": 37,
            "EndLine": 47,
            "Code": {
              "Lines": [
                {
                  "Number": 37,
                  "Content": "resource \"aws_instance\" \"ubuntu\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_instance\"\u001b[0m \u001b[38;5;37m\"ubuntu\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 38,
                  "Content": "  count = 3",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mcount\u001b[0m = \u001b[38;5;37m3",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 39,
                  "Content": "  ami = data.aws_ami.ubuntu_14_04.image_id",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mami\u001b[0m = \u001b[38;5;33mdata\u001b[0m.aws_ami.ubuntu_14_04.image_id",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 40,
                  "Content": "  instance_type = \"t2.micro\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245minstance_type\u001b[0m = \u001b[38;5;37m\"t2.micro\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 41,
                  "Content": "  associate_public_ip_address = ( count.index == 1 ? true : false)",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245massociate_public_ip_address\u001b[0m = ( \u001b[38;5;33mcount\u001b[0m.\u001b[38;5;245mindex\u001b[0m =\u001b[38;5;245m=\u001b[0m \u001b[38;5;37m1\u001b[0m \u001b[38;5;245m?\u001b[0m \u001b[38;5;166mtrue\u001b[0m \u001b[38;5;245m:\u001b[0m \u001b[38;5;166mfalse\u001b[0m)",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 42,
                  "Content": "  subnet_id = aws_subnet.my_subnet.id",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245msubnet_id\u001b[0m = aws_subnet.my_subnet.id",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 43,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 44,
                  "Content": "  tags = {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mtags\u001b[0m = {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 45,
                  "Content": "    Name  = format(\"terraform-0.12-for-demo-%d\", count.index)",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;245mName\u001b[0m  = \u001b[38;5;33mformat\u001b[0m(\u001b[38;5;37m\"terraform-0.12-for-demo-%d\"\u001b[0m, \u001b[38;5;33mcount\u001b[0m.index)",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 46,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0028",
          "AVDID": "AVD-AWS-0028",
          "Title": "aws_instance should activate session tokens for Instance Metadata Service.",
          "Description": "IMDS v2 (Instance Metadata Service) introduced session authentication tokens which improve security when talking to IMDS.\n\nBy default \u003ccode\u003eaws_instance\u003c/code\u003e resource sets IMDS session auth tokens to be optional.\n\nTo fully protect IMDS you need to enable session tokens by using \u003ccode\u003emetadata_options\u003c/code\u003e block and its \u003ccode\u003ehttp_tokens\u003c/code\u003e variable set to \u003ccode\u003erequired\u003c/code\u003e.\n",
          "Message": "Instance does not require IMDS access to require a token.",
          "Namespace": "builtin.aws.ec2.aws0028",
          "Query": "data.builtin.aws.ec2.aws0028.deny",
          "Resolution": "Enable HTTP token requirement for IMDS",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0028",
          "References": [
            "https://aws.amazon.com/blogs/security/defense-in-depth-open-firewalls-reverse-proxies-ssrf-vulnerabilities-ec2-instance-metadata-service",
            "https://avd.aquasec.com/misconfig/avd-aws-0028"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "aws_instance.ubuntu[2]",
            "Provider": "AWS",
            "Service": "ec2",
            "StartLine": 37,
            "EndLine": 47,
            "Code": {
              "Lines": [
                {
                  "Number": 37,
                  "Content": "resource \"aws_instance\" \"ubuntu\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_instance\"\u001b[0m \u001b[38;5;37m\"ubuntu\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 38,
                  "Content": "  count = 3",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mcount\u001b[0m = \u001b[38;5;37m3",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 39,
                  "Content": "  ami = data.aws_ami.ubuntu_14_04.image_id",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mami\u001b[0m = \u001b[38;5;33mdata\u001b[0m.aws_ami.ubuntu_14_04.image_id",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 40,
                  "Content": "  instance_type = \"t2.micro\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245minstance_type\u001b[0m = \u001b[38;5;37m\"t2.micro\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 41,
                  "Content": "  associate_public_ip_address = ( count.index == 1 ? true : false)",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245massociate_public_ip_address\u001b[0m = ( \u001b[38;5;33mcount\u001b[0m.\u001b[38;5;245mindex\u001b[0m =\u001b[38;5;245m=\u001b[0m \u001b[38;5;37m1\u001b[0m \u001b[38;5;245m?\u001b[0m \u001b[38;5;166mtrue\u001b[0m \u001b[38;5;245m:\u001b[0m \u001b[38;5;166mfalse\u001b[0m)",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 42,
                  "Content": "  subnet_id = aws_subnet.my_subnet.id",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245msubnet_id\u001b[0m = aws_subnet.my_subnet.id",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 43,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 44,
                  "Content": "  tags = {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mtags\u001b[0m = {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 45,
                  "Content": "    Name  = format(\"terraform-0.12-for-demo-%d\", count.index)",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;245mName\u001b[0m  = \u001b[38;5;33mformat\u001b[0m(\u001b[38;5;37m\"terraform-0.12-for-demo-%d\"\u001b[0m, \u001b[38;5;33mcount\u001b[0m.index)",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 46,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0131",
          "AVDID": "AVD-AWS-0131",
          "Title": "Instance with unencrypted block device.",
          "Description": "Block devices should be encrypted to ensure sensitive data is held securely at rest.\n",
          "Message": "Root block device is not encrypted.",
          "Namespace": "builtin.aws.ec2.aws0131",
          "Query": "data.builtin.aws.ec2.aws0131.deny",
          "Resolution": "Turn on encryption for all block devices",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0131",
          "References": [
            "https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/RootDeviceStorage.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0131"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "aws_instance.ubuntu[0]",
            "Provider": "AWS",
            "Service": "ec2",
            "StartLine": 37,
            "EndLine": 47,
            "Code": {
              "Lines": [
                {
                  "Number": 37,
                  "Content": "resource \"aws_instance\" \"ubuntu\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_instance\"\u001b[0m \u001b[38;5;37m\"ubuntu\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 38,
                  "Content": "  count = 3",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mcount\u001b[0m = \u001b[38;5;37m3",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 39,
                  "Content": "  ami = data.aws_ami.ubuntu_14_04.image_id",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mami\u001b[0m = \u001b[38;5;33mdata\u001b[0m.aws_ami.ubuntu_14_04.image_id",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 40,
                  "Content": "  instance_type = \"t2.micro\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245minstance_type\u001b[0m = \u001b[38;5;37m\"t2.micro\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 41,
                  "Content": "  associate_public_ip_address = ( count.index == 1 ? true : false)",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245massociate_public_ip_address\u001b[0m = ( \u001b[38;5;33mcount\u001b[0m.\u001b[38;5;245mindex\u001b[0m =\u001b[38;5;245m=\u001b[0m \u001b[38;5;37m1\u001b[0m \u001b[38;5;245m?\u001b[0m \u001b[38;5;166mtrue\u001b[0m \u001b[38;5;245m:\u001b[0m \u001b[38;5;166mfalse\u001b[0m)",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 42,
                  "Content": "  subnet_id = aws_subnet.my_subnet.id",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245msubnet_id\u001b[0m = aws_subnet.my_subnet.id",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 43,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 44,
                  "Content": "  tags = {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mtags\u001b[0m = {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 45,
                  "Content": "    Name  = format(\"terraform-0.12-for-demo-%d\", count.index)",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;245mName\u001b[0m  = \u001b[38;5;33mformat\u001b[0m(\u001b[38;5;37m\"terraform-0.12-for-demo-%d\"\u001b[0m, \u001b[38;5;33mcount\u001b[0m.index)",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 46,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0131",
          "AVDID": "AVD-AWS-0131",
          "Title": "Instance with unencrypted block device.",
          "Description": "Block devices should be encrypted to ensure sensitive data is held securely at rest.\n",
          "Message": "Root block device is not encrypted.",
          "Namespace": "builtin.aws.ec2.aws0131",
          "Query": "data.builtin.aws.ec2.aws0131.deny",
          "Resolution": "Turn on encryption for all block devices",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0131",
          "References": [
            "https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/RootDeviceStorage.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0131"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "aws_instance.ubuntu[1]",
            "Provider": "AWS",
            "Service": "ec2",
            "StartLine": 37,
            "EndLine": 47,
            "Code": {
              "Lines": [
                {
                  "Number": 37,
                  "Content": "resource \"aws_instance\" \"ubuntu\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_instance\"\u001b[0m \u001b[38;5;37m\"ubuntu\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 38,
                  "Content": "  count = 3",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mcount\u001b[0m = \u001b[38;5;37m3",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 39,
                  "Content": "  ami = data.aws_ami.ubuntu_14_04.image_id",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mami\u001b[0m = \u001b[38;5;33mdata\u001b[0m.aws_ami.ubuntu_14_04.image_id",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 40,
                  "Content": "  instance_type = \"t2.micro\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245minstance_type\u001b[0m = \u001b[38;5;37m\"t2.micro\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 41,
                  "Content": "  associate_public_ip_address = ( count.index == 1 ? true : false)",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245massociate_public_ip_address\u001b[0m = ( \u001b[38;5;33mcount\u001b[0m.\u001b[38;5;245mindex\u001b[0m =\u001b[38;5;245m=\u001b[0m \u001b[38;5;37m1\u001b[0m \u001b[38;5;245m?\u001b[0m \u001b[38;5;166mtrue\u001b[0m \u001b[38;5;245m:\u001b[0m \u001b[38;5;166mfalse\u001b[0m)",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 42,
                  "Content": "  subnet_id = aws_subnet.my_subnet.id",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245msubnet_id\u001b[0m = aws_subnet.my_subnet.id",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 43,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 44,
                  "Content": "  tags = {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mtags\u001b[0m = {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 45,
                  "Content": "    Name  = format(\"terraform-0.12-for-demo-%d\", count.index)",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;245mName\u001b[0m  = \u001b[38;5;33mformat\u001b[0m(\u001b[38;5;37m\"terraform-0.12-for-demo-%d\"\u001b[0m, \u001b[38;5;33mcount\u001b[0m.index)",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 46,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0131",
          "AVDID": "AVD-AWS-0131",
          "Title": "Instance with unencrypted block device.",
          "Description": "Block devices should be encrypted to ensure sensitive data is held securely at rest.\n",
          "Message": "Root block device is not encrypted.",
          "Namespace": "builtin.aws.ec2.aws0131",
          "Query": "data.builtin.aws.ec2.aws0131.deny",
          "Resolution": "Turn on encryption for all block devices",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0131",
          "References": [
            "https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/RootDeviceStorage.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0131"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "aws_instance.ubuntu[2]",
            "Provider": "AWS",
            "Service": "ec2",
            "StartLine": 37,
            "EndLine": 47,
            "Code": {
              "Lines": [
                {
                  "Number": 37,
                  "Content": "resource \"aws_instance\" \"ubuntu\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_instance\"\u001b[0m \u001b[38;5;37m\"ubuntu\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 38,
                  "Content": "  count = 3",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mcount\u001b[0m = \u001b[38;5;37m3",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 39,
                  "Content": "  ami = data.aws_ami.ubuntu_14_04.image_id",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mami\u001b[0m = \u001b[38;5;33mdata\u001b[0m.aws_ami.ubuntu_14_04.image_id",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 40,
                  "Content": "  instance_type = \"t2.micro\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245minstance_type\u001b[0m = \u001b[38;5;37m\"t2.micro\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 41,
                  "Content": "  associate_public_ip_address = ( count.index == 1 ? true : false)",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245massociate_public_ip_address\u001b[0m = ( \u001b[38;5;33mcount\u001b[0m.\u001b[38;5;245mindex\u001b[0m =\u001b[38;5;245m=\u001b[0m \u001b[38;5;37m1\u001b[0m \u001b[38;5;245m?\u001b[0m \u001b[38;5;166mtrue\u001b[0m \u001b[38;5;245m:\u001b[0m \u001b[38;5;166mfalse\u001b[0m)",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 42,
                  "Content": "  subnet_id = aws_subnet.my_subnet.id",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245msubnet_id\u001b[0m = aws_subnet.my_subnet.id",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 43,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 44,
                  "Content": "  tags = {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mtags\u001b[0m = {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 45,
                  "Content": "    Name  = format(\"terraform-0.12-for-demo-%d\", count.index)",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;245mName\u001b[0m  = \u001b[38;5;33mformat\u001b[0m(\u001b[38;5;37m\"terraform-0.12-for-demo-%d\"\u001b[0m, \u001b[38;5;33mcount\u001b[0m.index)",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 46,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "aws-autoscaling-enable-at-rest-encryption",
          "AVDID": "AVD-AWS-0178",
          "Title": "VPC Flow Logs is a feature that enables you to capture information about the IP traffic going to and from network interfaces in your VPC. After you've created a flow log, you can view and retrieve its data in Amazon CloudWatch Logs. It is recommended that VPC Flow Logs be enabled for packet \"Rejects\" for VPCs.",
          "Description": "VPC Flow Logs provide visibility into network traffic that traverses the VPC and can be used to detect anomalous traffic or insight during security workflows.\n",
          "Message": "VPC does not have VPC Flow Logs enabled.",
          "Namespace": "builtin.aws.ec2.aws0178",
          "Query": "data.builtin.aws.ec2.aws0178.deny",
          "Resolution": "Enable flow logs for VPC",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/aws-autoscaling-enable-at-rest-encryption",
          "References": [
            "https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/RootDeviceStorage.html",
            "https://avd.aquasec.com/misconfig/aws-autoscaling-enable-at-rest-encryption"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "aws_vpc.my_vpc",
            "Provider": "AWS",
            "Service": "ec2",
            "StartLine": 9,
            "EndLine": 15,
            "Code": {
              "Lines": [
                {
                  "Number": 9,
                  "Content": "resource \"aws_vpc\" \"my_vpc\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_vpc\"\u001b[0m \u001b[38;5;37m\"my_vpc\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 10,
                  "Content": "  cidr_block = \"172.16.0.0/16\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mcidr_block\u001b[0m = \u001b[38;5;37m\"172.16.0.0/16\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 11,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 12,
                  "Content": "  tags = {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mtags\u001b[0m = {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 13,
                  "Content": "    Name = \"tf-0.12-for-example\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;245mName\u001b[0m = \u001b[38;5;37m\"tf-0.12-for-example\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 14,
                  "Content": "  }",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  }",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 15,
                  "Content": "}",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "}",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            },
            "RenderedCause": {}
          }
        }
      ]
    },
    {
      "Target": "infrastructure-as-code/terraform-0.12-examples/new-template-syntax",
      "Class": "config",
      "Type": "terraform",
      "MisconfSummary": {
        "Successes": 37,
        "Failures": 0
      }
    },
    {
      "Target": "infrastructure-as-code/terraform-0.12-examples/reliable-json-syntax",
      "Class": "config",
      "Type": "terraform",
      "MisconfSummary": {
        "Successes": 37,
        "Failures": 0
      }
    },
    {
      "Target": "infrastructure-as-code/terraform-0.12-examples/rich-value-types",
      "Class": "config",
      "Type": "terraform",
      "MisconfSummary": {
        "Successes": 53,
        "Failures": 0
      }
    },
    {
      "Target": "infrastructure-as-code/terraform-0.12-examples/rich-value-types/main.tf",
      "Class": "config",
      "Type": "terraform",
      "MisconfSummary": {
        "Successes": 0,
        "Failures": 2
      },
      "Misconfigurations": [
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0028",
          "AVDID": "AVD-AWS-0028",
          "Title": "aws_instance should activate session tokens for Instance Metadata Service.",
          "Description": "IMDS v2 (Instance Metadata Service) introduced session authentication tokens which improve security when talking to IMDS.\n\nBy default \u003ccode\u003eaws_instance\u003c/code\u003e resource sets IMDS session auth tokens to be optional.\n\nTo fully protect IMDS you need to enable session tokens by using \u003ccode\u003emetadata_options\u003c/code\u003e block and its \u003ccode\u003ehttp_tokens\u003c/code\u003e variable set to \u003ccode\u003erequired\u003c/code\u003e.\n",
          "Message": "Instance does not require IMDS access to require a token.",
          "Namespace": "builtin.aws.ec2.aws0028",
          "Query": "data.builtin.aws.ec2.aws0028.deny",
          "Resolution": "Enable HTTP token requirement for IMDS",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0028",
          "References": [
            "https://aws.amazon.com/blogs/security/defense-in-depth-open-firewalls-reverse-proxies-ssrf-vulnerabilities-ec2-instance-metadata-service",
            "https://avd.aquasec.com/misconfig/avd-aws-0028"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "aws_instance.rvt",
            "Provider": "AWS",
            "Service": "ec2",
            "StartLine": 69,
            "EndLine": 81,
            "Code": {
              "Lines": [
                {
                  "Number": 69,
                  "Content": "resource \"aws_instance\" \"rvt\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_instance\"\u001b[0m \u001b[38;5;37m\"rvt\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 70,
                  "Content": "  ami = data.aws_ami.ubuntu_14_04.image_id",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mami\u001b[0m = \u001b[38;5;33mdata\u001b[0m.aws_ami.ubuntu_14_04.image_id",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 71,
                  "Content": "  instance_type = \"t2.micro\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245minstance_type\u001b[0m = \u001b[38;5;37m\"t2.micro\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 72,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 73,
                  "Content": "  tags = {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mtags\u001b[0m = {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 74,
                  "Content": "    Name = \"tf-0.12-rvt-example-instance\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;245mName\u001b[0m = \u001b[38;5;37m\"tf-0.12-rvt-example-instance\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 75,
                  "Content": "  }",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  }",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 76,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 77,
                  "Content": "  network_interface {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  network_interface {",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 78,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0131",
          "AVDID": "AVD-AWS-0131",
          "Title": "Instance with unencrypted block device.",
          "Description": "Block devices should be encrypted to ensure sensitive data is held securely at rest.\n",
          "Message": "Root block device is not encrypted.",
          "Namespace": "builtin.aws.ec2.aws0131",
          "Query": "data.builtin.aws.ec2.aws0131.deny",
          "Resolution": "Turn on encryption for all block devices",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0131",
          "References": [
            "https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/RootDeviceStorage.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0131"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "aws_instance.rvt",
            "Provider": "AWS",
            "Service": "ec2",
            "StartLine": 69,
            "EndLine": 81,
            "Code": {
              "Lines": [
                {
                  "Number": 69,
                  "Content": "resource \"aws_instance\" \"rvt\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_instance\"\u001b[0m \u001b[38;5;37m\"rvt\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 70,
                  "Content": "  ami = data.aws_ami.ubuntu_14_04.image_id",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mami\u001b[0m = \u001b[38;5;33mdata\u001b[0m.aws_ami.ubuntu_14_04.image_id",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 71,
                  "Content": "  instance_type = \"t2.micro\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245minstance_type\u001b[0m = \u001b[38;5;37m\"t2.micro\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 72,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 73,
                  "Content": "  tags = {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mtags\u001b[0m = {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 74,
                  "Content": "    Name = \"tf-0.12-rvt-example-instance\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;245mName\u001b[0m = \u001b[38;5;37m\"tf-0.12-rvt-example-instance\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 75,
                  "Content": "  }",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  }",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 76,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 77,
                  "Content": "  network_interface {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  network_interface {",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 78,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "RenderedCause": {}
          }
        }
      ]
    },
    {
      "Target": "infrastructure-as-code/terraform-0.12-examples/rich-value-types/network/main.tf",
      "Class": "config",
      "Type": "terraform",
      "MisconfSummary": {
        "Successes": 0,
        "Failures": 1
      },
      "Misconfigurations": [
        {
          "Type": "Terraform Security Check",
          "ID": "aws-autoscaling-enable-at-rest-encryption",
          "AVDID": "AVD-AWS-0178",
          "Title": "VPC Flow Logs is a feature that enables you to capture information about the IP traffic going to and from network interfaces in your VPC. After you've created a flow log, you can view and retrieve its data in Amazon CloudWatch Logs. It is recommended that VPC Flow Logs be enabled for packet \"Rejects\" for VPCs.",
          "Description": "VPC Flow Logs provide visibility into network traffic that traverses the VPC and can be used to detect anomalous traffic or insight during security workflows.\n",
          "Message": "VPC does not have VPC Flow Logs enabled.",
          "Namespace": "builtin.aws.ec2.aws0178",
          "Query": "data.builtin.aws.ec2.aws0178.deny",
          "Resolution": "Enable flow logs for VPC",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/aws-autoscaling-enable-at-rest-encryption",
          "References": [
            "https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/RootDeviceStorage.html",
            "https://avd.aquasec.com/misconfig/aws-autoscaling-enable-at-rest-encryption"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "module.network",
            "Provider": "AWS",
            "Service": "ec2",
            "StartLine": 1,
            "EndLine": 6,
            "Code": {
              "Lines": [
                {
                  "Number": 1,
                  "Content": "resource \"aws_vpc\" \"my_vpc\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_vpc\"\u001b[0m \u001b[38;5;37m\"my_vpc\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 2,
                  "Content": "  cidr_block = var.network_config.vpc_cidr",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mcidr_block\u001b[0m = \u001b[38;5;33mvar\u001b[0m.network_config.vpc_cidr",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 3,
                  "Content": "  tags = {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mtags\u001b[0m = {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 4,
                  "Content": "    Name = var.network_config.vpc_name",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;245mName\u001b[0m = \u001b[38;5;33mvar\u001b[0m.network_config.vpc_name",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 5,
                  "Content": "  }",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  }",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 6,
                  "Content": "}",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "}",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "module.network",
                "Filename": "infrastructure-as-code/terraform-0.12-examples/rich-value-types/main.tf",
                "Location": {
                  "StartLine": 44,
                  "EndLine": 47
                }
              }
            ],
            "RenderedCause": {}
          }
        }
      ]
    },
    {
      "Target": "infrastructure-as-code/terraform-0.13-examples/module-depends-on",
      "Class": "config",
      "Type": "terraform",
      "MisconfSummary": {
        "Successes": 37,
        "Failures": 0
      }
    },
    {
      "Target": "infrastructure-as-code/terraform-0.13-examples/module-depends-on/modules/read-files-complicated",
      "Class": "config",
      "Type": "terraform",
      "MisconfSummary": {
        "Successes": 37,
        "Failures": 0
      }
    },
    {
      "Target": "infrastructure-as-code/terraform-0.13-examples/module-depends-on/modules/write-files-complicated",
      "Class": "config",
      "Type": "terraform",
      "MisconfSummary": {
        "Successes": 37,
        "Failures": 0
      }
    },
    {
      "Target": "infrastructure-as-code/terraform-gcp-cloudsql",
      "Class": "config",
      "Type": "terraform",
      "MisconfSummary": {
        "Successes": 42,
        "Failures": 0
      }
    },
    {
      "Target": "infrastructure-as-code/terraform-gcp-cloudsql/examples/prod-and-dev",
      "Class": "config",
      "Type": "terraform",
      "MisconfSummary": {
        "Successes": 37,
        "Failures": 0
      }
    },
    {
      "Target": "infrastructure-as-code/terraform-gcp-cloudsql/examples/simple",
      "Class": "config",
      "Type": "terraform",
      "MisconfSummary": {
        "Successes": 37,
        "Failures": 0
      }
    },
    {
      "Target": "infrastructure-as-code/terraform-gcp-cloudsql/main.tf",
      "Class": "config",
      "Type": "terraform",
      "MisconfSummary": {
        "Successes": 0,
        "Failures": 8
      },
      "Misconfigurations": [
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-GCP-0014",
          "AVDID": "AVD-GCP-0014",
          "Title": "Temporary file logging should be enabled for all temporary files.",
          "Description": "Temporary files are not logged by default. To log all temporary files, a value of `0` should set in the `log_temp_files` flag - as all files greater in size than the number of bytes set in this flag will be logged.\n",
          "Message": "Database instance has temporary file logging disabled.",
          "Namespace": "builtin.google.sql.google0014",
          "Query": "data.builtin.google.sql.google0014.deny",
          "Resolution": "Enable temporary file logging for all files",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-gcp-0014",
          "References": [
            "https://postgresqlco.nf/doc/en/param/log_temp_files/",
            "https://avd.aquasec.com/misconfig/avd-gcp-0014"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "google_sql_database_instance.cloudsql-postgres-master",
            "Provider": "Google",
            "Service": "sql",
            "StartLine": 13,
            "EndLine": 31,
            "Code": {
              "Lines": [
                {
                  "Number": 13,
                  "Content": "resource \"google_sql_database_instance\" \"cloudsql-postgres-master\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"google_sql_database_instance\"\u001b[0m \u001b[38;5;37m\"cloudsql-postgres-master\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 14,
                  "Content": "  name = \"${random_pet.database_name.id}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mname\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0mrandom_pet.\u001b[38;5;33mdata\u001b[0mbase_name.id\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 15,
                  "Content": "  database_version = \"${var.database_version}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mdatabase_version\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.\u001b[38;5;33mdata\u001b[0mbase_version\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 16,
                  "Content": "  region = \"${var.region}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mregion\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.region\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 17,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 18,
                  "Content": "  settings {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  settings {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "    # Second-generation instance tiers are based on the machine",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;239m    # Second-generation instance tiers are based on the machine",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "    # type. See argument reference below.",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    # type. See argument reference below.",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "    tier = \"db-f1-micro\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m    \u001b[38;5;245mtier\u001b[0m = \u001b[38;5;37m\"db-f1-micro\"",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 22,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-GCP-0015",
          "AVDID": "AVD-GCP-0015",
          "Title": "SSL connections to a SQL database instance should be enforced.",
          "Description": "In-transit data should be encrypted so that if traffic is intercepted data will not be exposed in plaintext to attackers.\n",
          "Message": "Database instance does not require TLS for all connections.",
          "Namespace": "builtin.google.sql.google0015",
          "Query": "data.builtin.google.sql.google0015.deny",
          "Resolution": "Enforce SSL for all connections",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-gcp-0015",
          "References": [
            "https://cloud.google.com/sql/docs/mysql/configure-ssl-instance",
            "https://avd.aquasec.com/misconfig/avd-gcp-0015"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "google_sql_database_instance.cloudsql-postgres-master",
            "Provider": "Google",
            "Service": "sql",
            "StartLine": 22,
            "EndLine": 29,
            "Code": {
              "Lines": [
                {
                  "Number": 13,
                  "Content": "resource \"google_sql_database_instance\" \"cloudsql-postgres-master\" {",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"google_sql_database_instance\"\u001b[0m \u001b[38;5;37m\"cloudsql-postgres-master\"\u001b[0m {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 14,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "    ip_configuration {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m    ip_configuration {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "            ipv4_enabled = true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            \u001b[38;5;245mipv4_enabled\u001b[0m = \u001b[38;5;166mtrue",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 24,
                  "Content": "            require_ssl = false",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m            \u001b[38;5;245mrequire_ssl\u001b[0m = \u001b[38;5;166mfalse",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 25,
                  "Content": "            authorized_networks = {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m            \u001b[38;5;245mauthorized_networks\u001b[0m = {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 26,
                  "Content": "                name = \"terraform-server-IP-allowed-list\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "                \u001b[38;5;245mname\u001b[0m = \u001b[38;5;37m\"terraform-server-IP-allowed-list\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 27,
                  "Content": "                value = \"${var.authorized_network}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m                \u001b[38;5;245mvalue\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.authorized_network\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 28,
                  "Content": "            }",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m            }",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 29,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "settings",
                "Filename": "infrastructure-as-code/terraform-gcp-cloudsql/main.tf",
                "Location": {
                  "StartLine": 18,
                  "EndLine": 30
                }
              },
              {
                "Resource": "google_sql_database_instance.cloudsql-postgres-master",
                "Filename": "infrastructure-as-code/terraform-gcp-cloudsql/main.tf",
                "Location": {
                  "StartLine": 13,
                  "EndLine": 31
                }
              }
            ],
            "RenderedCause": {}
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-GCP-0016",
          "AVDID": "AVD-GCP-0016",
          "Title": "Ensure that logging of connections is enabled.",
          "Description": "Logging connections provides useful diagnostic data such as session length, which can identify performance issues in an application and potential DoS vectors.\n",
          "Message": "Database instance is not configured to log connections.",
          "Namespace": "builtin.google.sql.google0016",
          "Query": "data.builtin.google.sql.google0016.deny",
          "Resolution": "Enable connection logging.",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-gcp-0016",
          "References": [
            "https://www.postgresql.org/docs/13/runtime-config-logging.html#GUC-LOG-CONNECTIONS",
            "https://avd.aquasec.com/misconfig/avd-gcp-0016"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "google_sql_database_instance.cloudsql-postgres-master",
            "Provider": "Google",
            "Service": "sql",
            "StartLine": 13,
            "EndLine": 31,
            "Code": {
              "Lines": [
                {
                  "Number": 13,
                  "Content": "resource \"google_sql_database_instance\" \"cloudsql-postgres-master\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"google_sql_database_instance\"\u001b[0m \u001b[38;5;37m\"cloudsql-postgres-master\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 14,
                  "Content": "  name = \"${random_pet.database_name.id}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mname\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0mrandom_pet.\u001b[38;5;33mdata\u001b[0mbase_name.id\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 15,
                  "Content": "  database_version = \"${var.database_version}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mdatabase_version\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.\u001b[38;5;33mdata\u001b[0mbase_version\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 16,
                  "Content": "  region = \"${var.region}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mregion\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.region\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 17,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 18,
                  "Content": "  settings {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  settings {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "    # Second-generation instance tiers are based on the machine",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;239m    # Second-generation instance tiers are based on the machine",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "    # type. See argument reference below.",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    # type. See argument reference below.",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "    tier = \"db-f1-micro\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m    \u001b[38;5;245mtier\u001b[0m = \u001b[38;5;37m\"db-f1-micro\"",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 22,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-GCP-0017",
          "AVDID": "AVD-GCP-0017",
          "Title": "Ensure that Cloud SQL Database Instances are not publicly exposed",
          "Description": "Database instances should be configured so that they are not available over the public internet, but to internal compute resources which access them.\n",
          "Message": "Database instance is granted a public internet address.",
          "Namespace": "builtin.google.sql.google0017",
          "Query": "data.builtin.google.sql.google0017.deny",
          "Resolution": "Remove public access from database instances",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-gcp-0017",
          "References": [
            "https://www.cloudconformity.com/knowledge-base/gcp/CloudSQL/publicly-accessible-cloud-sql-instances.html",
            "https://avd.aquasec.com/misconfig/avd-gcp-0017"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "google_sql_database_instance.cloudsql-postgres-master",
            "Provider": "Google",
            "Service": "sql",
            "StartLine": 23,
            "EndLine": 23,
            "Code": {
              "Lines": [
                {
                  "Number": 13,
                  "Content": "resource \"google_sql_database_instance\" \"cloudsql-postgres-master\" {",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"google_sql_database_instance\"\u001b[0m \u001b[38;5;37m\"cloudsql-postgres-master\"\u001b[0m {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 14,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "            ipv4_enabled = true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            \u001b[38;5;245mipv4_enabled\u001b[0m = \u001b[38;5;166mtrue",
                  "FirstCause": true,
                  "LastCause": true
                },
                {
                  "Number": 30,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 31,
                  "Content": "}",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "}",
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "ip_configuration",
                "Filename": "infrastructure-as-code/terraform-gcp-cloudsql/main.tf",
                "Location": {
                  "StartLine": 22,
                  "EndLine": 29
                }
              },
              {
                "Resource": "settings",
                "Filename": "infrastructure-as-code/terraform-gcp-cloudsql/main.tf",
                "Location": {
                  "StartLine": 18,
                  "EndLine": 30
                }
              },
              {
                "Resource": "google_sql_database_instance.cloudsql-postgres-master",
                "Filename": "infrastructure-as-code/terraform-gcp-cloudsql/main.tf",
                "Location": {
                  "StartLine": 13,
                  "EndLine": 31
                }
              }
            ],
            "RenderedCause": {}
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-GCP-0020",
          "AVDID": "AVD-GCP-0020",
          "Title": "Ensure that logging of lock waits is enabled.",
          "Description": "Lock waits are often an indication of poor performance and often an indicator of a potential denial of service vulnerability, therefore occurrences should be logged for analysis.\n",
          "Message": "Database instance is not configured to log lock waits.",
          "Namespace": "builtin.google.sql.google0020",
          "Query": "data.builtin.google.sql.google0020.deny",
          "Resolution": "Enable lock wait logging.",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-gcp-0020",
          "References": [
            "https://www.postgresql.org/docs/13/runtime-config-logging.html#GUC-LOG-LOCK-WAITS",
            "https://avd.aquasec.com/misconfig/avd-gcp-0020"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "google_sql_database_instance.cloudsql-postgres-master",
            "Provider": "Google",
            "Service": "sql",
            "StartLine": 13,
            "EndLine": 31,
            "Code": {
              "Lines": [
                {
                  "Number": 13,
                  "Content": "resource \"google_sql_database_instance\" \"cloudsql-postgres-master\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"google_sql_database_instance\"\u001b[0m \u001b[38;5;37m\"cloudsql-postgres-master\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 14,
                  "Content": "  name = \"${random_pet.database_name.id}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mname\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0mrandom_pet.\u001b[38;5;33mdata\u001b[0mbase_name.id\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 15,
                  "Content": "  database_version = \"${var.database_version}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mdatabase_version\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.\u001b[38;5;33mdata\u001b[0mbase_version\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 16,
                  "Content": "  region = \"${var.region}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mregion\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.region\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 17,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 18,
                  "Content": "  settings {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  settings {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "    # Second-generation instance tiers are based on the machine",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;239m    # Second-generation instance tiers are based on the machine",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "    # type. See argument reference below.",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    # type. See argument reference below.",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "    tier = \"db-f1-micro\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m    \u001b[38;5;245mtier\u001b[0m = \u001b[38;5;37m\"db-f1-micro\"",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 22,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-GCP-0022",
          "AVDID": "AVD-GCP-0022",
          "Title": "Ensure that logging of disconnections is enabled.",
          "Description": "Logging disconnections provides useful diagnostic data such as session length, which can identify performance issues in an application and potential DoS vectors.\n",
          "Message": "Database instance is not configured to log disconnections.",
          "Namespace": "builtin.google.sql.google0022",
          "Query": "data.builtin.google.sql.google0022.deny",
          "Resolution": "Enable disconnection logging.",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-gcp-0022",
          "References": [
            "https://www.postgresql.org/docs/13/runtime-config-logging.html#GUC-LOG-DISCONNECTIONS",
            "https://avd.aquasec.com/misconfig/avd-gcp-0022"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "google_sql_database_instance.cloudsql-postgres-master",
            "Provider": "Google",
            "Service": "sql",
            "StartLine": 13,
            "EndLine": 31,
            "Code": {
              "Lines": [
                {
                  "Number": 13,
                  "Content": "resource \"google_sql_database_instance\" \"cloudsql-postgres-master\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"google_sql_database_instance\"\u001b[0m \u001b[38;5;37m\"cloudsql-postgres-master\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 14,
                  "Content": "  name = \"${random_pet.database_name.id}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mname\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0mrandom_pet.\u001b[38;5;33mdata\u001b[0mbase_name.id\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 15,
                  "Content": "  database_version = \"${var.database_version}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mdatabase_version\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.\u001b[38;5;33mdata\u001b[0mbase_version\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 16,
                  "Content": "  region = \"${var.region}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mregion\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.region\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 17,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 18,
                  "Content": "  settings {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  settings {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "    # Second-generation instance tiers are based on the machine",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;239m    # Second-generation instance tiers are based on the machine",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "    # type. See argument reference below.",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    # type. See argument reference below.",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "    tier = \"db-f1-micro\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m    \u001b[38;5;245mtier\u001b[0m = \u001b[38;5;37m\"db-f1-micro\"",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 22,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-GCP-0024",
          "AVDID": "AVD-GCP-0024",
          "Title": "Enable automated backups to recover from data-loss",
          "Description": "Automated backups are not enabled by default. Backups are an easy way to restore data in a corruption or data-loss scenario.\n",
          "Message": "Database instance does not have backups enabled.",
          "Namespace": "builtin.google.sql.google0024",
          "Query": "data.builtin.google.sql.google0024.deny",
          "Resolution": "Enable automated backups",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-gcp-0024",
          "References": [
            "https://cloud.google.com/sql/docs/mysql/backup-recovery/backups",
            "https://avd.aquasec.com/misconfig/avd-gcp-0024"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "google_sql_database_instance.cloudsql-postgres-master",
            "Provider": "Google",
            "Service": "sql",
            "StartLine": 13,
            "EndLine": 31,
            "Code": {
              "Lines": [
                {
                  "Number": 13,
                  "Content": "resource \"google_sql_database_instance\" \"cloudsql-postgres-master\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"google_sql_database_instance\"\u001b[0m \u001b[38;5;37m\"cloudsql-postgres-master\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 14,
                  "Content": "  name = \"${random_pet.database_name.id}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mname\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0mrandom_pet.\u001b[38;5;33mdata\u001b[0mbase_name.id\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 15,
                  "Content": "  database_version = \"${var.database_version}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mdatabase_version\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.\u001b[38;5;33mdata\u001b[0mbase_version\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 16,
                  "Content": "  region = \"${var.region}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mregion\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.region\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 17,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 18,
                  "Content": "  settings {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  settings {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "    # Second-generation instance tiers are based on the machine",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;239m    # Second-generation instance tiers are based on the machine",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "    # type. See argument reference below.",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    # type. See argument reference below.",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "    tier = \"db-f1-micro\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m    \u001b[38;5;245mtier\u001b[0m = \u001b[38;5;37m\"db-f1-micro\"",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 22,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-GCP-0025",
          "AVDID": "AVD-GCP-0025",
          "Title": "Ensure that logging of checkpoints is enabled.",
          "Description": "Logging checkpoints provides useful diagnostic data, which can identify performance issues in an application and potential DoS vectors.\n",
          "Message": "Database instance is not configured to log checkpoints.",
          "Namespace": "builtin.google.sql.google0025",
          "Query": "data.builtin.google.sql.google0025.deny",
          "Resolution": "Enable checkpoints logging.",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-gcp-0025",
          "References": [
            "https://www.postgresql.org/docs/13/runtime-config-logging.html#GUC-LOG-CHECKPOINTS",
            "https://avd.aquasec.com/misconfig/avd-gcp-0025"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "google_sql_database_instance.cloudsql-postgres-master",
            "Provider": "Google",
            "Service": "sql",
            "StartLine": 13,
            "EndLine": 31,
            "Code": {
              "Lines": [
                {
                  "Number": 13,
                  "Content": "resource \"google_sql_database_instance\" \"cloudsql-postgres-master\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"google_sql_database_instance\"\u001b[0m \u001b[38;5;37m\"cloudsql-postgres-master\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 14,
                  "Content": "  name = \"${random_pet.database_name.id}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mname\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0mrandom_pet.\u001b[38;5;33mdata\u001b[0mbase_name.id\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 15,
                  "Content": "  database_version = \"${var.database_version}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mdatabase_version\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.\u001b[38;5;33mdata\u001b[0mbase_version\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 16,
                  "Content": "  region = \"${var.region}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mregion\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.region\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 17,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 18,
                  "Content": "  settings {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  settings {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "    # Second-generation instance tiers are based on the machine",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;239m    # Second-generation instance tiers are based on the machine",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "    # type. See argument reference below.",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    # type. See argument reference below.",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "    tier = \"db-f1-micro\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m    \u001b[38;5;245mtier\u001b[0m = \u001b[38;5;37m\"db-f1-micro\"",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 22,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "RenderedCause": {}
          }
        }
      ]
    },
    {
      "Target": "operations/automation-script/config",
      "Class": "config",
      "Type": "terraform",
      "MisconfSummary": {
        "Successes": 37,
        "Failures": 0
      }
    },
    {
      "Target": "self-serve-infrastructure/cats-and-dogs/backend/Dockerfile",
      "Class": "config",
      "Type": "dockerfile",
      "MisconfSummary": {
        "Successes": 22,
        "Failures": 7
      },
      "Misconfigurations": [
        {
          "Type": "Dockerfile Security Check",
          "ID": "DS001",
          "AVDID": "AVD-DS-0001",
          "Title": "':latest' tag used",
          "Description": "When using a 'FROM' statement you should use a specific tag to avoid uncontrolled behavior when the image is updated.",
          "Message": "Specify a tag in the 'FROM' statement for image 'redis'",
          "Namespace": "builtin.dockerfile.DS001",
          "Query": "data.builtin.dockerfile.DS001.deny",
          "Resolution": "Add a tag to the image in the 'FROM' statement",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ds001",
          "References": [
            "https://avd.aquasec.com/misconfig/ds001"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Dockerfile",
            "Service": "general",
            "StartLine": 1,
            "EndLine": 1,
            "Code": {
              "Lines": [
                {
                  "Number": 1,
                  "Content": "FROM redis",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;64mFROM\u001b[0m\u001b[38;5;37m redis\u001b[0m",
                  "FirstCause": true,
                  "LastCause": true
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "Dockerfile Security Check",
          "ID": "DS002",
          "AVDID": "AVD-DS-0002",
          "Title": "Image user should not be 'root'",
          "Description": "Running containers with 'root' user can lead to a container escape situation. It is a best practice to run containers as non-root users, which can be done by adding a 'USER' statement to the Dockerfile.",
          "Message": "Specify at least 1 USER command in Dockerfile with non-root user as argument",
          "Namespace": "builtin.dockerfile.DS002",
          "Query": "data.builtin.dockerfile.DS002.deny",
          "Resolution": "Add 'USER \u003cnon root user name\u003e' line to the Dockerfile",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ds002",
          "References": [
            "https://docs.docker.com/develop/develop-images/dockerfile_best-practices/",
            "https://avd.aquasec.com/misconfig/ds002"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Dockerfile",
            "Service": "general",
            "Code": {
              "Lines": null
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "Dockerfile Security Check",
          "ID": "DS005",
          "AVDID": "AVD-DS-0005",
          "Title": "ADD instead of COPY",
          "Description": "You should use COPY instead of ADD unless you want to extract a tar file. Note that an ADD command will extract a tar file, which adds the risk of Zip-based vulnerabilities. Accordingly, it is advised to use a COPY command, which does not extract tar files.",
          "Message": "Consider using 'COPY /vote-db /app' command instead of 'ADD /vote-db /app'",
          "Namespace": "builtin.dockerfile.DS005",
          "Query": "data.builtin.dockerfile.DS005.deny",
          "Resolution": "Use COPY instead of ADD",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ds005",
          "References": [
            "https://docs.docker.com/engine/reference/builder/#add",
            "https://avd.aquasec.com/misconfig/ds005"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Dockerfile",
            "Service": "general",
            "StartLine": 6,
            "EndLine": 6,
            "Code": {
              "Lines": [
                {
                  "Number": 6,
                  "Content": "ADD /vote-db  /app",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;64mADD\u001b[0m /vote-db  /app",
                  "FirstCause": true,
                  "LastCause": true
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "Dockerfile Security Check",
          "ID": "DS017",
          "AVDID": "AVD-DS-0017",
          "Title": "'RUN \u003cpackage-manager\u003e update' instruction alone",
          "Description": "The instruction 'RUN \u003cpackage-manager\u003e update' should always be followed by '\u003cpackage-manager\u003e install' in the same RUN statement.",
          "Message": "The instruction 'RUN \u003cpackage-manager\u003e update' should always be followed by '\u003cpackage-manager\u003e install' in the same RUN statement.",
          "Namespace": "builtin.dockerfile.DS017",
          "Query": "data.builtin.dockerfile.DS017.deny",
          "Resolution": "Combine '\u003cpackage-manager\u003e update' and '\u003cpackage-manager\u003e install' instructions to single one",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ds017",
          "References": [
            "https://docs.docker.com/develop/develop-images/instructions/#run",
            "https://avd.aquasec.com/misconfig/ds017"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Dockerfile",
            "Service": "general",
            "StartLine": 3,
            "EndLine": 3,
            "Code": {
              "Lines": [
                {
                  "Number": 3,
                  "Content": "RUN apt-get update ",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;64mRUN\u001b[0m apt-get update ",
                  "FirstCause": true,
                  "LastCause": true
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "Dockerfile Security Check",
          "ID": "DS026",
          "AVDID": "AVD-DS-0026",
          "Title": "No HEALTHCHECK defined",
          "Description": "You should add HEALTHCHECK instruction in your docker container images to perform the health check on running containers.",
          "Message": "Add HEALTHCHECK instruction in your Dockerfile",
          "Namespace": "builtin.dockerfile.DS026",
          "Query": "data.builtin.dockerfile.DS026.deny",
          "Resolution": "Add HEALTHCHECK instruction in Dockerfile",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ds026",
          "References": [
            "https://blog.aquasec.com/docker-security-best-practices",
            "https://avd.aquasec.com/misconfig/ds026"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Dockerfile",
            "Service": "general",
            "Code": {
              "Lines": null
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "Dockerfile Security Check",
          "ID": "DS029",
          "AVDID": "AVD-DS-0029",
          "Title": "'apt-get' missing '--no-install-recommends'",
          "Description": "'apt-get' install should use '--no-install-recommends' to minimize image size.",
          "Message": "'--no-install-recommends' flag is missed: 'apt-get install -y curl'",
          "Namespace": "builtin.dockerfile.DS029",
          "Query": "data.builtin.dockerfile.DS029.deny",
          "Resolution": "Add '--no-install-recommends' flag to 'apt-get'",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ds029",
          "References": [
            "https://docs.docker.com/develop/develop-images/dockerfile_best-practices/",
            "https://avd.aquasec.com/misconfig/ds029"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Dockerfile",
            "Service": "general",
            "StartLine": 4,
            "EndLine": 4,
            "Code": {
              "Lines": [
                {
                  "Number": 4,
                  "Content": "RUN apt-get install -y curl ",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;64mRUN\u001b[0m apt-get install -y curl ",
                  "FirstCause": true,
                  "LastCause": true
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "Dockerfile Security Check",
          "ID": "DS029",
          "AVDID": "AVD-DS-0029",
          "Title": "'apt-get' missing '--no-install-recommends'",
          "Description": "'apt-get' install should use '--no-install-recommends' to minimize image size.",
          "Message": "'--no-install-recommends' flag is missed: 'apt-get install -y python3-pip'",
          "Namespace": "builtin.dockerfile.DS029",
          "Query": "data.builtin.dockerfile.DS029.deny",
          "Resolution": "Add '--no-install-recommends' flag to 'apt-get'",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ds029",
          "References": [
            "https://docs.docker.com/develop/develop-images/dockerfile_best-practices/",
            "https://avd.aquasec.com/misconfig/ds029"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Dockerfile",
            "Service": "general",
            "StartLine": 5,
            "EndLine": 5,
            "Code": {
              "Lines": [
                {
                  "Number": 5,
                  "Content": "RUN apt-get install -y python3-pip",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;64mRUN\u001b[0m apt-get install -y python3-pip",
                  "FirstCause": true,
                  "LastCause": true
                }
              ]
            },
            "RenderedCause": {}
          }
        }
      ]
    },
    {
      "Target": "self-serve-infrastructure/cats-and-dogs/frontend/Dockerfile",
      "Class": "config",
      "Type": "dockerfile",
      "MisconfSummary": {
        "Successes": 25,
        "Failures": 3
      },
      "Misconfigurations": [
        {
          "Type": "Dockerfile Security Check",
          "ID": "DS002",
          "AVDID": "AVD-DS-0002",
          "Title": "Image user should not be 'root'",
          "Description": "Running containers with 'root' user can lead to a container escape situation. It is a best practice to run containers as non-root users, which can be done by adding a 'USER' statement to the Dockerfile.",
          "Message": "Specify at least 1 USER command in Dockerfile with non-root user as argument",
          "Namespace": "builtin.dockerfile.DS002",
          "Query": "data.builtin.dockerfile.DS002.deny",
          "Resolution": "Add 'USER \u003cnon root user name\u003e' line to the Dockerfile",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ds002",
          "References": [
            "https://docs.docker.com/develop/develop-images/dockerfile_best-practices/",
            "https://avd.aquasec.com/misconfig/ds002"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Dockerfile",
            "Service": "general",
            "Code": {
              "Lines": null
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "Dockerfile Security Check",
          "ID": "DS005",
          "AVDID": "AVD-DS-0005",
          "Title": "ADD instead of COPY",
          "Description": "You should use COPY instead of ADD unless you want to extract a tar file. Note that an ADD command will extract a tar file, which adds the risk of Zip-based vulnerabilities. Accordingly, it is advised to use a COPY command, which does not extract tar files.",
          "Message": "Consider using 'COPY /azure-vote /app' command instead of 'ADD /azure-vote /app'",
          "Namespace": "builtin.dockerfile.DS005",
          "Query": "data.builtin.dockerfile.DS005.deny",
          "Resolution": "Use COPY instead of ADD",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ds005",
          "References": [
            "https://docs.docker.com/engine/reference/builder/#add",
            "https://avd.aquasec.com/misconfig/ds005"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Dockerfile",
            "Service": "general",
            "StartLine": 5,
            "EndLine": 5,
            "Code": {
              "Lines": [
                {
                  "Number": 5,
                  "Content": "ADD     /azure-vote /app",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;64mADD\u001b[0m     /azure-vote /app",
                  "FirstCause": true,
                  "LastCause": true
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "Dockerfile Security Check",
          "ID": "DS026",
          "AVDID": "AVD-DS-0026",
          "Title": "No HEALTHCHECK defined",
          "Description": "You should add HEALTHCHECK instruction in your docker container images to perform the health check on running containers.",
          "Message": "Add HEALTHCHECK instruction in your Dockerfile",
          "Namespace": "builtin.dockerfile.DS026",
          "Query": "data.builtin.dockerfile.DS026.deny",
          "Resolution": "Add HEALTHCHECK instruction in Dockerfile",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ds026",
          "References": [
            "https://blog.aquasec.com/docker-security-best-practices",
            "https://avd.aquasec.com/misconfig/ds026"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Dockerfile",
            "Service": "general",
            "Code": {
              "Lines": null
            },
            "RenderedCause": {}
          }
        }
      ]
    },
    {
      "Target": "self-serve-infrastructure/getting-started/terraform-aws",
      "Class": "config",
      "Type": "terraform",
      "MisconfSummary": {
        "Successes": 55,
        "Failures": 0
      }
    },
    {
      "Target": "self-serve-infrastructure/getting-started/terraform-aws/main.tf",
      "Class": "config",
      "Type": "terraform",
      "MisconfSummary": {
        "Successes": 0,
        "Failures": 1
      },
      "Misconfigurations": [
        {
          "Type": "Terraform Security Check",
          "ID": "aws-autoscaling-enable-at-rest-encryption",
          "AVDID": "AVD-AWS-0178",
          "Title": "VPC Flow Logs is a feature that enables you to capture information about the IP traffic going to and from network interfaces in your VPC. After you've created a flow log, you can view and retrieve its data in Amazon CloudWatch Logs. It is recommended that VPC Flow Logs be enabled for packet \"Rejects\" for VPCs.",
          "Description": "VPC Flow Logs provide visibility into network traffic that traverses the VPC and can be used to detect anomalous traffic or insight during security workflows.\n",
          "Message": "VPC does not have VPC Flow Logs enabled.",
          "Namespace": "builtin.aws.ec2.aws0178",
          "Query": "data.builtin.aws.ec2.aws0178.deny",
          "Resolution": "Enable flow logs for VPC",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/aws-autoscaling-enable-at-rest-encryption",
          "References": [
            "https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/RootDeviceStorage.html",
            "https://avd.aquasec.com/misconfig/aws-autoscaling-enable-at-rest-encryption"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "aws_vpc.demo_vpc",
            "Provider": "AWS",
            "Service": "ec2",
            "StartLine": 5,
            "EndLine": 11,
            "Code": {
              "Lines": [
                {
                  "Number": 5,
                  "Content": "resource \"aws_vpc\" \"demo_vpc\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_vpc\"\u001b[0m \u001b[38;5;37m\"demo_vpc\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 6,
                  "Content": "  cidr_block = \"${var.vpc_cidr_block}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mcidr_block\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.vpc_cidr_block\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 7,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 8,
                  "Content": "  tags {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  tags {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 9,
                  "Content": "    Name = \"fp_demo_vpc\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;245mName\u001b[0m = \u001b[38;5;37m\"fp_demo_vpc\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 10,
                  "Content": "  }",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  }",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 11,
                  "Content": "}",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "}",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            },
            "RenderedCause": {}
          }
        }
      ]
    },
    {
      "Target": "self-serve-infrastructure/getting-started/terraform-azure",
      "Class": "config",
      "Type": "terraform",
      "MisconfSummary": {
        "Successes": 37,
        "Failures": 0
      }
    },
    {
      "Target": "self-serve-infrastructure/getting-started/terraform-gcp",
      "Class": "config",
      "Type": "terraform",
      "MisconfSummary": {
        "Successes": 37,
        "Failures": 0
      }
    },
    {
      "Target": "self-serve-infrastructure/k8s-services",
      "Class": "config",
      "Type": "terraform",
      "MisconfSummary": {
        "Successes": 37,
        "Failures": 0
      }
    },
    {
      "Target": "self-serve-infrastructure/k8s-services-openshift",
      "Class": "config",
      "Type": "terraform",
      "MisconfSummary": {
        "Successes": 37,
        "Failures": 0
      }
    },
    {
      "Target": "self-serve-infrastructure/k8s-services-openshift/cats-and-dogs.yaml",
      "Class": "config",
      "Type": "kubernetes",
      "MisconfSummary": {
        "Successes": 62,
        "Failures": 0
      }
    }
  ]
}
